(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{710:function(module,exports,__webpack_require__){(function($,jQuery){if(console.log("Jexcel has been renamed to Jspreadsheet. Please use: npm install jspreadsheet-ce"),!jSuites){var jSuites=__webpack_require__(856);__webpack_require__(857)}var factory;factory=function(){"use strict";var jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if("TABLE"==el.tagName){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jexcel",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:"jExcel CE Spreadsheet\nVersion 4.5.0\nWebsite: https://bossanova.uk/jexcel/v3"};for(var property in defaults)if(options&&options.hasOwnProperty(property))if("text"===property)for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,1==obj.options.lazyLoading&&0==obj.options.tableOverflow&&0==obj.options.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){null==e&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(obj.options.fullscreen=e,1==e?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){if(!obj.ignoreEvents){if("function"==typeof obj.options.onevent)var t=obj.options.onevent.apply(this,arguments);"function"==typeof obj.options[e]&&(t=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1)))}if("onafterchanges"==e&&obj.options.persistance){var o=1==obj.options.persistance?obj.options.url:obj.options.persistance,data=obj.prepareJson(arguments[2]);obj.save(o,data)}return t},obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&void 0!==obj.options.data[0]){var t=Object.keys(obj.options.data[0]);t.length>e&&(e=t.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);for(var o=[],i=0;i<e;i++)obj.options.colHeaders[i]||(obj.options.colHeaders[i]=""),obj.options.colWidths[i]||(obj.options.colWidths[i]=obj.options.defaultColWidth),obj.options.colAlignments[i]||(obj.options.colAlignments[i]=obj.options.defaultColAlign),obj.options.columns[i]?obj.options.columns[i].type||(obj.options.columns[i].type="text"):obj.options.columns[i]={type:"text"},obj.options.columns[i].name||(obj.options.columns[i].name=t&&t[i]?t[i]:i),obj.options.columns[i].source||(obj.options.columns[i].source=[]),obj.options.columns[i].options||(obj.options.columns[i].options=[]),obj.options.columns[i].editor||(obj.options.columns[i].editor=null),obj.options.columns[i].allowEmpty||(obj.options.columns[i].allowEmpty=!1),obj.options.columns[i].title||(obj.options.columns[i].title=obj.options.colHeaders[i]?obj.options.colHeaders[i]:""),obj.options.columns[i].width||(obj.options.columns[i].width=obj.options.colWidths[i]?obj.options.colWidths[i]:obj.options.defaultColWidth),obj.options.columns[i].align||(obj.options.columns[i].align=obj.options.colAlignments[i]?obj.options.colAlignments[i]:"center"),"autocomplete"==obj.options.columns[i].type||"dropdown"==obj.options.columns[i].type?obj.options.columns[i].url&&o.push({url:obj.options.columns[i].url,index:i,method:"GET",dataType:"json",success:function(data){for(var i=0;i<data.length;i++)obj.options.columns[this.index].source.push(data[i])}}):"calendar"==obj.options.columns[i].type&&(obj.options.columns[i].options.format||(obj.options.columns[i].options.format="DD/MM/YYYY"));o.length?jSuites.ajax(o,(function(){obj.createTable()})):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(e){obj.scrollControls(e)},obj.content.onwheel=function(e){obj.wheelControls(e)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var o=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var i=0;i<obj.options.paginationOptions.length;i++){var n=document.createElement("option");n.value=obj.options.paginationOptions[i],n.innerHTML=obj.options.paginationOptions[i],obj.paginationDropdown.appendChild(n)}obj.paginationDropdown.value=obj.options.pagination,o.appendChild(document.createTextNode(obj.options.text.show)),o.appendChild(obj.paginationDropdown),o.appendChild(document.createTextNode(obj.options.text.entries))}var r,filter=document.createElement("div");if(filter.classList.add("jexcel_filter"),filter.appendChild(o),filter.appendChild(e),obj.colgroupContainer=document.createElement("colgroup"),(r=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(r),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var l=0;l<obj.options.nestedHeaders.length;l++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[l]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(r=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(r),i=0;i<obj.options.columns.length;i++)obj.createCellHeader(i),obj.headerContainer.appendChild(obj.headers[i]),obj.colgroupContainer.appendChild(obj.colgroup[i]);if(obj.thead.appendChild(obj.headerContainer),1==obj.options.filters){obj.filter=document.createElement("tr");var td=document.createElement("td");for(obj.filter.appendChild(td),i=0;i<obj.options.columns.length;i++)(td=document.createElement("td")).innerHTML="&nbsp;",td.setAttribute("data-x",i),td.className="jexcel_column_filter","hidden"==obj.options.columns[i].type&&(td.style.display="none"),obj.filter.appendChild(td);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),0==obj.options.selectionCopy&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var c=document.createElement("a");c.setAttribute("href","https://bossanova.uk/jexcel/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if("undefined"!=typeof sessionStorage&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var img=document.createElement("img");img.src="//bossanova.uk/jexcel/logo.png",c.appendChild(img)}}catch(e){}var span=document.createElement("span");span.innerHTML="Jexcel spreadsheet",c.appendChild(span),obj.ads.appendChild(c),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var d=document.createElement("div"),f=document.createElement("div");if(obj.pagination.appendChild(d),obj.pagination.appendChild(f),obj.options.pagination||(obj.pagination.style.display="none"),1==obj.options.search&&el.appendChild(filter),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),1==obj.options.fullscreen?el.classList.add("fullscreen"):1==obj.options.tableOverflow&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),1!=obj.options.tableOverflow&&obj.options.toolbar&&el.classList.add("with-toolbar"),1==obj.options.columnDrag&&obj.thead.classList.add("draggable"),1==obj.options.columnResize&&obj.thead.classList.add("resizable"),1==obj.options.rowDrag&&obj.tbody.classList.add("draggable"),1==obj.options.rowResize&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var h=Object.keys(obj.options.classes);for(i=0;i<h.length;i++){var m=jexcel.getIdFromColumnName(h[i],!0);obj.records[m[1]][m[0]].classList.add(obj.options.classes[h[i]])}}},obj.refresh=function(){obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.setData(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(data){if(data&&("string"==typeof data&&(data=JSON.parse(data)),obj.options.data=data),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){data=[];for(var e=0;e<obj.options.data.length;e++){for(var t=[],i=0;i<obj.options.columns.length;i++)t[i]=obj.options.data[e][obj.options.columns[i].name];data.push(t)}obj.options.data=data}e=0,i=0;var o=obj.options.columns.length,n=obj.options.data.length,r=obj.options.minDimensions[0],l=obj.options.minDimensions[1],c=r>o?r:o,d=l>n?l:n;for(e=0;e<d;e++)for(i=0;i<c;i++)null==obj.options.data[e]&&(obj.options.data[e]=[]),null==obj.options.data[e][i]&&(obj.options.data[e][i]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",1==obj.options.lazyLoading){var f=0,h=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,f=obj.options.pagination*obj.pageNumber,h=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<h&&(h=obj.options.data.length)):(f=0,h=obj.options.data.length);for(e=0;e<obj.options.data.length;e++){var tr=obj.createRow(e,obj.options.data[e]);e>=f&&e<h&&obj.tbody.appendChild(tr)}if(1==obj.options.lazyLoading||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var m=Object.keys(obj.options.mergeCells);for(i=0;i<m.length;i++){var j=obj.options.mergeCells[m[i]];obj.setMerge(m[i],j[0],j[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,t){for(var o=[],n=0,r=0,l=1==t||0==obj.options.copyCompatibility,c=obj.options.columns.length,d=obj.options.data.length,f=0;f<d;f++){n=0;for(var i=0;i<c;i++)e&&!obj.records[f][i].classList.contains("highlight")||(o[r]||(o[r]=[]),o[r][n]=l?obj.options.data[f][i]:obj.records[f][i].innerHTML,n++);n>0&&r++}return o},obj.getJsonRow=function(e){for(var t=obj.options.data[e],o=obj.options.columns.length,n={},i=0;i<o;i++)obj.options.columns[i].name||(obj.options.columns[i].name=i),n[obj.options.columns[i].name]=t[i];return n},obj.getJson=function(e){for(var data=[],t=obj.options.columns.length,o=obj.options.data.length,n=0;n<o;n++){for(var r=null,i=0;i<t;i++)e&&!obj.records[n][i].classList.contains("highlight")||(null==r&&(r={}),obj.options.columns[i].name||(obj.options.columns[i].name=i),r[obj.options.columns[i].name]=obj.options.data[n][i]);null!=r&&data.push(r)}return data},obj.prepareJson=function(data){for(var e=[],i=0;i<data.length;i++){var t=data[i].x,o=data[i].y,n=obj.options.columns[t].name?obj.options.columns[t].name:t;e[o]||(e[o]={row:o,data:{}}),e[o].data[n]=data[i].newValue}return e.filter((function(e){return null!=e}))},obj.save=function(e,data){var t=obj.dispatch("onbeforesave",el,obj,data);if(t)data=t;else if(!1===t)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(data)},success:function(e){obj.dispatch("onsave",el,obj,data)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,data){for(var i=0;i<obj.headers.length;i++){var t=jexcel.getColumnNameFromId([i,e]);null!=data[i]&&obj.setValue(t,data[i])}},obj.getColumnData=function(e){for(var t=[],o=0;o<obj.options.data.length;o++)t.push(obj.options.data[o][e]);return t},obj.setColumnData=function(e,data){for(var t=0;t<obj.rows.length;t++){var o=jexcel.getColumnNameFromId([e,t]);null!=data[t]&&obj.setValue(o,data[t])}},obj.createRow=function(e,data){obj.records[e]||(obj.records[e]=[]),data||(data=obj.options.data[e]),obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var t=null;obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title&&(t=obj.options.rows[e].title)),t||(t=parseInt(e+1));var td=document.createElement("td");td.innerHTML=t,td.setAttribute("data-y",e),td.className="jexcel_row",obj.rows[e].appendChild(td);for(var i=0;i<obj.options.columns.length;i++)obj.records[e][i]=obj.createCell(i,e,data[i]),obj.rows[e].appendChild(obj.records[e][i]);return obj.rows[e]},obj.parseValue=function(i,e,t){if("="==(""+t).substr(0,1)&&1==obj.options.parseFormulas&&(t=obj.executeFormula(t,i,e)),obj.options.columns[i].mask){var o=obj.options.columns[i].decimal||".";t=""+jSuites.mask.run(t,obj.options.columns[i].mask,o)}return t},obj.createCell=function(i,e,t){var td=document.createElement("td");if(td.setAttribute("data-x",i),td.setAttribute("data-y",e),"="==(""+t).substr(0,1)&&1==obj.options.secureFormulas){var o=secureFormula(t);o!=t&&(t=o)}if(obj.options.columns[i].editor)!1===obj.options.stripHTML||!1===obj.options.columns[i].stripHTML?td.innerHTML=t:td.innerText=t,"function"==typeof obj.options.columns[i].editor.createCell&&(td=obj.options.columns[i].editor.createCell(td));else if("hidden"==obj.options.columns[i].type)td.style.display="none",td.innerText=t;else if("checkbox"==obj.options.columns[i].type||"radio"==obj.options.columns[i].type){var element=document.createElement("input");element.type=obj.options.columns[i].type,element.name="c"+i,element.checked=1==t||1==t||"true"==t,element.onclick=function(){obj.setValue(td,this.checked)},1!=obj.options.columns[i].readOnly&&0!=obj.options.editable||element.setAttribute("disabled","disabled"),td.appendChild(element),obj.options.data[e][i]=element.checked}else if("calendar"==obj.options.columns[i].type){var n=jSuites.calendar.extractDateFromString(t,obj.options.columns[i].options.format);td.innerText=jSuites.calendar.getDateString(n||t,obj.options.columns[i].options.format)}else if("dropdown"==obj.options.columns[i].type||"autocomplete"==obj.options.columns[i].type)td.classList.add("jexcel_dropdown"),td.innerText=obj.getDropDownValue(i,t);else if("color"==obj.options.columns[i].type)if("square"==obj.options.columns[i].render){var r=document.createElement("div");r.className="color",r.style.backgroundColor=t,td.appendChild(r)}else td.style.color=t,td.innerText=t;else if("image"==obj.options.columns[i].type){if(t&&"data:image"==t.substr(0,10)){var img=document.createElement("img");img.src=t,td.appendChild(img)}}else"html"==obj.options.columns[i].type||!1===obj.options.stripHTML||!1===obj.options.columns[i].stripHTML?td.innerHTML=stripScript(obj.parseValue(i,e,t)):td.innerText=obj.parseValue(i,e,t);1==obj.options.columns[i].readOnly&&(td.className="readonly");var l=obj.options.columns[i].align?obj.options.columns[i].align:"center";return td.style.textAlign=l,0!=obj.options.columns[i].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[i].wordWrap||td.innerHTML.length>200)&&(td.style.whiteSpace="pre-wrap"),i>0&&1==this.options.textOverflow&&(t||td.innerHTML?obj.records[e][i-1].style.overflow="hidden":i==obj.options.columns.length-1&&(td.style.overflow="hidden")),td},obj.createCellHeader=function(e){var t=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth,o=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].innerText=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=o,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.options.columns[e].textContent),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",t),"hidden"==obj.options.columns[e].type&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,t,title){obj.options.nestedHeaders[t][e].title&&(obj.options.nestedHeaders[t][e].title=title,obj.options.nestedHeaders[t].element.children[e+1].innerText=title)},obj.createNestedHeader=function(e){var tr=document.createElement("tr");tr.classList.add("jexcel_nested");var td=document.createElement("td");tr.appendChild(td),e.element=tr;for(var t=0,i=0;i<e.length;i++){e[i].colspan||(e[i].colspan=1),e[i].align||(e[i].align="center"),e[i].title||(e[i].title="");for(var o=e[i].colspan,n=[],r=0;r<o;r++)obj.options.columns[t]&&"hidden"==obj.options.columns[t].type&&o++,n.push(t),t++;(td=document.createElement("td")).setAttribute("data-column",n.join(",")),td.setAttribute("colspan",e[i].colspan),td.setAttribute("align",e[i].align),td.innerText=e[i].title,tr.appendChild(td)}return tr},obj.createToolbar=function(e){e?obj.options.toolbar=e:e=obj.options.toolbar;for(var i=0;i<e.length;i++)if("i"==e[i].type)(n=document.createElement("i")).classList.add("jexcel_toolbar_item"),n.classList.add("material-icons"),n.setAttribute("data-k",e[i].k),n.setAttribute("data-v",e[i].v),n.setAttribute("id",e[i].id),e[i].tooltip&&n.setAttribute("title",e[i].tooltip),e[i].onclick&&(e[i].onclick,1)?n.onclick=function(a){var b=a;return function(){e[b].onclick(el,obj,this)}}(i):n.onclick=function(){var e=this.getAttribute("data-k"),t=this.getAttribute("data-v");obj.setStyle(obj.highlighted,e,t)},n.innerText=e[i].content,obj.toolbar.appendChild(n);else if("select"==e[i].type){(n=document.createElement("select")).classList.add("jexcel_toolbar_item"),n.setAttribute("data-k",e[i].k),e[i].tooltip&&n.setAttribute("title",e[i].tooltip),e[i].onchange&&(e[i].onchange,1)?n.onchange=e[i].onchange:n.onchange=function(){var e=this.getAttribute("data-k");obj.setStyle(obj.highlighted,e,this.value)};for(var t=0;t<e[i].v.length;t++){var o=document.createElement("option");o.value=e[i].v[t],o.innerText=e[i].v[t],n.appendChild(o)}obj.toolbar.appendChild(n)}else if("color"==e[i].type){var n;(n=document.createElement("i")).classList.add("jexcel_toolbar_item"),n.classList.add("material-icons"),n.setAttribute("data-k",e[i].k),n.setAttribute("data-v",""),e[i].tooltip&&n.setAttribute("title",e[i].tooltip),obj.toolbar.appendChild(n),n.innerText=e[i].content,jSuites.color(n,{onchange:function(e,t){var o=e.getAttribute("data-k");obj.setStyle(obj.highlighted,o,t)}})}},obj.setMerge=function(e,t,o,n){var r=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var l=parseInt(obj.highlighted[0].getAttribute("data-x")),c=parseInt(obj.highlighted[0].getAttribute("data-y")),d=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),f=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([l,c]),t=d-l+1,o=f-c+1}var h=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[h[1]][h[0]].getAttribute("data-merged")&&(r=obj.options.text.cellAlreadyMerged);else if((!t||t<2)&&(!o||o<2))r=obj.options.text.invalidMergeProperties;else for(var m=h[1];m<h[1]+o;m++)for(var i=h[0];i<h[0]+t;i++)jexcel.getColumnNameFromId([i,m]),obj.records[m][i].getAttribute("data-merged")&&(r=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(r)alert(r);else{t>1?obj.records[h[1]][h[0]].setAttribute("colspan",t):t=1,o>1?obj.records[h[1]][h[0]].setAttribute("rowspan",o):o=1,obj.options.mergeCells[e]=[t,o,[]],obj.records[h[1]][h[0]].setAttribute("data-merged","true"),obj.records[h[1]][h[0]].style.overflow="hidden";for(var data=[],j=h[1];j<h[1]+o;j++)for(var v=h[0];v<h[0]+t;v++)h[0]==v&&h[1]==j||(data.push(obj.options.data[j][v]),obj.updateCell(v,j,"",!0),obj.options.mergeCells[e][2].push(obj.records[j][v]),obj.records[j][v].style.display="none",obj.records[j][v]=obj.records[h[1]][h[0]]);obj.updateSelection(obj.records[h[1]][h[0]]),n||(obj.setHistory({action:"setMerge",column:e,colspan:t,rowspan:o,data:data}),obj.dispatch("onmerge",el,e,t,o))}},obj.getMerge=function(e){var data={};if(e)data=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var t=Object.keys(obj.options.mergeCells),i=0;i<t.length;i++)data[t[i]]=[obj.options.mergeCells[t[i]][0],obj.options.mergeCells[t[i]][1]]}return data},obj.removeMerge=function(e,data,t){if(obj.options.mergeCells[e]){var o=jexcel.getIdFromColumnName(e,!0);obj.records[o[1]][o[0]].removeAttribute("colspan"),obj.records[o[1]][o[0]].removeAttribute("rowspan"),obj.records[o[1]][o[0]].removeAttribute("data-merged");for(var n=obj.options.mergeCells[e],r=0,l=0;l<n[1];l++)for(var i=0;i<n[0];i++)(l>0||i>0)&&(obj.records[o[1]+l][o[0]+i]=n[2][r],obj.records[o[1]+l][o[0]+i].style.display="",data&&data[r]&&obj.updateCell(o[0]+i,o[1]+l,data[r]),r++);obj.updateSelection(obj.records[o[1]][o[0]],obj.records[o[1]+l-1][o[0]+i-1]),t||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var t=Object.keys(obj.options.mergeCells),i=0;i<t.length;i++)obj.removeMerge(t[i],null,e)}},obj.isColMerged=function(e,t){var o=[];if(obj.options.mergeCells)for(var n=Object.keys(obj.options.mergeCells),i=0;i<n.length;i++){var r=jexcel.getIdFromColumnName(n[i],!0),l=obj.options.mergeCells[n[i]][0],c=r[0],d=r[0]+(l>1?l-1:0);null==t?c<=e&&d>=e&&o.push(n[i]):t?c<e&&d>=e&&o.push(n[i]):c<=e&&d>e&&o.push(n[i])}return o},obj.isRowMerged=function(e,t){var o=[];if(obj.options.mergeCells)for(var n=Object.keys(obj.options.mergeCells),i=0;i<n.length;i++){var r=jexcel.getIdFromColumnName(n[i],!0),l=obj.options.mergeCells[n[i]][1],c=r[1],d=r[1]+(l>1?l-1:0);null==t?c<=e&&d>=e&&o.push(n[i]):t?c<e&&d>=e&&o.push(n[i]):c<=e&&d>e&&o.push(n[i])}return o},obj.openFilter=function(e){if(obj.options.filters){e=parseInt(e),obj.resetSelection();var t=[];if("checkbox"==obj.options.columns[e].type)t.push({id:"true",name:"True"}),t.push({id:"false",name:"False"});else{for(var o=[],n=!1,r=0;r<obj.options.data.length;r++){var l=obj.options.data[r][e],c=obj.records[r][e].innerHTML;l&&c?o[l]=c:n=!0}var d=Object.keys(o);for(t=[],r=0;r<d.length;r++)t.push({id:d[r],name:o[d[r]]});n&&t.push({value:"",id:"",name:"(Blanks)"})}var div=document.createElement("div");obj.filter.children[e+1].innerHTML="",obj.filter.children[e+1].appendChild(div),obj.filter.children[e+1].style.paddingLeft="0px",obj.filter.children[e+1].style.paddingRight="0px",obj.filter.children[e+1].style.overflow="initial";var f={data:t,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==obj.filters[e]?obj.filters[e]:null,width:"100%",position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(t){obj.resetFilters(),obj.filters[e]=t.dropdown.getValue(!0),obj.filter.children[e+1].innerHTML=t.dropdown.getText(),obj.filter.children[e+1].style.paddingLeft="",obj.filter.children[e+1].style.paddingRight="",obj.filter.children[e+1].style.overflow="",obj.closeFilter(e),obj.refreshSelection()}};jSuites.dropdown(div,f)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var i=0;i<obj.filter.children.length;i++)obj.filter.children[i].innerHTML="&nbsp;",obj.filters[i]=null},obj.closeFilter=function(e){if(!e)for(var i=0;i<obj.filter.children.length;i++)obj.filters[i]&&(e=i);var t=function(e,t,o){for(var i=0;i<e.length;i++)if(""==e[i]&&(!1===obj.options.data[o][t]||""+obj.options.data[o][t]=="")||""!=e[i]&&((""+obj.options.data[o][t]).search(e[i])>=0||(""+obj.records[o][t].innerHTML).search(e[i])>=0))return!0;return!1},o=obj.filters[e];obj.results=[];for(var n=0;n<obj.options.data.length;n++)t(o,e,n)&&obj.results.push(n);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(e,t,o){var n=e.getAttribute("data-y"),r=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,r,n),r>0&&(obj.records[n][r-1].style.overflow="hidden");var l=function(t){var o=e.getBoundingClientRect(),l=document.createElement(t);return l.style.width=o.width+"px",l.style.height=o.height-2+"px",l.style.minHeight=o.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(l),obj.dispatch("oncreateeditor",el,e,r,n,l),l};if(1==e.classList.contains("readonly"));else if(obj.edition=[obj.records[n][r],obj.records[n][r].innerHTML,r,n],obj.options.columns[r].editor)obj.options.columns[r].editor.openEditor(e,el,t,o);else if("hidden"==obj.options.columns[r].type);else if("checkbox"==obj.options.columns[r].type||"radio"==obj.options.columns[r].type){var c=!e.children[0].checked;obj.setValue(e,c),obj.edition=null}else if("dropdown"==obj.options.columns[r].type||"autocomplete"==obj.options.columns[r].type){if(c=obj.options.data[n][r],obj.options.columns[r].multiple&&!Array.isArray(c)&&(c=c.split(";")),"function"==typeof obj.options.columns[r].filter)var source=obj.options.columns[r].filter(el,e,r,n,obj.options.columns[r].source);else source=obj.options.columns[r].source;for(var data=[],d=0;d<source.length;d++)data.push(source[d]);var f=l("div"),h={data:data,multiple:!!obj.options.columns[r].multiple,autocomplete:!(!obj.options.columns[r].autocomplete&&"autocomplete"!=obj.options.columns[r].type),opened:!0,value:c,width:"100%",height:f.style.minHeight,position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(){obj.closeEditor(e,!0)}};obj.options.columns[r].options&&obj.options.columns[r].options.type&&(h.type=obj.options.columns[r].options.type),jSuites.dropdown(f,h)}else if("calendar"==obj.options.columns[r].type||"color"==obj.options.columns[r].type)c=obj.options.data[n][r],(f=l("input")).value=c,1!=obj.options.tableOverflow&&1!=obj.options.fullscreen||(obj.options.columns[r].options.position=!0),obj.options.columns[r].options.value=obj.options.data[n][r],obj.options.columns[r].options.opened=!0,obj.options.columns[r].options.onclose=function(t,o){obj.closeEditor(e,!0)},"color"==obj.options.columns[r].type?jSuites.color(f,obj.options.columns[r].options):jSuites.calendar(f,obj.options.columns[r].options),f.focus();else if("html"==obj.options.columns[r].type){c=obj.options.data[n][r],(f=l("div")).style.position="relative",(div=document.createElement("div")).classList.add("jexcel_richtext"),f.appendChild(div),jSuites.editor(div,{focus:!0,value:c});var rect=e.getBoundingClientRect(),m=div.getBoundingClientRect();window.innerHeight<rect.bottom+m.height?div.style.top=rect.top-(m.height+2)+"px":div.style.top=rect.top+"px"}else if("image"==obj.options.columns[r].type){var div,img=e.children[0];(f=l("div")).style.position="relative",(div=document.createElement("div")).classList.add("jclose"),img&&img.src&&div.appendChild(img),f.appendChild(div),jSuites.image(div,obj.options.imageOptions),rect=e.getBoundingClientRect(),m=div.getBoundingClientRect(),window.innerHeight<rect.bottom+m.height?div.style.top=rect.top-(m.height+2)+"px":div.style.top=rect.top+"px"}else{if(c=1==t?"":obj.options.data[n][r],0==obj.options.columns[r].wordWrap||1!=obj.options.wordWrap&&1!=obj.options.columns[r].wordWrap)f=l("input"),obj.options.columns[r].mask&&f.setAttribute("data-mask",obj.options.columns[r].mask);else var f=l("textarea");f.onblur=function(){obj.closeEditor(e,!0)},f.focus(),f.value=c,f.scrollLeft=f.scrollWidth}},obj.closeEditor=function(e,t){var o=parseInt(e.getAttribute("data-x")),n=parseInt(e.getAttribute("data-y"));if(1==t){if(obj.options.columns[o].editor)var r=obj.options.columns[o].editor.closeEditor(e,t);else if("checkbox"==obj.options.columns[o].type||"radio"==obj.options.columns[o].type||"hidden"==obj.options.columns[o].type);else if("dropdown"==obj.options.columns[o].type||"autocomplete"==obj.options.columns[o].type)r=e.children[0].dropdown.close(!0);else if("calendar"==obj.options.columns[o].type)r=e.children[0].calendar.close(!0);else if("color"==obj.options.columns[o].type)r=e.children[0].color.close(!0);else if("html"==obj.options.columns[o].type)r=e.children[0].children[0].editor.getData();else if("image"==obj.options.columns[o].type){var img=e.children[0].children[0].children[0];r=img&&"IMG"==img.tagName?img.src:""}else"numeric"==obj.options.columns[o].type?("="!=(r=e.children[0].value).substr(0,1)&&""==r&&(r=obj.options.columns[o].allowEmpty?"":0),e.children[0].onblur=null):(r=e.children[0].value,e.children[0].onblur=null);obj.options.data[n][o]==r?e.innerHTML=obj.edition[1]:obj.setValue(e,r)}else obj.options.columns[o].editor?obj.options.columns[o].editor.closeEditor(e,t):"dropdown"==obj.options.columns[o].type||"autocomplete"==obj.options.columns[o].type?e.children[0].dropdown.close(!0):"calendar"==obj.options.columns[o].type?e.children[0].calendar.close(!0):"color"==obj.options.columns[o].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,e,o,n,r,t),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],o=e[1];return obj.records[o][t]},obj.getCellFromCoords=function(e,t){return obj.records[t][e]},obj.getLabel=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],o=e[1];return obj.records[o][t].innerHTML},obj.getLabelFromCoords=function(e,t){return obj.records[t][e].innerHTML},obj.getValue=function(e,t){if("object"==typeof e)var o=e.getAttribute("data-x"),n=e.getAttribute("data-y");else o=(e=jexcel.getIdFromColumnName(e,!0))[0],n=e[1];var r=null;return null!=o&&null!=n&&(obj.records[n]&&obj.records[n][o]&&(t||1==obj.options.copyCompatibility)?r=obj.records[n][o].innerHTML:obj.options.data[n]&&"undefined"!=obj.options.data[n][o]&&(r=obj.options.data[n][o])),r},obj.getValueFromCoords=function(e,t,o){var n=null;return null!=e&&null!=t&&(obj.records[t]&&obj.records[t][e]&&o||1==obj.options.copyCompatibility?n=obj.records[t][e].innerHTML:obj.options.data[t]&&"undefined"!=obj.options.data[t][e]&&(n=obj.options.data[t][e])),n},obj.setValue=function(e,t,o){var n=[];if("string"==typeof e){var r=(d=jexcel.getIdFromColumnName(e,!0))[0],l=d[1];n.push(obj.updateCell(r,l,t,o)),obj.updateFormulaChain(r,l,n)}else if(r=null,l=null,e&&e.getAttribute&&(r=e.getAttribute("data-x"),l=e.getAttribute("data-y")),null!=r&&null!=l)n.push(obj.updateCell(r,l,t,o)),obj.updateFormulaChain(r,l,n);else{var c=Object.keys(e);if(c.length>0)for(var i=0;i<c.length;i++){var d;if("string"==typeof e[i])r=(d=jexcel.getIdFromColumnName(e[i],!0))[0],l=d[1];else null!=e[i].x&&null!=e[i].y?(r=e[i].x,l=e[i].y,null!=e[i].newValue?t=e[i].newValue:null!=e[i].value&&(t=e[i].value)):(r=e[i].getAttribute("data-x"),l=e[i].getAttribute("data-y"));null!=r&&null!=l&&(n.push(obj.updateCell(r,l,t,o)),obj.updateFormulaChain(r,l,n))}}obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,n)},obj.setValueFromCoords=function(e,t,o,n){var r=[];r.push(obj.updateCell(e,t,o,n)),obj.updateFormulaChain(e,t,r),obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,r)},obj.setCheckRadioValue=function(){for(var e=[],t=Object.keys(obj.highlighted),i=0;i<t.length;i++){var o=obj.highlighted[i].getAttribute("data-x"),n=obj.highlighted[i].getAttribute("data-y");"checkbox"!=obj.options.columns[o].type&&"radio"!=obj.options.columns[o].type||e.push(obj.updateCell(o,n,!obj.options.data[n][o]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))};var stripScript=function(a){var b=new Option;b.innerHTML=a;var e=null;for(a=b.getElementsByTagName("script");e=a[0];)e.parentNode.removeChild(e);return b.innerHTML};obj.updateCell=function(e,t,o,n){if(1!=obj.records[t][e].classList.contains("readonly")||n){var r;if("="==(""+o).substr(0,1)&&1==obj.options.secureFormulas&&(r=secureFormula(o))!=o&&(o=r),null!=(r=obj.dispatch("onbeforechange",el,obj.records[t][e],e,t,o))&&(o=r),obj.options.columns[e].editor&&"function"==typeof obj.options.columns[e].editor.updateCell&&(o=obj.options.columns[e].editor.updateCell(obj.records[t][e],o,n)),f={x:e,y:t,col:e,row:t,newValue:o,oldValue:obj.options.data[t][e]},obj.options.columns[e].editor)obj.options.data[t][e]=o;else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){if("radio"==obj.options.columns[e].type)for(var l=0;l<obj.options.data.length;l++)obj.options.data[l][e]=!1;obj.records[t][e].children[0].checked=1==o||1==o||"true"==o||"TRUE"==o,obj.options.data[t][e]=obj.records[t][e].children[0].checked}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type)obj.options.data[t][e]=o,obj.records[t][e].innerText=obj.getDropDownValue(e,o);else if("calendar"==obj.options.columns[e].type){var c=jSuites.calendar.extractDateFromString(o,obj.options.columns[e].options.format);obj.options.data[t][e]=o,obj.records[t][e].innerText=jSuites.calendar.getDateString(c||o,obj.options.columns[e].options.format)}else if("color"==obj.options.columns[e].type)if(obj.options.data[t][e]=o,"square"==obj.options.columns[e].render){var d=document.createElement("div");d.className="color",d.style.backgroundColor=o,obj.records[t][e].innerText="",obj.records[t][e].appendChild(d)}else obj.records[t][e].style.color=o,obj.records[t][e].innerText=o;else if("image"==obj.options.columns[e].type){if(o=""+o,obj.options.data[t][e]=o,obj.records[t][e].innerHTML="",o&&"data:image"==o.substr(0,10)){var img=document.createElement("img");img.src=o,obj.records[t][e].appendChild(img)}}else obj.options.data[t][e]=o,"html"==obj.options.columns[e].type||!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,o)):obj.records[t][e].innerText=obj.parseValue(e,t,o),0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||obj.records[t][e].innerHTML.length>200)?obj.records[t][e].style.whiteSpace="pre-wrap":obj.records[t][e].style.whiteSpace="";e>0&&(obj.records[t][e-1].style.overflow=o?"hidden":""),obj.dispatch("onchange",el,obj.records[t]&&obj.records[t][e]?obj.records[t][e]:null,e,t,o,f.oldValue)}else var f={x:e,y:t,col:e,row:t};return f},obj.copyData=function(e,t){var data=obj.getData(!0,!0),o=obj.selectedContainer,n=parseInt(e.getAttribute("data-x")),r=parseInt(e.getAttribute("data-y")),l=parseInt(t.getAttribute("data-x")),c=parseInt(t.getAttribute("data-y")),d=[],f=!1;if(o[0]==n){if(r<o[1])var h=r-o[1];else h=1;var m=0}else m=n<o[0]?n-o[0]:1,h=0;for(var j=0,v=0,x=r;x<=c;x++)if(!obj.rows[x]||"none"!=obj.rows[x].style.display){null==data[v]&&(v=0),j=0,o[0]!=n&&(m=n<o[0]?n-o[0]:1);for(var i=n;i<=l;i++){if(obj.records[x][i]&&!obj.records[x][i].classList.contains("readonly")&&"none"!=obj.records[x][i].style.display&&0==f){if(!obj.selection.length&&""!=obj.options.data[x][i]){f=!0;continue}(null==data[v]||null==data[v][j])&&(j=0);var w=data[v][j];if(w&&!data[1]&&1==obj.options.autoIncrement)if("text"==obj.options.columns[i].type||"number"==obj.options.columns[i].type)if("="==(""+w).substr(0,1)){var y=w.match(/([A-Z]+[0-9]+)/g);if(y){for(var C=[],E=0;E<y.length;E++){var A=jexcel.getIdFromColumnName(y[E],1);A[0]+=m,A[1]+=h,A[1]<0&&(A[1]=0);var L=jexcel.getColumnNameFromId([A[0],A[1]]);L!=y[E]&&(C[y[E]]=L)}C&&(w=obj.updateFormula(w,C))}}else w==Number(w)&&(w=Number(w)+h);else if("calendar"==obj.options.columns[i].type){var I=new Date(w);I.setDate(I.getDate()+h),w=I.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(I.getMonth()+1))+"-"+jexcel.doubleDigitFormat(I.getDate())+" 00:00:00"}d.push(obj.updateCell(i,x,w)),obj.updateFormulaChain(i,x,d)}j++,o[0]!=n&&m++}v++,h++}obj.setHistory({action:"setValue",records:d,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,d)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,t,o){if(1==e){if(obj.selectedCell&&(t>=obj.selectedCell[1]&&t<=obj.selectedCell[3]||o>=obj.selectedCell[1]&&o<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(t>=obj.selectedCell[0]&&t<=obj.selectedCell[2]||o>=obj.selectedCell[0]&&o<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length){f=1;for(var i=0;i<obj.highlighted.length;i++){obj.highlighted[i].classList.remove("highlight"),obj.highlighted[i].classList.remove("highlight-left"),obj.highlighted[i].classList.remove("highlight-right"),obj.highlighted[i].classList.remove("highlight-top"),obj.highlighted[i].classList.remove("highlight-bottom"),obj.highlighted[i].classList.remove("highlight-selected");var t=parseInt(obj.highlighted[i].getAttribute("data-x")),o=parseInt(obj.highlighted[i].getAttribute("data-y"));if(obj.highlighted[i].getAttribute("data-merged"))var n=parseInt(obj.highlighted[i].getAttribute("colspan")),r=parseInt(obj.highlighted[i].getAttribute("rowspan")),l=n>0?t+(n-1):t,c=r>0?o+(r-1):o;else l=t,c=o;for(var d=t;d<=l;d++)obj.headers[d]&&obj.headers[d].classList.remove("selected");for(d=o;d<=c;d++)obj.rows[d]&&obj.rows[d].classList.remove("selected")}}else var f=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",1==e&&1==f&&obj.dispatch("onblur",el),f},obj.updateSelection=function(e,t,o){var n=e.getAttribute("data-x"),r=e.getAttribute("data-y");if(t)var l=t.getAttribute("data-x"),c=t.getAttribute("data-y");else l=n,c=r;obj.updateSelectionFromCoords(n,r,l,c,o)},obj.updateSelectionFromCoords=function(e,t,o,n,r){var l=obj.resetSelection();if(null==o&&(o=e),null==n&&(n=t),e>=obj.headers.length&&(e=obj.headers.length-1),t>=obj.rows.length&&(t=obj.rows.length-1),o>=obj.headers.length&&(o=obj.headers.length-1),n>=obj.rows.length&&(n=obj.rows.length-1),obj.selectedCell=[e,t,o,n],null!=e){if(obj.records[t][e]&&obj.records[t][e].classList.add("highlight-selected"),parseInt(e)<parseInt(o))var c=parseInt(e),d=parseInt(o);else c=parseInt(o),d=parseInt(e);if(parseInt(t)<parseInt(n))var f=parseInt(t),h=parseInt(n);else f=parseInt(n),h=parseInt(t);for(var i=c;i<=d;i++)for(var m=f;m<=h;m++)if(obj.records[m][i]&&obj.records[m][i].getAttribute("data-merged")){var j=parseInt(obj.records[m][i].getAttribute("data-x")),v=parseInt(obj.records[m][i].getAttribute("data-y")),x=parseInt(obj.records[m][i].getAttribute("colspan")),w=parseInt(obj.records[m][i].getAttribute("rowspan"));x>1&&(j<c&&(c=j),j+x>d&&(d=j+x-1)),w&&(v<f&&(f=v),v+w>h&&(h=v+w-1))}var y=null,C=null,E=null,A=null;for(m=f;m<=h;m++)"none"!=obj.rows[m].style.display&&(null==E&&(E=m),A=m);for(i=c;i<=d;i++){for(m=f;m<=h;m++)"none"!=obj.rows[m].style.display&&"none"!=obj.records[m][i].style.display&&(obj.records[m][i].classList.add("highlight"),obj.highlighted.push(obj.records[m][i]));"hidden"!=obj.options.columns[i].type&&(null==y&&(y=i),C=i)}for(y||(y=0),C||(C=0),i=y;i<=C;i++)"hidden"!=obj.options.columns[i].type&&(obj.records[E]&&obj.records[E][i]&&obj.records[E][i].classList.add("highlight-top"),obj.records[A]&&obj.records[A][i]&&obj.records[A][i].classList.add("highlight-bottom"),obj.headers[i].classList.add("selected"));for(m=E;m<=A;m++)obj.rows[m]&&"none"!=obj.rows[m].style.display&&(obj.records[m][y].classList.add("highlight-left"),obj.records[m][C].classList.add("highlight-right"),obj.rows[m].classList.add("selected"));obj.selectedContainer=[y,E,C,A]}0==l&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,y,E,C,A,r),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var i=0;i<obj.selection.length;i++)obj.selection[i].classList.remove("selection"),obj.selection[i].classList.remove("selection-left"),obj.selection[i].classList.remove("selection-right"),obj.selection[i].classList.remove("selection-top"),obj.selection[i].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,t){obj.removeCopySelection();var o=obj.selectedContainer[0],n=obj.selectedContainer[1],r=obj.selectedContainer[2],l=obj.selectedContainer[3];if(null!=e&&null!=t){if(e-r>0)var c=parseInt(r)+1,d=parseInt(e);else c=parseInt(e),d=parseInt(o)-1;if(t-l>0)var f=parseInt(l)+1,h=parseInt(t);else f=parseInt(t),h=parseInt(n)-1;d-c<=h-f?(c=parseInt(o),d=parseInt(r)):(f=parseInt(n),h=parseInt(l));for(var m=f;m<=h;m++)for(var i=c;i<=d;i++)obj.records[m][i]&&"none"!=obj.rows[m].style.display&&"none"!=obj.records[m][i].style.display&&(obj.records[m][i].classList.add("selection"),obj.records[f][i].classList.add("selection-top"),obj.records[h][i].classList.add("selection-bottom"),obj.records[m][c].classList.add("selection-left"),obj.records[m][d].classList.add("selection-right"),obj.selection.push(obj.records[m][i]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var e=obj.highlighted[obj.highlighted.length-1],t=obj.content.getBoundingClientRect(),o=t.left,n=t.top,r=e.getBoundingClientRect(),l=r.left,c=r.top,d=r.width,h2=r.height,f=l-o+obj.content.scrollLeft+d-4,h=c-n+obj.content.scrollTop+h2-4;obj.corner.style.top=h+"px",obj.corner.style.left=f+"px",obj.options.freezeColumns&&l-o+d<obj.getFreezeWidth()?obj.corner.style.display="none":1==obj.options.selectionCopy&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(e){var t=obj.content.getBoundingClientRect(),o=t.left,n=t.top,r=t.width,h1=t.height,l=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),c=l.left,d=l.top,f=l.width,h2=l.height;if(0==e||1==e)var h=c-o+obj.content.scrollLeft,m=d-n+obj.content.scrollTop-2;else h=c-o+obj.content.scrollLeft+f,m=d-n+obj.content.scrollTop+h2;m>obj.content.scrollTop+30&&m<obj.content.scrollTop+h1||(m<obj.content.scrollTop+30?obj.content.scrollTop=m-h2:obj.content.scrollTop=m-(h1-2));var j=obj.getFreezeWidth();h>obj.content.scrollLeft+j&&h<obj.content.scrollLeft+r||(h<obj.content.scrollLeft+30?(obj.content.scrollLeft=h,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):h<obj.content.scrollLeft+j?obj.content.scrollLeft=h-j-1:obj.content.scrollLeft=h-(r-20))},obj.getWidth=function(e){if(e)"object"==typeof e&&(e=$(e).getAttribute("data-x")),data=obj.colgroup[e].getAttribute("width");else for(var data=[],i=0;i<obj.headers.length;i++)data.push(obj.options.columns[i].width);return data},obj.setWidth=function(e,t,o){if(t){if(Array.isArray(e)){o||(o=[]);for(var i=0;i<e.length;i++){o[i]||(o[i]=obj.colgroup[e[i]].getAttribute("width"));var n=Array.isArray(t)&&t[i]?t[i]:t;obj.colgroup[e[i]].setAttribute("width",n),obj.options.columns[e[i]].width=n}}else o||(o=obj.colgroup[e].getAttribute("width")),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].width=t;obj.setHistory({action:"setWidth",column:e,oldValue:o,newValue:t}),obj.dispatch("onresizecolumn",el,e,t,o),obj.updateCornerPosition()}},obj.setHeight=function(e,t,o){t>0&&("object"==typeof e&&(e=e.getAttribute("data-y")),o||(o=obj.rows[e].getAttribute("height"))||(o=obj.rows[e].getBoundingClientRect().height),t=parseInt(t),obj.rows[e].style.height=t+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=t,obj.setHistory({action:"setHeight",row:e,oldValue:o,newValue:t}),obj.dispatch("onresizerow",el,e,t,o),obj.updateCornerPosition())},obj.getHeight=function(e){if(e)"object"==typeof e&&(e=$(e).getAttribute("data-y")),data=obj.rows[e].style.height;else for(var data=[],t=0;t<obj.rows.length;t++){var o=obj.rows[t].style.height;o&&(data[t]=o)}return data},obj.setFooter=function(data){if(data&&(obj.options.footers=data),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var e=0;e<obj.options.footers.length;e++){if(obj.tfoot.children[e])var tr=obj.tfoot.children[e];else{tr=document.createElement("tr");var td=document.createElement("td");tr.appendChild(td),obj.tfoot.appendChild(tr)}for(var i=0;i<obj.headers.length;i++){if(obj.options.footers[e][i]||(obj.options.footers[e][i]=""),obj.tfoot.children[e].children[i+1])td=obj.tfoot.children[e].children[i+1];else{td=document.createElement("td"),tr.appendChild(td);var t=obj.options.columns[i].align?obj.options.columns[i].align:"center";td.style.textAlign=t}td.innerText=obj.parseValue(i,e,obj.options.footers[e][i])}}}},obj.getHeader=function(e){return obj.headers[e].innerText},obj.setHeader=function(e,t){if(obj.headers[e]){var o=obj.headers[e].innerText;t||(t=prompt(obj.options.text.columnName,o)),t&&(obj.headers[e].innerText=t,obj.headers[e].setAttribute("title",t),obj.options.columns[e].title=t),obj.setHistory({action:"setHeader",column:e,oldValue:o,newValue:t}),obj.dispatch("onchangeheader",el,e,o,t)}},obj.getHeaders=function(e){for(var title=[],i=0;i<obj.headers.length;i++)title.push(obj.getHeader(i));return e?title:title.join(obj.options.csvDelimiter)},obj.getMeta=function(e,t){return e?t?obj.options.meta[e]&&obj.options.meta[e][t]?obj.options.meta[e][t]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta},obj.setMeta=function(e,t,o){if(obj.options.meta||(obj.options.meta={}),t&&o)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][t]=o;else for(var n=Object.keys(e),i=0;i<n.length;i++){obj.options.meta[n[i]]||(obj.options.meta[n[i]]={});for(var r=Object.keys(e[n[i]]),l=0;l<r.length;l++)obj.options.meta[n[i]][r[l]]=e[n[i]][r[l]]}obj.dispatch("onchangemeta",el,e,t,o)},obj.updateMeta=function(e){if(obj.options.meta){for(var t={},o=Object.keys(obj.options.meta),i=0;i<o.length;i++)e[o[i]]?t[e[o[i]]]=obj.options.meta[o[i]]:t[o[i]]=obj.options.meta[o[i]];obj.options.meta=t}},obj.getStyle=function(e,t){if(e)return e=jexcel.getIdFromColumnName(e,!0),t?obj.records[e[1]][e[0]].style[t]:obj.records[e[1]][e[0]].getAttribute("style");for(var data={},o=obj.options.data[0].length,n=obj.options.data.length,r=0;r<n;r++)for(var i=0;i<o;i++){var l=t?obj.records[r][i].style[t]:obj.records[r][i].getAttribute("style");l&&(data[jexcel.getColumnNameFromId([i,r])]=l)}return data},obj.resetStyle=function(e,t){for(var o=Object.keys(e),i=0;i<o.length;i++){var n=jexcel.getIdFromColumnName(o[i],!0);obj.records[n[1]]&&obj.records[n[1]][n[0]]&&obj.records[n[1]][n[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,t)},obj.setStyle=function(e,t,o,n,r){var l={},c={},d=function(e,t,o){var r=jexcel.getIdFromColumnName(e,!0);if(obj.records[r[1]]&&obj.records[r[1]][r[0]]&&(0==obj.records[r[1]][r[0]].classList.contains("readonly")||n)){var d=obj.records[r[1]][r[0]].style[t];d!=o||n?obj.records[r[1]][r[0]].style[t]=o:(o="",obj.records[r[1]][r[0]].style[t]=""),c[e]||(c[e]=[]),l[e]||(l[e]=[]),c[e].push([t+":"+d]),l[e].push([t+":"+o])}};if(t&&o)if("string"==typeof e)d(e,t,o);else for(var f=[],i=0;i<e.length;i++){var h=e[i].getAttribute("data-x"),m=e[i].getAttribute("data-y"),j=jexcel.getColumnNameFromId([h,m]);f[j]||(d(j,t,o),f[j]=!0)}else{var v=Object.keys(e);for(i=0;i<v.length;i++){var style=e[v[i]];"string"==typeof style&&(style=style.split(";"));for(var x=0;x<style.length;x++)"string"==typeof style[x]&&(style[x]=style[x].split(":")),style[x][0].trim()&&d(v[i],style[x][0].trim(),style[x][1])}}for(v=Object.keys(c),i=0;i<v.length;i++)c[v[i]]=c[v[i]].join(";");for(v=Object.keys(l),i=0;i<v.length;i++)l[v[i]]=l[v[i]].join(";");r||obj.setHistory({action:"setStyle",oldValue:c,newValue:l}),obj.dispatch("onchangestyle",el,e,t,o)},obj.getComments=function(e,t){if(e)return"string"==typeof e&&(e=jexcel.getIdFromColumnName(e,!0)),t?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||"";for(var data={},o=0;o<obj.options.data.length;o++)for(var i=0;i<obj.options.columns.length;i++){var n=obj.records[o][i].getAttribute("title");n&&(data[e=jexcel.getColumnNameFromId([i,o])]=n)}return data},obj.setComments=function(e,t,o){if("string"==typeof e)var n=jexcel.getIdFromColumnName(e,!0);else n=e;var title=obj.records[n[1]][n[0]].getAttribute("title"),r=[title,o=obj.records[n[1]][n[0]].getAttribute("data-author")];obj.records[n[1]][n[0]].setAttribute("title",t||""),obj.records[n[1]][n[0]].setAttribute("data-author",o||""),t?obj.records[n[1]][n[0]].classList.add("jexcel_comments"):obj.records[n[1]][n[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[t,o],oldValue:r}),obj.dispatch("oncomments",el,t,title)},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,t){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}t=null==t?obj.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var o=[];if("number"==obj.options.columns[e].type||"percentage"==obj.options.columns[e].type||"autonumber"==obj.options.columns[e].type||"color"==obj.options.columns[e].type)for(var n=0;n<obj.options.data.length;n++)o[n]=[n,Number(obj.options.data[n][e])];else if("calendar"==obj.options.columns[e].type||"checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type)for(n=0;n<obj.options.data.length;n++)o[n]=[n,obj.options.data[n][e]];else for(n=0;n<obj.options.data.length;n++)o[n]=[n,obj.records[n][e].innerText.toLowerCase()];"function"!=typeof obj.options.sorting&&(obj.options.sorting=function(e){return function(a,b){var t=a[1],o=b[1];return e?""===t&&""!==o?1:""!==t&&""===o||t>o?-1:t<o?1:0:""===t&&""!==o?1:""!==t&&""===o?-1:t>o?1:t<o?-1:0}}),o=o.sort(obj.options.sorting(t));var r=[];for(n=0;n<o.length;n++)r[n]=o[n][0];return obj.setHistory({action:"orderBy",rows:r,column:e,order:t}),obj.updateOrderArrow(e,t),obj.updateOrder(r),obj.dispatch("onsort",el,e,t),!0}},obj.updateOrderArrow=function(e,t){for(var i=0;i<obj.headers.length;i++)obj.headers[i].classList.remove("arrow-up"),obj.headers[i].classList.remove("arrow-down");t?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var data=[],t=0;t<e.length;t++)data[t]=obj.options.data[e[t]];for(obj.options.data=data,data=[],t=0;t<e.length;t++)data[t]=obj.records[e[t]];for(obj.records=data,data=[],t=0;t<e.length;t++)data[t]=obj.rows[e[t]];if(obj.rows=data,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(1==obj.options.lazyLoading)obj.loadPage(0);else for(t=0;t<obj.rows.length;t++)obj.tbody.appendChild(obj.rows[t])},obj.moveRow=function(e,t,o){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var n=1;else n=0;if(obj.isRowMerged(e).length||obj.isRowMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}o||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0?e>t?obj.tbody.insertBefore(obj.rows[e],obj.rows[t]):obj.tbody.insertBefore(obj.rows[e],obj.rows[t].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(t,0,obj.rows.splice(e,1)[0]),obj.records.splice(t,0,obj.records.splice(e,1)[0]),obj.options.data.splice(t,0,obj.options.data.splice(e,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,t)},obj.insertRow=function(e,t,o){if(1==obj.options.allowInsertRow){var data=[];if(e>0)var n=e;else n=1,e&&(data=e);o=!!o;var r=obj.options.data.length-1;if((null==t||t>=parseInt(r)||t<0)&&(t=r),!1===obj.dispatch("onbeforeinsertrow",el,t,n,o))return console.log("onbeforeinsertrow returned false"),!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var l=o?t:t+1,c=obj.records.splice(l),d=obj.options.data.splice(l),f=obj.rows.splice(l),h=[],m=[],j=[],v=l;v<n+l;v++){obj.options.data[v]=[];for(var col=0;col<obj.options.columns.length;col++)obj.options.data[v][col]=data[col]?data[col]:"";var tr=obj.createRow(v,obj.options.data[v]);f[0]?Array.prototype.indexOf.call(obj.tbody.children,f[0])>=0&&obj.tbody.insertBefore(tr,f[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0&&obj.tbody.appendChild(tr),h.push(obj.records[v]),m.push(obj.options.data[v]),j.push(tr)}Array.prototype.push.apply(obj.records,c),Array.prototype.push.apply(obj.options.data,d),Array.prototype.push.apply(obj.rows,f),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:t,numOfRows:n,insertBefore:o,rowRecords:h,rowData:m,rowNode:j}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,t,n,h,o)}},obj.deleteRow=function(e,t){if(1==obj.options.allowDeleteRow)if(1==obj.options.allowDeletingAllRows||obj.options.data.length>1){if(null==e){var o=obj.getSelectedRows();o[0]?(e=parseInt(o[0].getAttribute("data-y")),t=o.length):(e=obj.options.data.length-1,t=1)}var n=obj.options.data.length-1;if((null==e||e>n||e<0)&&(e=n),t||(t=1),e+t>=obj.options.data.length&&(t=obj.options.data.length-e),!1===obj.dispatch("onbeforedeleterow",el,e,t))return console.log("onbeforedeleterow returned false"),!1;if(parseInt(e)>-1){var r=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var l=e;l<e+t;l++)obj.isRowMerged(l,!1).length&&(r=!0);if(r){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(0==obj.options.allowDeletingAllRows&&n+1===t&&(t--,console.error("JEXCEL. It is not possible to delete the last row")),l=e;l<e+t;l++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[l])>=0&&(obj.rows[l].className="",obj.rows[l].parentNode.removeChild(obj.rows[l]));var c=obj.records.splice(e,t),d=obj.options.data.splice(e,t),f=obj.rows.splice(e,t);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+t-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:c,rowData:d,rowNode:f}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,t,c)}}else console.error("JEXCEL. It is not possible to delete the last row")},obj.moveColumn=function(e,t){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var o=1;else o=0;if(obj.isColMerged(e).length||obj.isColMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((e=parseInt(e))>(t=parseInt(t))){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t]);for(var n=0;n<obj.rows.length;n++)obj.rows[n].insertBefore(obj.records[n][e],obj.records[n][t])}else for(obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t].nextSibling),n=0;n<obj.rows.length;n++)obj.rows[n].insertBefore(obj.records[n][e],obj.records[n][t].nextSibling);for(obj.options.columns.splice(t,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(t,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(t,0,obj.colgroup.splice(e,1)[0]),n=0;n<obj.rows.length;n++)obj.options.data[n].splice(t,0,obj.options.data[n].splice(e,1)[0]),obj.records[n].splice(t,0,obj.records[n].splice(e,1)[0]);if(obj.options.footers)for(n=0;n<obj.options.footers.length;n++)obj.options.footers[n].splice(t,0,obj.options.footers[n].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,t)},obj.insertColumn=function(e,t,o,n){if(1==obj.options.allowInsertColumn){var data=[];if(e>0)var r=e;else r=1,e&&(data=e);o=!!o;var l=obj.options.columns.length-1;if((null==t||t>=parseInt(l)||t<0)&&(t=l),!1===obj.dispatch("onbeforeinsertcolumn",el,t,r,o))return console.log("onbeforeinsertcolumn returned false"),!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}n||(n=[]);for(var i=0;i<r;i++)n[i]||(n[i]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var c=o?t:t+1;obj.options.columns=jexcel.injectArray(obj.options.columns,c,n);for(var d=obj.headers.splice(c),f=obj.colgroup.splice(c),h=[],m=[],j=[],v=[],x=[],col=c;col<r+c;col++)obj.createCellHeader(col),obj.headerContainer.insertBefore(obj.headers[col],obj.headerContainer.children[col+1]),obj.colgroupContainer.insertBefore(obj.colgroup[col],obj.colgroupContainer.children[col+1]),h.push(obj.headers[col]),m.push(obj.colgroup[col]);if(obj.options.footers)for(var w=0;w<obj.options.footers.length;w++){for(x[w]=[],i=0;i<r;i++)x[w].push("");obj.options.footers[w].splice(c,0,x[w])}for(var y=0;y<obj.options.data.length;y++){var C=obj.options.data[y].splice(c),E=obj.records[y].splice(c);for(v[y]=[],j[y]=[],col=c;col<r+c;col++){var A=data[y]?data[y]:"";obj.options.data[y][col]=A;var td=obj.createCell(col,y,obj.options.data[y][col]);obj.records[y][col]=td,obj.rows[y]&&obj.rows[y].insertBefore(td,obj.rows[y].children[col+1]),v[y].push(A),j[y].push(td)}Array.prototype.push.apply(obj.options.data[y],C),Array.prototype.push.apply(obj.records[y],E)}if(Array.prototype.push.apply(obj.headers,d),Array.prototype.push.apply(obj.colgroup,f),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(w=0;w<obj.options.nestedHeaders.length;w++){var L=parseInt(obj.options.nestedHeaders[w][obj.options.nestedHeaders[w].length-1].colspan)+r;obj.options.nestedHeaders[w][obj.options.nestedHeaders[w].length-1].colspan=L,obj.thead.children[w].children[obj.thead.children[w].children.length-1].setAttribute("colspan",L);var I=obj.thead.children[w].children[obj.thead.children[w].children.length-1].getAttribute("data-column");for(I=I.split(","),col=c;col<r+c;col++)I.push(col);obj.thead.children[w].children[obj.thead.children[w].children.length-1].setAttribute("data-column",I)}else L=parseInt(obj.options.nestedHeaders[0].colspan)+r,obj.options.nestedHeaders[0].colspan=L,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",L);obj.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:r,insertBefore:o,columns:n,headers:h,colgroup:m,records:j,footers:x,data:v}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,t,r,j,o)}},obj.deleteColumn=function(e,t){if(1==obj.options.allowDeleteColumn)if(obj.headers.length>1){if(null==e){var o=obj.getSelectedColumns(!0);o.length?(e=parseInt(o[0]),t=parseInt(o.length)):(e=obj.headers.length-1,t=1)}var n=obj.options.data[0].length-1;if((null==e||e>n||e<0)&&(e=n),t||(t=1),t>obj.options.data[0].length-e&&(t=obj.options.data[0].length-e),!1===obj.dispatch("onbeforedeletecolumn",el,e,t))return console.log("onbeforedeletecolumn returned false"),!1;if(parseInt(e)>-1){var r=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var col=e;col<e+t;col++)obj.isColMerged(col,!1).length&&(r=!0);if(r){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var l=obj.options.columns.splice(e,t);for(col=e;col<e+t;col++)obj.colgroup[col].className="",obj.headers[col].className="",obj.colgroup[col].parentNode.removeChild(obj.colgroup[col]),obj.headers[col].parentNode.removeChild(obj.headers[col]);for(var c=obj.headers.splice(e,t),d=obj.colgroup.splice(e,t),f=[],h=[],m=[],j=0;j<obj.options.data.length;j++)for(col=e;col<e+t;col++)obj.records[j][col].className="",obj.records[j][col].parentNode.removeChild(obj.records[j][col]);for(j=0;j<obj.options.data.length;j++)h[j]=obj.options.data[j].splice(e,t),f[j]=obj.records[j].splice(e,t);if(obj.options.footers)for(j=0;j<obj.options.footers.length;j++)m[j]=obj.options.footers[j].splice(e,t);if(obj.conditionalSelectionUpdate(0,e,e+t-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var v=0;v<obj.options.nestedHeaders.length;v++){var x=parseInt(obj.options.nestedHeaders[v][obj.options.nestedHeaders[v].length-1].colspan)-t;obj.options.nestedHeaders[v][obj.options.nestedHeaders[v].length-1].colspan=x,obj.thead.children[v].children[obj.thead.children[v].children.length-1].setAttribute("colspan",x)}else x=parseInt(obj.options.nestedHeaders[0].colspan)-t,obj.options.nestedHeaders[0].colspan=x,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",x);obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:l,headers:c,colgroup:d,records:f,footers:m,data:h}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,t,f)}}else console.error("JEXCEL. It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var t=[],o=0;o<obj.rows.length;o++)obj.rows[o].classList.contains("selected")&&(e?t.push(o):t.push(obj.rows[o]));return t},obj.getSelectedColumns=function(){for(var e=[],i=0;i<obj.headers.length;i++)obj.headers[i].classList.contains("selected")&&e.push(i);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var i=0;i<obj.headers.length;i++)(r=obj.headers[i].getAttribute("data-x"))!=i&&(obj.headers[i].setAttribute("data-x",i),obj.headers[i].getAttribute("title")||(obj.headers[i].innerHTML=jexcel.getColumnName(i)));for(var e=0;e<obj.rows.length;e++)obj.rows[e]&&(l=obj.rows[e].getAttribute("data-y"))!=e&&(obj.rows[e].setAttribute("data-y",e),obj.rows[e].children[0].setAttribute("data-y",e),obj.rows[e].children[0].innerHTML=e+1);var t=[],o=[],n=function(e,o,i,n){if(e!=i&&obj.records[n][i].setAttribute("data-x",i),o!=n&&obj.records[n][i].setAttribute("data-y",n),e!=i||o!=n){var r=jexcel.getColumnNameFromId([e,o]),l=jexcel.getColumnNameFromId([i,n]);t[r]=l}};for(e=0;e<obj.records.length;e++)for(i=0;i<obj.records[0].length;i++)if(obj.records[e][i]){var r=obj.records[e][i].getAttribute("data-x"),l=obj.records[e][i].getAttribute("data-y");if(obj.records[e][i].getAttribute("data-merged")){var c=jexcel.getColumnNameFromId([r,l]),d=jexcel.getColumnNameFromId([i,e]);if(null==o[c])if(c==d)o[c]=!1;else{var f=parseInt(i-r),h=parseInt(e-l);o[c]=[d,f,h]}}else n(r,l,i,e)}var m=Object.keys(o);if(m.length)for(i=0;i<m.length;i++)if(o[m[i]]){var j=jexcel.getIdFromColumnName(m[i],!0);for(n(r=j[0],l=j[1],r+o[m[i]][1],l+o[m[i]][2]),c=m[i],d=o[m[i]][0],e=0;e<obj.options.mergeCells[c][2].length;e++)r=parseInt(obj.options.mergeCells[c][2][e].getAttribute("data-x")),l=parseInt(obj.options.mergeCells[c][2][e].getAttribute("data-y")),obj.options.mergeCells[c][2][e].setAttribute("data-x",r+o[m[i]][1]),obj.options.mergeCells[c][2][e].setAttribute("data-y",l+o[m[i]][2]);obj.options.mergeCells[d]=obj.options.mergeCells[c],delete obj.options.mergeCells[c]}obj.updateFormulas(t),obj.updateMeta(t),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var e=0,t=obj.rows.length-1;t>=0;t--){for(var o=!1,i=0;i<obj.headers.length;i++)obj.options.data[t][i]&&(o=!0);if(o)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){var n=0;for(i=obj.headers.length-1;i>=0;i--){for(o=!1,t=0;t<obj.rows.length;t++)obj.options.data[t][i]&&(o=!0);if(o)break;n++}obj.options.minSpareCols-n>0&&obj.insertColumn(obj.options.minSpareCols-n)}if("function"==typeof obj.options.updateTable){for(obj.options.detachForUpdates&&el.removeChild(obj.content),t=0;t<obj.rows.length;t++)for(i=0;i<obj.headers.length;i++)obj.options.updateTable(el,obj.records[t][i],i,t,obj.options.data[t][i],obj.records[t][i].innerText,jexcel.getColumnNameFromId([i,t]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout((function(){obj.updateCornerPosition()}),0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,t){(e=obj.getCell(e))&&(t?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="";for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display=""},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none";for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="none"},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,t,o){var n=jexcel.getColumnNameFromId([e,t]);if(obj.formula[n]&&obj.formula[n].length>0)if(chainLoopProtection[n])obj.records[t][e].innerHTML="#ERROR",obj.formula[n]="";else{chainLoopProtection[n]=!0;for(var i=0;i<obj.formula[n].length;i++){var r=jexcel.getIdFromColumnName(obj.formula[n][i],!0),l=""+obj.options.data[r[1]][r[0]];"="==l.substr(0,1)?o.push(obj.updateCell(r[0],r[1],l,!0)):Object.keys(obj.formula)[i]=null,obj.updateFormulaChain(r[0],r[1],o)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var t=0;t<obj.options.data.length;t++)for(var i=0;i<obj.options.data[0].length;i++)if("="==(c=""+obj.options.data[t][i]).substr(0,1)){var o=obj.updateFormula(c,e);o!=c&&(obj.options.data[t][i]=o)}var n=[],r=Object.keys(obj.formula);for(t=0;t<r.length;t++){var l=r[t],c=obj.formula[l];for(e[l]&&(l=e[l]),n[l]=[],i=0;i<c.length;i++){var d=c[i];e[d]&&(d=e[d]),n[l].push(d)}}obj.formula=n},obj.updateFormula=function(e,t){for(var o=/[A-Z]/,n=/[0-9]/,r="",l=null,c=null,d="",f=0;f<e.length;f++)o.exec(e[f])?(l=1,c=0,d+=e[f]):n.exec(e[f])?(c=l?1:0,d+=e[f]):(l&&c&&(d=t[d]?t[d]:d),r+=d,r+=e[f],l=0,c=0,d="");return d&&(l&&c&&(d=t[d]?t[d]:d),r+=d),r};var secureFormula=function(e){for(var t="",o=0,i=0;i<e.length;i++)'"'==e[i]&&(o=0==o?1:0),t+=1==o?e[i]:e[i].toUpperCase();return t};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){var o=[],n=e[t].split(":"),r=jexcel.getIdFromColumnName(n[0],!0),l=jexcel.getIdFromColumnName(n[1],!0);if(r[0]<=l[0])var c=r[0],d=l[0];else c=l[0],d=r[0];if(r[1]<=l[1])var f=r[1],h=l[1];else f=l[1],h=r[1];for(var m=f;m<=h;m++)for(var i=c;i<=d;i++)o.push(jexcel.getColumnNameFromId([i,m]));expression=expression.replace(e[t],o.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var evalstring="",tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";if(tokens)for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(void 0!==obj.options.data[position[1]]&&void 0!==obj.options.data[position[1]][position[0]])var value=obj.options.data[position[1]][position[0]];else var value="";if("="==(""+value).substr(0,1)&&(formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim())evalstring+="var "+tokens[i]+" = null;";else if(value==Number(value)&&1==obj.options.autoCasting)evalstring+="var "+tokens[i]+" = "+Number(value)+";";else{var number=obj.parseNumber(value,position[0]);1==obj.options.autoCasting&&number?evalstring+="var "+tokens[i]+" = "+number+";":evalstring+="var "+tokens[i]+" = '"+value+"';"}}try{evalstring+="function COLUMN() { return parseInt(x) + 1; }; function ROW() { return parseInt(y) + 1; }; function CELL() { return parentId; }; function TABLE() { return obj; }; function VALUE(col, row) { return obj.records[row-1][col-1].innerHTML; }; function THISROWCELL(col) { var id = jexcel.getIdFromColumnName(col+(parseInt(y)+1), true); return obj.records[id[1]][id[0]].innerHTML; }";var res=eval(evalstring+expression.substr(1))}catch(e){var res="#ERROR"}return res};return execute(expression,x,y)},obj.parseNumber=function(e,t){var o=t&&obj.options.columns[t].decimal?obj.options.columns[t].decimal:".",n=""+e;if((n=n.split(o))[0]=n[0].match(/[+-]?[0-9]/g),n[0]&&(n[0]=n[0].join("")),n[1]&&(n[1]=n[1].match(/[0-9]*/g).join("")),n[0]&&Number(n[0])>=0)if(n[1])e=Number(n[0]+"."+n[1]);else var e=Number(n[0]+".00");else e=null;return e},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,t){if(e?obj.selectedCell[3]>0&&obj.up.visible(1,t?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)if(0==obj.selectedCell[1]||0==obj.selectedCell[3])obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var o=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-o<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}obj.updateScroll(1)},obj.up.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var r=0;r<n;r++)if("none"!=obj.records[r][o].style.display&&"none"!=obj.rows[r].style.display){n=r;break}}else n=obj.up.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.up.get=function(e,t){e=parseInt(e);for(var o=(t=parseInt(t))-1;o>=0;o--)if("none"!=obj.records[o][e].style.display&&"none"!=obj.rows[o].style.display){if(obj.records[o][e].getAttribute("data-merged")&&obj.records[o][e]==obj.records[t][e])continue;t=o;break}return t},obj.down=function(e,t){if(e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,t?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}obj.updateScroll(3)},obj.down.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var r=obj.rows.length-1;r>n;r--)if("none"!=obj.records[r][o].style.display&&"none"!=obj.rows[r].style.display){n=r;break}}else n=obj.down.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.down.get=function(e,t){e=parseInt(e);for(var o=(t=parseInt(t))+1;o<obj.rows.length;o++)if("none"!=obj.records[o][e].style.display&&"none"!=obj.rows[o].style.display){if(obj.records[o][e].getAttribute("data-merged")&&obj.records[o][e]==obj.records[t][e])continue;t=o;break}return t},obj.right=function(e,t){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,t?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var i=obj.headers.length-1;i>o;i--)if("none"!=obj.records[n][i].style.display){o=i;break}}else o=obj.right.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.right.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var i=e+1;i<obj.headers.length;i++)if("none"!=obj.records[t][i].style.display){if(obj.records[t][i].getAttribute("data-merged")&&obj.records[t][i]==obj.records[t][e])continue;e=i;break}return e},obj.left=function(e,t){e?obj.selectedCell[2]>0&&obj.left.visible(1,t?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,t){if(0==e)var o=parseInt(obj.selectedCell[0]),n=parseInt(obj.selectedCell[1]);else o=parseInt(obj.selectedCell[2]),n=parseInt(obj.selectedCell[3]);if(0==t){for(var i=0;i<o;i++)if("none"!=obj.records[n][i].style.display){o=i;break}}else o=obj.left.get(o,n);0==e?(obj.selectedCell[0]=o,obj.selectedCell[1]=n):(obj.selectedCell[2]=o,obj.selectedCell[3]=n)},obj.left.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var i=e-1;i>=0;i--)if("none"!=obj.records[t][i].style.display){if(obj.records[t][i].getAttribute("data-merged")&&obj.records[t][i]==obj.records[t][e])continue;e=i;break}return e},obj.first=function(e,t){if(e?t?obj.selectedCell[3]=0:obj.left.visible(1,0):(t?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||0!=obj.selectedCell[1]&&0!=obj.selectedCell[3]){if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,t){if(e?t?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(t?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){if(1==obj.options.search&&obj.results)var t=obj.results;else t=obj.rows;var o=100;null!=e&&-1!=e||(e=Math.ceil(t.length/o)-1);var n=e*o,r=e*o+o;r>t.length&&(r=t.length),(n=r-100)<0&&(n=0);for(var l=n;l<r;l++)1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[t[l]]):obj.tbody.appendChild(obj.rows[l]),obj.tbody.children.length>o&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(1==obj.options.search&&obj.results)var e=obj.results;else e=obj.rows;var t=0;if(e.length>100){var o=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(o=e.indexOf(o)),o>0)for(var n=0;n<30;n++)(o-=1)>-1&&(1==obj.options.search&&obj.results?obj.tbody.insertBefore(obj.rows[e[o]],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[o],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),t=1))}return t},obj.loadDown=function(){if(1==obj.options.search&&obj.results)var e=obj.results;else e=obj.rows;var t=0;if(e.length>100){var o=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(o=e.indexOf(o)),o<obj.rows.length-1)for(var n=0;n<=30;n++)o<e.length&&(1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[e[o]]):obj.tbody.appendChild(obj.rows[o]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),t=1)),o+=1}return t},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(obj.selectedCell[3]/100),o=parseInt(obj.rows.length/100);if(e!=t&&t<=o&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(t),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(e){if(e&&(e=e.toLowerCase()),obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],e){var t=function(e){-1==obj.results.indexOf(e)&&obj.results.push(e)};obj.options.data.filter((function(o,n){if(function(e,t,o){for(var i=0;i<e.length;i++)if((""+e[i]).toLowerCase().search(t)>=0||(""+obj.records[o][i].innerHTML).toLowerCase().search(t)>=0)return!0;return!1}(o,e,n)){var r=obj.isRowMerged(n);if(r.length)for(var i=0;i<r.length;i++)for(var l=jexcel.getIdFromColumnName(r[i],!0),c=0;c<obj.options.mergeCells[r[i]][1];c++)t(l[1]+c);else t(n);return!0}return!1}))}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var e=0,t=0;for(e=1==obj.options.lazyLoading?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var o=0;o<obj.rows.length;o++)!obj.results||obj.results.indexOf(o)>-1?(t<e&&(obj.tbody.appendChild(obj.rows[o]),t++),obj.rows[o].style.display=""):obj.rows[o].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return 1==obj.options.search&&obj.results&&(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var t=obj.pageNumber;if(1==obj.options.search&&obj.results)var o=obj.results;else o=obj.rows;var n=parseInt(obj.options.pagination);null!=e&&-1!=e||(e=Math.ceil(o.length/n)-1),obj.pageNumber=e;var r=e*n,l=e*n+n;for(l>o.length&&(l=o.length),r<0&&(r=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var c=r;c<l;c++)1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[o[c]]):obj.tbody.appendChild(obj.rows[c]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,t)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(1==obj.options.search&&obj.results)var e=obj.results.length;else e=obj.rows.length;if(e){var t=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6)var o=1,n=t<10?t:10;else t-obj.pageNumber<5?(n=t,(o=t-9)<1&&(o=1)):(o=obj.pageNumber-4,n=obj.pageNumber+5);o>1&&((r=document.createElement("div")).className="jexcel_page",r.innerHTML="<",r.title=1,obj.pagination.children[1].appendChild(r));for(var i=o;i<=n;i++){var r;(r=document.createElement("div")).className="jexcel_page",r.innerHTML=i,obj.pagination.children[1].appendChild(r),obj.pageNumber==i-1&&r.classList.add("jexcel_page_selected")}n<t&&((r=document.createElement("div")).className="jexcel_page",r.innerHTML=">",r.title=t,obj.pagination.children[1].appendChild(r)),obj.pagination.children[0].innerHTML=function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,o){return void 0!==t[o]?t[o]:e}))}(obj.options.text.showingPage,obj.pageNumber+1,t)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(e){if(0==obj.options.allowExport)console.error("Export not allowed");else{var data="";1!=e&&1!=obj.options.includeHeadersOnDownload||(data+=obj.getHeaders().replace(/\s+/gm," "),data+="\r\n"),data+=obj.copy(!1,obj.options.csvDelimiter,!0);var t=new Blob(["\ufeff"+data],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(t,obj.options.csvFileName+".csv");else{var o=document.createElement("a"),n=URL.createObjectURL(t);o.href=n,o.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(o),o.click(),o.parentNode.removeChild(o)}}},obj.setHistory=function(e){if(1!=obj.ignoreHistory){var t=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,t+1),obj.history[t]=e}},obj.copy=function(e,t,o){t||(t="\t");var header=[],col=[],n=[],r=[],l=[],c=obj.options.data[0].length,d=obj.options.data.length,f="",h=obj.options.includeHeadersOnCopy;obj.style=[];for(var m=0;m<d;m++){col=[],n=[];for(var i=0;i<c;i++)if(!e||obj.records[m][i].classList.contains("highlight")){1==h&&header.push(obj.headers[i].innerText);var j=obj.options.data[m][i];if(j.match&&(j.match(/,/g)||j.match(/\n/)||j.match(/\"/))&&(j='"'+(j=j.replace(new RegExp('"',"g"),'""'))+'"'),col.push(j),"checkbox"==obj.options.columns[i].type||"radio"==obj.options.columns[i].type)var label=j;else(label=1==obj.options.stripHTMLOnCopy?obj.records[m][i].innerText:obj.records[m][i].innerHTML).match&&(label.match(/,/g)||label.match(/\n/)||label.match(/\"/))&&(label='"'+(label=label.replace(new RegExp('"',"g"),'""'))+'"');n.push(label),f=(f=obj.records[m][i].getAttribute("style")).replace("display: none;",""),obj.style.push(f||"")}col.length&&(h&&r.push(header.join(t)),r.push(col.join(t))),n.length&&(h&&l.push(header.join(t)),l.push(n.join(t))),h=!1}var v=r.join("\r\n"),x=l.join("\r\n");if(o||(1==obj.options.copyCompatibility?obj.textarea.value=x:obj.textarea.value=v,obj.textarea.select(),document.execCommand("copy")),1==obj.options.copyCompatibility?obj.data=x:obj.data=v,obj.hashString=obj.hash(obj.data),obj.removeCopyingSelection(),obj.highlighted)for(i=0;i<obj.highlighted.length;i++)obj.highlighted[i].classList.add("copying"),obj.highlighted[i].classList.contains("highlight-left")&&obj.highlighted[i].classList.add("copying-left"),obj.highlighted[i].classList.contains("highlight-right")&&obj.highlighted[i].classList.add("copying-right"),obj.highlighted[i].classList.contains("highlight-top")&&obj.highlighted[i].classList.add("copying-top"),obj.highlighted[i].classList.contains("highlight-bottom")&&obj.highlighted[i].classList.add("copying-bottom");return obj.dispatch("oncopy",el,1==obj.options.copyCompatibility?l:r,obj.hashString),obj.data},obj.paste=function(e,t,data){var o=obj.dispatch("onbeforepaste",el,data,e,t);if(!1===o)return!1;o&&(data=o);var n=obj.hash(data),style=n==obj.hashString?obj.style:null;if(1==obj.options.copyCompatibility&&n==obj.hashString&&(data=obj.data),data=obj.parseCSV(data,"\t"),null!=e&&null!=t&&data){for(var i=0,r=0,l=[],c={},d={},f=0,h=parseInt(e),m=parseInt(t),j=null;j=data[r];){for(i=0,h=parseInt(e);null!=j[i];){var v=obj.updateCell(h,m,j[i]);if(l.push(v),obj.updateFormulaChain(h,m,l),style&&style[f]){var x=jexcel.getColumnNameFromId([h,m]);c[x]=style[f],d[x]=obj.getStyle(x),obj.records[m][h].setAttribute("style",style[f]),f++}null!=j[++i]&&(h>=obj.headers.length-1&&obj.insertColumn(),h=obj.right.get(h,m))}data[++r]&&(m>=obj.rows.length-1&&obj.insertRow(),m=obj.down.get(e,m))}obj.updateSelectionFromCoords(e,t,h,m),obj.setHistory({action:"setValue",records:l,selection:obj.selectedCell,newStyle:c,oldStyle:d}),obj.updateTable(),obj.dispatch("onpaste",el,data),obj.onafterchanges(el,l)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),i=0;i<e.length;i++)e[i].classList.remove("copying"),e[i].classList.remove("copying-left"),e[i].classList.remove("copying-right"),e[i].classList.remove("copying-top"),e[i].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,t){var o=t.insertBefore?t.rowNumber:t.rowNumber+1;if(1==obj.options.search&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),1==e){for(var n=t.numOfRows,r=o;r<n+o;r++)obj.rows[r].parentNode.removeChild(obj.rows[r]);obj.records.splice(o,n),obj.options.data.splice(o,n),obj.rows.splice(o,n),obj.conditionalSelectionUpdate(1,o,n+o-1)}else{obj.records=jexcel.injectArray(obj.records,o,t.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,o,t.rowData),obj.rows=jexcel.injectArray(obj.rows,o,t.rowNode);var l=0;for(r=o;r<t.numOfRows+o;r++)obj.tbody.insertBefore(t.rowNode[l],obj.tbody.children[r]),l++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,t){var o=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){var n=t.numOfColumns;obj.options.columns.splice(o,n);for(var i=o;i<n+o;i++)obj.headers[i].parentNode.removeChild(obj.headers[i]),obj.colgroup[i].parentNode.removeChild(obj.colgroup[i]);obj.headers.splice(o,n),obj.colgroup.splice(o,n);for(var r=0;r<t.data.length;r++){for(i=o;i<n+o;i++)obj.records[r][i].parentNode.removeChild(obj.records[r][i]);obj.records[r].splice(o,n),obj.options.data[r].splice(o,n)}if(obj.options.footers)for(r=0;r<obj.options.footers.length;r++)obj.options.footers[r].splice(o,n)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,o,t.columns),obj.headers=jexcel.injectArray(obj.headers,o,t.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,o,t.colgroup);var l=0;for(i=o;i<t.numOfColumns+o;i++)obj.headerContainer.insertBefore(t.headers[l],obj.headerContainer.children[i+1]),obj.colgroupContainer.insertBefore(t.colgroup[l],obj.colgroupContainer.children[i+1]),l++;for(r=0;r<t.data.length;r++)for(obj.options.data[r]=jexcel.injectArray(obj.options.data[r],o,t.data[r]),obj.records[r]=jexcel.injectArray(obj.records[r],o,t.records[r]),l=0,i=o;i<t.numOfColumns+o;i++)obj.rows[r].insertBefore(t.records[r][l],obj.rows[r].children[i+1]),l++;if(obj.options.footers)for(r=0;r<obj.options.footers.length;r++)obj.options.footers[r]=jexcel.injectArray(obj.options.footers[r],o,t.footers[r])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(r=0;r<obj.options.nestedHeaders.length;r++){if(1==e)var c=parseInt(obj.options.nestedHeaders[r][obj.options.nestedHeaders[r].length-1].colspan)-t.numOfColumns;else c=parseInt(obj.options.nestedHeaders[r][obj.options.nestedHeaders[r].length-1].colspan)+t.numOfColumns;obj.options.nestedHeaders[r][obj.options.nestedHeaders[r].length-1].colspan=c,obj.thead.children[r].children[obj.thead.children[r].children.length-1].setAttribute("colspan",c)}else c=1==e?parseInt(obj.options.nestedHeaders[0].colspan)-t.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+t.numOfColumns,obj.options.nestedHeaders[0].colspan=c,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",c);obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var o=[];if(obj.historyIndex>=0){var n=obj.history[obj.historyIndex--];if("insertRow"==n.action)obj.historyProcessRow(1,n);else if("deleteRow"==n.action)obj.historyProcessRow(0,n);else if("insertColumn"==n.action)obj.historyProcessColumn(1,n);else if("deleteColumn"==n.action)obj.historyProcessColumn(0,n);else if("moveRow"==n.action)obj.moveRow(n.newValue,n.oldValue);else if("moveColumn"==n.action)obj.moveColumn(n.newValue,n.oldValue);else if("setMerge"==n.action)obj.removeMerge(n.column,n.data);else if("setStyle"==n.action)obj.setStyle(n.oldValue,null,null,1);else if("setWidth"==n.action)obj.setWidth(n.column,n.oldValue);else if("setHeight"==n.action)obj.setHeight(n.row,n.oldValue);else if("setHeader"==n.action)obj.setHeader(n.column,n.oldValue);else if("setComments"==n.action)obj.setComments(n.column,n.oldValue[0],n.oldValue[1]);else if("orderBy"==n.action){for(var r=[],l=0;l<n.rows.length;l++)r[n.rows[l]]=l;obj.updateOrderArrow(n.column,n.order?0:1),obj.updateOrder(r)}else if("setValue"==n.action){for(var i=0;i<n.records.length;i++)o.push({x:n.records[i].x,y:n.records[i].y,newValue:n.records[i].oldValue}),n.oldStyle&&obj.resetStyle(n.oldStyle);obj.setValue(o),n.selection&&obj.updateSelectionFromCoords(n.selection[0],n.selection[1],n.selection[2],n.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onundo",el,n)},obj.redo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var o=obj.history[++obj.historyIndex];if("insertRow"==o.action)obj.historyProcessRow(0,o);else if("deleteRow"==o.action)obj.historyProcessRow(1,o);else if("insertColumn"==o.action)obj.historyProcessColumn(0,o);else if("deleteColumn"==o.action)obj.historyProcessColumn(1,o);else if("moveRow"==o.action)obj.moveRow(o.oldValue,o.newValue);else if("moveColumn"==o.action)obj.moveColumn(o.oldValue,o.newValue);else if("setMerge"==o.action)obj.setMerge(o.column,o.colspan,o.rowspan,1);else if("setStyle"==o.action)obj.setStyle(o.newValue,null,null,1);else if("setWidth"==o.action)obj.setWidth(o.column,o.newValue);else if("setHeight"==o.action)obj.setHeight(o.row,o.newValue);else if("setHeader"==o.action)obj.setHeader(o.column,o.newValue);else if("setComments"==o.action)obj.setComments(o.column,o.newValue[0],o.newValue[1]);else if("orderBy"==o.action)obj.updateOrderArrow(o.column,o.order),obj.updateOrder(o.rows);else if("setValue"==o.action){obj.setValue(o.records);for(var i=0;i<o.records.length;i++)o.oldStyle&&obj.resetStyle(o.newStyle);o.selection&&obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onredo",el,o)},obj.getDropDownValue=function(e,t){var o=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var n=[],source=obj.options.columns[e].source,i=0;i<source.length;i++)"object"==typeof source[i]?n[source[i].id]=source[i].name:n[source[i]]=source[i];var r=Array.isArray(t)?t:(""+t).split(";");for(i=0;i<r.length;i++)"object"==typeof r[i]?o.push(n[r[i].id]):n[r[i]]&&o.push(n[r[i]])}else console.error("Invalid column");return o.length>0?o.join("; "):""},obj.parseCSV=function(e,t){9==(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)&&(e+="\0"),t=t||",";for(var o=[],n=!1,r=0,col=0,l=0;l<e.length;l++){var c=e[l],d=e[l+1];o[r]=o[r]||[],o[r][col]=o[r][col]||"",'"'==c&&n&&'"'==d?(o[r][col]+=c,++l):'"'!=c?c!=t||n?"\r"!=c||"\n"!=d||n?"\n"==c&&!n||"\r"==c&&!n?(++r,col=0):o[r][col]+=c:(++r,col=0,++l):++col:n=!n}return o},obj.hash=function(e){var i,t=0;if(0===e.length)return t;for(i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t},obj.onafterchanges=function(e,t){obj.dispatch("onafterchanges",e,t)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,"function"==typeof jexcel.build&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",(function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())})),obj.options.csv?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){var t=obj.parseCSV(e,obj.options.csvDelimiter);if(1==obj.options.csvHeaders&&t.length>0)for(var o=t.shift(),i=0;i<o.length;i++)obj.options.columns[i]||(obj.options.columns[i]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),void 0===obj.options.columns[i].title&&(obj.options.columns[i].title=o[i]);obj.options.data=t,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.prepareTable()},options&&null!=options.contextMenu?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,t,o,n){var r=[];if(null==o)1==obj.options.allowInsertColumn&&r.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(t),1)}}),1==obj.options.allowInsertColumn&&r.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(t),0)}}),1==obj.options.allowDeleteColumn&&r.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(t))}}),1==obj.options.allowRenameColumn&&r.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(t)}}),1==obj.options.columnSorting&&(r.push({type:"line"}),r.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(t,0)}}),r.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(t,1)}}));else if(1==obj.options.allowInsertRow&&(r.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(o),1)}}),r.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(o))}})),1==obj.options.allowDeleteRow&&r.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(o))}}),t&&1==obj.options.allowComments){r.push({type:"line"});var title=obj.records[o][t].getAttribute("title")||"";r.push({title:title?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var e=prompt(obj.options.text.comments,title);e&&obj.setComments([t,o],e)}}),title&&r.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([t,o],"")}})}return r.push({type:"line"}),r.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&r.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then((function(text){text&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],text)}))}}),obj.options.allowExport&&r.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&r.push({title:obj.options.text.about,onclick:function(){alert(obj.options.about)}}),r},obj.scrollControls=function(e){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),1!=obj.options.lazyLoading&&1!=obj.options.tableOverflow||obj.edition&&"jdropdown"!=e.target.className.substr(0,9)&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){1==obj.options.lazyLoading&&null==jexcel.timeControlLoading&&(jexcel.timeControlLoading=setTimeout((function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null}),100))},obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var i=0;i<obj.options.freezeColumns;i++)e+=parseInt(obj.options.columns[i].width);return e};var scrollLeft=0;return obj.updateFreezePosition=function(){var e=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var i=0;i<obj.options.freezeColumns;i++){i>0&&(e+=parseInt(obj.options.columns[i-1].width)),obj.headers[i].classList.add("jexcel_freezed"),obj.headers[i].style.left=e+"px";for(var t=0;t<obj.rows.length;t++)if(obj.rows[t]&&obj.records[t][i]){var o=scrollLeft+(i>0?obj.records[t][i-1].style.width:0)-51+"px";obj.records[t][i].classList.add("jexcel_freezed"),obj.records[t][i].style.left=o}}else for(i=0;i<obj.options.freezeColumns;i++)for(obj.headers[i].classList.remove("jexcel_freezed"),obj.headers[i].style.left="",t=0;t<obj.rows.length;t++)obj.records[t][i]&&(obj.records[t][i].classList.remove("jexcel_freezed"),obj.records[t][i].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,obj.init(),obj};jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null,jexcel.destroy=function(element,e){if(element.jexcel){var t=element.jexcel.options.root?element.jexcel.options.root:document;element.removeEventListener("DOMMouseScroll",element.jexcel.scrollControls),element.removeEventListener("mousewheel",element.jexcel.scrollControls),element.jexcel=null,element.innerHTML="",e&&(t.removeEventListener("mouseup",jexcel.mouseUpControls),t.removeEventListener("mousedown",jexcel.mouseDownControls),t.removeEventListener("mousemove",jexcel.mouseMoveControls),t.removeEventListener("mouseover",jexcel.mouseOverControls),t.removeEventListener("dblclick",jexcel.doubleClickControls),t.removeEventListener("paste",jexcel.pasteControls),t.removeEventListener("contextmenu",jexcel.contextMenuControls),t.removeEventListener("touchstart",jexcel.touchStartControls),t.removeEventListener("touchend",jexcel.touchEndControls),t.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls),jexcel=null)}},jexcel.build=function(e){e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(27==e.which)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault();else if(13==e.which)if("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if("dropdown"==jexcel.current.options.columns[jexcel.current.edition[2]].type||"autocomplete"==jexcel.current.options.columns[jexcel.current.edition[2]].type);else if((1==jexcel.current.options.wordWrap||1==jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var t=jexcel.current.edition[0].children[0],o=jexcel.current.edition[0].children[0].value,n=t.selectionStart;o=o.slice(0,n)+"\n"+o.slice(n),t.value=o,t.focus(),t.selectionStart=n+1,t.selectionEnd=n+1}else jexcel.current.edition[0].children[0].blur();else 9==e.which&&("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(37==e.which)jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault();else if(39==e.which)jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault();else if(38==e.which)jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault();else if(40==e.which)jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault();else if(36==e.which)jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault();else if(35==e.which)jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault();else if(32==e.which)1==jexcel.current.options.editable&&jexcel.current.setCheckRadioValue(),e.preventDefault();else if(46==e.which)1==jexcel.current.options.editable&&(jexcel.current.selectedRow?1==jexcel.current.options.allowDeleteRow&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?1==jexcel.current.options.allowDeleteColumn&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(13==e.which)e.shiftKey?jexcel.current.up():(1==jexcel.current.options.allowInsertRow&&1==jexcel.current.options.allowManualInsertRow&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault();else if(9==e.which)e.shiftKey?jexcel.current.left():(1==jexcel.current.options.allowInsertColumn&&1==jexcel.current.options.allowManualInsertColumn&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(jexcel.current.selectedCell&&1==jexcel.current.options.editable){var r=jexcel.current.selectedCell[1],l=jexcel.current.selectedCell[0];"readonly"!=jexcel.current.options.columns[l].type&&(32==e.keyCode?"checkbox"==jexcel.current.options.columns[l].type||"radio"==jexcel.current.options.columns[l].type?e.preventDefault():jexcel.current.openEditor(jexcel.current.records[r][l],!0):113==e.keyCode?jexcel.current.openEditor(jexcel.current.records[r][l],!1):(8==e.keyCode||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||e.keyCode>=187&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[r][l],!0),"calendar"==jexcel.current.options.columns[l].type&&e.preventDefault()))}}else 65==e.which?(jexcel.current.selectAll(),e.preventDefault()):83==e.which?(jexcel.current.download(),e.preventDefault()):89==e.which?(jexcel.current.redo(),e.preventDefault()):90==e.which?(jexcel.current.undo(),e.preventDefault()):67==e.which||67==e.which?(jexcel.current.copy(!0),e.preventDefault()):88==e.which?(1==jexcel.current.options.editable?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):86==e.which&&jexcel.pasteControls();else e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout((function(){jexcel.current.search(e.target.value)}),200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;var o=jexcel.getElement(e.target);if(o[0]?jexcel.current!=o[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=o[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&1==t){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))1==jexcel.current.options.editable&&(jexcel.current.selectedCorner=!0);else{if(1==o[1]){if(x=e.target.getAttribute("data-x")){var n=e.target.getBoundingClientRect();if(1==jexcel.current.options.columnResize&&n.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:x,width:n.width},jexcel.current.headers[x].classList.add("resizing");for(var r=0;r<jexcel.current.records.length;r++)jexcel.current.records[r][x]&&jexcel.current.records[r][x].classList.add("resizing")}else if(1==jexcel.current.options.columnDrag&&n.height-e.offsetY<6)if(jexcel.current.isColMerged(x).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:x,destination:x},jexcel.current.headers[x].classList.add("dragging"),r=0;r<jexcel.current.records.length;r++)jexcel.current.records[r][x]&&jexcel.current.records[r][x].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey))var l=jexcel.current.selectedHeader,c=x;else jexcel.current.selectedHeader==x&&1==jexcel.current.options.allowRenameColumn&&(jexcel.timeControl=setTimeout((function(){jexcel.current.setHeader(x)}),800)),jexcel.current.selectedHeader=x,l=x,c=x;jexcel.current.updateSelectionFromCoords(l,0,c,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column"))var d=e.target.getAttribute("data-column").split(","),f=parseInt(d[0]),h=parseInt(d[d.length-1]);else f=0,h=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(f,0,h,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(2==o[1]){var m=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row"))n=e.target.getBoundingClientRect(),1==jexcel.current.options.rowResize&&n.height-e.offsetY<6?(jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:m,height:n.height},e.target.parentNode.classList.add("resizing")):1==jexcel.current.options.rowDrag&&n.width-e.offsetX<6?jexcel.current.isRowMerged(m).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==jexcel.current.options.search&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:m,destination:m},e.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey)?(l=jexcel.current.selectedRow,c=m):(jexcel.current.selectedRow=m,l=m,c=m),jexcel.current.updateSelectionFromCoords(0,l,jexcel.current.options.data[0].length-1,c));else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var j=function(element){var e=element.getAttribute("data-x"),t=element.getAttribute("data-y");return e&&t?[e,t]:element.parentNode?j(element.parentNode):void 0},v=j(e.target);if(v){var x=v[0];m=v[1],jexcel.current.edition&&(jexcel.current.edition[2]==x&&jexcel.current.edition[3]==m||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],x,m):jexcel.current.updateSelectionFromCoords(x,m)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&("<"==e.target.innerText?jexcel.current.page(0):">"==e.target.innerText?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.innerText-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var t=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),o=jexcel.current.getSelectedColumns();if(o.length>1){for(var n=[],i=0;i<o.length;i++)n.push(parseInt(jexcel.current.colgroup[o[i]].getAttribute("width")));n[o.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(o,t,n)}else jexcel.current.setWidth(jexcel.current.resizing.column,t,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var r=0;r<jexcel.current.records.length;r++)jexcel.current.records[r][jexcel.current.resizing.column]&&jexcel.current.records[r][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var l=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,l,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var c=e.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),r=0;r<jexcel.current.rows.length;r++)jexcel.current.records[r][jexcel.current.dragging.column]&&jexcel.current.records[r][jexcel.current.dragging.column].classList.remove("dragging");for(i=0;i<jexcel.current.headers.length;i++)jexcel.current.headers[i].classList.remove("dragging-left"),jexcel.current.headers[i].classList.remove("dragging-right");c&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var d=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<d&&(d-=1)}else d=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,d,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current)if(1==jexcel.isMouseAction){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var o=e.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+o>0){var n=jexcel.current.resizing.width+o;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",n),jexcel.current.updateCornerPosition()}}else{var r=e.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+r>0){var l=jexcel.current.resizing.height+r;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",l),jexcel.current.updateCornerPosition()}}}else{var c=e.target.getAttribute("data-x"),d=e.target.getAttribute("data-y"),rect=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&c&&!d&&rect.width-(e.clientX-rect.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!c&&d&&rect.height-(e.clientY-rect.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!c&&d&&rect.width-(e.clientX-rect.left)<6||e.target&&c&&!d&&rect.height-(e.clientY-rect.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current&&1==jexcel.isMouseAction){var o=jexcel.getElement(e.target);if(o[0]){if(jexcel.current!=o[0].jexcel&&jexcel.current)return!1;var n=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");if(jexcel.current.dragging){if(jexcel.current.dragging.column){if(n)if(jexcel.current.isColMerged(n).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var i=0;i<jexcel.current.headers.length;i++)jexcel.current.headers[i].classList.remove("dragging-left"),jexcel.current.headers[i].classList.remove("dragging-right");jexcel.current.dragging.column==n?jexcel.current.dragging.destination=parseInt(n):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<n?jexcel.current.dragging.destination=parseInt(n)-1:jexcel.current.dragging.destination=parseInt(n),jexcel.current.headers[n].classList.add("dragging-left")):(jexcel.current.dragging.column<n?jexcel.current.dragging.destination=parseInt(n):jexcel.current.dragging.destination=parseInt(n)+1,jexcel.current.headers[n].classList.add("dragging-right"))}}else if(r)if(jexcel.current.isRowMerged(r).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var l=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;jexcel.current.dragging.element!=l&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,l),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}else if(jexcel.current.resizing);else{if(1==o[1]&&jexcel.current.selectedHeader){n=e.target.getAttribute("data-x");var c=jexcel.current.selectedHeader,d=n;jexcel.current.updateSelectionFromCoords(c,0,d,jexcel.current.options.data.length-1)}2==o[1]&&(e.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(c=jexcel.current.selectedRow,d=r,jexcel.current.updateSelectionFromCoords(0,c,jexcel.current.options.data[0].length-1,d)):jexcel.current.edition||n&&r&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(n,r):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n,r)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var t=jexcel.current.highlighted[0].getAttribute("data-x"),o=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,n=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),r=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[o][t],jexcel.current.records[r][n])}}else if(e.target.classList.contains("jexcel_column_filter")){var l=e.target.getAttribute("data-x");jexcel.current.openFilter(l)}else{var c=jexcel.getElement(e.target);if(1==c[1]&&1==jexcel.current.options.columnSorting&&(l=e.target.getAttribute("data-x"))&&jexcel.current.orderBy(l),2==c[1]&&1==jexcel.current.options.editable&&!jexcel.current.edition){var d=function(element){if(element.parentNode){var e=element.getAttribute("data-x"),t=element.getAttribute("data-y");return e&&t?element:d(element.parentNode)}},f=d(e.target);f&&f.classList.contains("highlight")&&jexcel.current.openEditor(f)}}},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),1==jexcel.current.options.editable&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||1==jexcel.current.options.editable&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){if("buttons"in(e=e||window.event)?e.buttons:e.which||e.button,jexcel.current)if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var t=e.target.getAttribute("data-x"),o=e.target.getAttribute("data-y");if(t||o){(t<parseInt(jexcel.current.selectedCell[0])||t>parseInt(jexcel.current.selectedCell[2])||o<parseInt(jexcel.current.selectedCell[1])||o>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(t,o,t,o);var n=jexcel.current.options.contextMenu(jexcel.current,t,o,e);jexcel.current.contextMenu.contextmenu.open(e,n),e.preventDefault()}}},jexcel.touchStartControls=function(e){var t=jexcel.getElement(e.target);if(t[0]?jexcel.current!=t[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=t[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var o=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y");o&&n&&(jexcel.current.updateSelectionFromCoords(o,n),jexcel.timeControl=setTimeout((function(){"color"==jexcel.current.options.columns[o].type?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)}),500))}},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&"INPUT"==jexcel.tmpElement.children[0].tagName&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,t){var o=[];if(e.classList.contains("jexcel_tabs"))n=e.children[0],content=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var div=document.createElement("div"),n=e.appendChild(div),content=(div=document.createElement("div"),e.appendChild(div))}for(var r=[],link=[],i=0;i<t.length;i++){r[i]=document.createElement("div"),r[i].classList.add("jexcel_tab");var l=jexcel(r[i],t[i]);content.appendChild(r[i]),o[i]=e.jexcel.push(l),link[i]=document.createElement("div"),link[i].classList.add("jexcel_tab_link"),link[i].setAttribute("data-spreadsheet",e.jexcel.length-1),link[i].innerHTML=t[i].sheetName,link[i].onclick=function(){for(var e=0;e<n.children.length;e++)n.children[e].classList.remove("selected"),content.children[e].style.display="none";var i=this.getAttribute("data-spreadsheet");content.children[i].style.display="block",n.children[i].classList.add("selected")},n.appendChild(link[i])}for(var c=0;c<n.children.length;c++)n.children[c].classList.remove("selected"),content.children[c].style.display="none";return n.children[n.children.length-1].classList.add("selected"),content.children[n.children.length-1].style.display="block",o},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,t){var o,n=function(e){var t=[];return e.SheetNames.forEach((function(o){var n={rows:[],columns:[],data:[],style:{}};if(n.sheetName=o,(j=e.Sheets[o]["!cols"])&&j.length)for(var i=0;i<j.length;i++)n.columns[i]={},j[i]&&j[i].wpx&&(n.columns[i].width=j[i].wpx+"px");if((j=e.Sheets[o]["!rows"])&&j.length)for(i=0;i<j.length;i++)j[i]&&j[i].hpx&&(n.rows[i]={},n.rows[i].height=j[i].hpx+"px");if((j=e.Sheets[o]["!merges"])&&j.length>0)for(n.mergeCells=[],i=0;i<j.length;i++){var r=j[i].s.c,l=j[i].s.r,c=j[i].e.c,d=j[i].e.r,f=jexcel.getColumnNameFromId([r,l]);n.mergeCells[f]=[c-r+1,d-l+1]}var h=0,m=0,j=Object.keys(e.Sheets[o]);for(i=0;i<j.length;i++)if("!"!=j[i].substr(0,1)){var v=e.Sheets[o][j[i]],x=jexcel.getIdFromColumnName(j[i],!0);n.data[x[1]]||(n.data[x[1]]=[]),n.data[x[1]][x[0]]=v.f?"="+v.f:v.w,h<x[0]&&(h=x[0]),m<x[1]&&(m=x[1]),v.style&&Object.keys(v.style).length>0&&(n.style[j[i]]=v.style),v.s&&v.s.fgColor&&(n.style[j[i]]&&(n.style[j[i]]+=";"),n.style[j[i]]+="background-color:#"+v.s.fgColor.rgb)}for(var w=n.columns,y=0;y<=m;y++)for(i=0;i<=h;i++)n.data[y]||(n.data[y]=[]),n.data[y][i]||w<i&&(n.data[y][i]="");t.push(n)})),t};(o=new XMLHttpRequest).open("GET",e,!0),"undefined"!=typeof Uint8Array?(o.responseType="arraybuffer",o.onload=function(e){var r=o.response,data=new Uint8Array(r),l=XLSX.read(data,{type:"array",cellFormula:!0,cellStyles:!0});t(n(l))}):(o.setRequestHeader("Accept-Charset","x-user-defined"),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var e=convertResponseBodyToText(o.responseBody),r=XLSX.read(e,{type:"binary",cellFormula:!0,cellStyles:!0});t(n(r))}}),o.send()},jexcel.validLetter=function(text){return text.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(e,t,o){return e.slice(0,t).concat(o).concat(e.slice(t))},jexcel.getColumnName=function(i){var e="";return i>701?(e+=String.fromCharCode(64+parseInt(i/676)),e+=String.fromCharCode(64+parseInt(i%676/26))):i>25&&(e+=String.fromCharCode(64+parseInt(i/26))),e+=String.fromCharCode(65+i%26)},jexcel.getIdFromColumnName=function(e,t){var o=/^[a-zA-Z]+/.exec(e);if(o){for(var code=0,i=0;i<o[0].length;i++)code+=parseInt(o[0].charCodeAt(i)-64)*Math.pow(26,o[0].length-1-i);--code<0&&(code=0);var n=parseInt(/[0-9]+$/.exec(e));n>0&&n--,e=1==t?[code,n]:code+"-"+n}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(element){var e=0,t=0;return function path(element){element.className&&element.classList.contains("jexcel_container")&&(t=element),"THEAD"==element.tagName?e=1:"TBODY"==element.tagName&&(e=2),element.parentNode&&(t||path(element.parentNode))}(element),[t,e]},jexcel.doubleDigitFormat=function(e){return 1==(e=""+e).length&&(e="0"+e),e},jexcel.createFromTable=function(e,t){if("TABLE"==e.tagName){t||(t={}),t.columns=[],t.data=[];var colgroup=e.querySelectorAll("colgroup > col");if(colgroup.length)for(var i=0;i<colgroup.length;i++){if(!(o=colgroup[i].style.width))var o=colgroup[i].getAttribute("width");o&&(t.columns[i]||(t.columns[i]={}),t.columns[i].width=o)}var n=function(header){var e=header.getBoundingClientRect(),o=e.width>50?e.width:50;t.columns[i]||(t.columns[i]={}),header.getAttribute("data-celltype")?t.columns[i].type=header.getAttribute("data-celltype"):t.columns[i].type="text",t.columns[i].width=o+"px",t.columns[i].title=header.innerHTML,t.columns[i].align=header.style.textAlign||"center"},r=e.querySelectorAll("thead > tr");if(r.length)for(r=r[r.length-1].children,i=0;i<r.length;i++)n(r[i]);for(var l=0,c={},d={},style={},f={},content=e.querySelectorAll("table > tr, tbody tr"),h=0;h<content.length;h++)if(t.data[l]=[],1!=t.parseTableFirstRowAsHeader||r.length||0!=h){for(i=0;i<content[h].children.length;i++){if(m=content[h].children[i].getAttribute("data-formula"))"="!=m.substr(0,1)&&(m="="+m);else var m=content[h].children[i].innerHTML;t.data[l].push(m);var j=jexcel.getColumnNameFromId([i,h]),v=content[h].children[i].getAttribute("class");v&&(f[j]=v);var x=parseInt(content[h].children[i].getAttribute("colspan"))||0,w=parseInt(content[h].children[i].getAttribute("rowspan"))||0;(x||w)&&(c[j]=[x||1,w||1]),content[h].children[i].style&&"none"==content[h].children[i].style.display&&(content[h].children[i].style.display="");var s=content[h].children[i].getAttribute("style");s&&(style[j]=s),content[h].children[i].classList.contains("styleBold")&&(style[j]?style[j]+="; font-weight:bold;":style[j]="font-weight:bold;")}content[h].style&&content[h].style.height&&(d[h]={height:content[h].style.height}),l++}else for(var i=0;i<content[h].children.length;i++)n(content[h].children[i]);if(Object.keys(style).length,Object.keys(c).length>0&&(t.mergeCells=c),Object.keys(d).length>0&&(t.rows=d),Object.keys(f).length>0&&(t.classes=f),1==t.parseTableAutoCellType){var pattern=[];for(i=0;i<t.columns.length;i++){var y=!0,C=!0;for(pattern[i]=[],h=0;h<t.data.length;h++)m=t.data[h][i],pattern[i][m]||(pattern[i][m]=0),pattern[i][m]++,m.length>25&&(y=!1),10==m.length&&"-"==m.substr(4,1)&&"-"==m.substr(7,1)||(C=!1);var E=Object.keys(pattern[i]).length;C?t.columns[i].type="calendar":1==y&&E>1&&E<=parseInt(.1*t.data.length)&&(t.columns[i].type="dropdown",t.columns[i].source=Object.keys(pattern[i]))}}return t}console.log("Element is not a table")},void 0!==jQuery&&function(e){e.fn.jexcel=function(t){var o=e(this).get(0);return o.jexcel?o.jexcel[t].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(e(this).get(0),arguments[0])}}(jQuery);var error=function(){var e={};return e.nil=new Error("#NULL!"),e.div0=new Error("#DIV/0!"),e.value=new Error("#VALUE!"),e.ref=new Error("#REF!"),e.name=new Error("#NAME?"),e.num=new Error("#NUM!"),e.na=new Error("#N/A"),e.error=new Error("#ERROR!"),e.data=new Error("#GETTING_DATA"),e}(),utils=function(){var e={flattenShallow:function(e){return e&&e.reduce?e.reduce((function(a,b){var e=Array.isArray(a),t=Array.isArray(b);return e&&t?a.concat(b):e?(a.push(b),a):t?[a].concat(b):[a,b]})):e},isFlat:function(e){if(!e)return!1;for(var i=0;i<e.length;++i)if(Array.isArray(e[i]))return!1;return!0},flatten:function(){for(var t=e.argsToArray.apply(null,arguments);!e.isFlat(t);)t=e.flattenShallow(t);return t},argsToArray:function(t){var o=[];return e.arrayEach(t,(function(e){o.push(e)})),o},numbers:function(){var e=this.flatten.apply(null,arguments);return e.filter((function(e){return"number"==typeof e}))},cleanFloat:function(e){var t=1e14;return Math.round(e*t)/t},parseBool:function(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||error.value},parseNumber:function(e){return void 0===e||""===e||isNaN(e)?error.value:parseFloat(e)},parseNumberArray:function(t){var o,n;if(!t||0===(o=t.length))return error.value;for(;o--;){if((n=e.parseNumber(t[o]))===error.value)return n;t[o]=n}return t},parseMatrix:function(t){var o;if(!t||0===t.length)return error.value;for(var i=0;i<t.length;i++)if(o=e.parseNumberArray(t[i]),t[i]=o,o instanceof Error)return o;return t}},t=new Date(Date.UTC(1900,0,1));return e.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);var o=parseInt(e,10);return o<0?error.num:o<=60?new Date(t.getTime()+864e5*(o-1)):new Date(t.getTime()+864e5*(o-2))}return"string"!=typeof e||(e=new Date(e),isNaN(e))?error.value:e},e.parseDateArray=function(e){for(var t,o=e.length;o--;){if((t=this.parseDate(e[o]))===error.value)return t;e[o]=t}return e},e.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(e){for(var t,o=e.length;o--;)if("number"!=typeof(t=e[o]))if(!0!==t)if(!1!==t){if("string"==typeof t){var n=this.parseNumber(t);n instanceof Error?e[o]=0:e[o]=n}}else e[o]=0;else e[o]=1;return e},e.rest=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e},e.initial=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(0,e.length-t):e},e.arrayEach=function(e,t){for(var o=-1,n=e.length;++o<n&&!1!==t(e[o],o,e););return e},e.transpose=function(e){return e?e[0].map((function(col,i){return e.map((function(e){return e[i]}))})):error.value},e}();jexcel.methods={},jexcel.methods.datetime=function(){var e={},t=new Date(1900,0,1),o=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];function n(e){return(e-t)/864e5+(e>-22038912e5?2:1)}return e.DATE=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:e<0||t<0||o<0?error.num:new Date(e,t-1,o)},e.DATEVALUE=function(e){if("string"!=typeof e)return error.value;var o=Date.parse(e);return isNaN(o)?error.value:o<=-22038912e5?(o-t)/864e5+1:(o-t)/864e5+2},e.DAY=function(e){var t=utils.parseDate(e);return t instanceof Error?t:t.getDate()},e.DAYS=function(e,t){return e=utils.parseDate(e),t=utils.parseDate(t),e instanceof Error?e:t instanceof Error?t:n(e)-n(t)},e.DAYS360=function(e,t,o){},e.EDATE=function(e,t){return(e=utils.parseDate(e))instanceof Error?e:isNaN(t)?error.value:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),n(e))},e.EOMONTH=function(e,t){return(e=utils.parseDate(e))instanceof Error?e:isNaN(t)?error.value:(t=parseInt(t,10),n(new Date(e.getFullYear(),e.getMonth()+t+1,0)))},e.HOUR=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getHours()},e.INTERVAL=function(e){if("number"!=typeof e&&"string"!=typeof e)return error.value;e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var o=Math.floor(e/2592e3);e%=2592e3;var n=Math.floor(e/86400);e%=86400;var r=Math.floor(e/3600);e%=3600;var l=Math.floor(e/60),c=e%=60;return"P"+(t=t>0?t+"Y":"")+(o=o>0?o+"M":"")+(n=n>0?n+"D":"")+"T"+(r=r>0?r+"H":"")+(l=l>0?l+"M":"")+(c=c>0?c+"S":"")},e.ISOWEEKNUM=function(e){if((e=utils.parseDate(e))instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)},e.MINUTE=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getMinutes()},e.MONTH=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getMonth()+1},e.NETWORKDAYS=function(e,t,o){},e.NETWORKDAYS.INTL=function(e,t,o,n){},e.NOW=function(){return new Date},e.SECOND=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getSeconds()},e.TIME=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:e<0||t<0||o<0?error.num:(3600*e+60*t+o)/86400},e.TIMEVALUE=function(e){return(e=utils.parseDate(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},e.TODAY=function(){return new Date},e.WEEKDAY=function(e,t){if((e=utils.parseDate(e))instanceof Error)return e;void 0===t&&(t=1);var n=e.getDay();return o[t][n]},e.WEEKNUM=function(e,t){},e.WORKDAY=function(e,t,o){},e.WORKDAY.INTL=function(e,t,o,n){},e.YEAR=function(e){return(e=utils.parseDate(e))instanceof Error?e:e.getFullYear()},e.YEARFRAC=function(e,t,o){},e}(),jexcel.methods.database=function(){var exports={};function compact(e){if(!e)return e;for(var t=[],i=0;i<e.length;++i)e[i]&&t.push(e[i]);return t}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}return exports.FINDFIELD=function(e,title){for(var t=null,i=0;i<e.length;i++)if(e[i][0]===title){t=i;break}return null==t?error.value:t},exports.DAVERAGE=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=findResultIndex(e,o),r=[];if("string"==typeof t){var l=exports.FINDFIELD(e,t);r=utils.rest(e[l])}else r=utils.rest(e[t]);for(var c=0,i=0;i<n.length;i++)c+=r[n[i]];return 0===n.length?error.div0:c/n.length},exports.DCOUNT=function(e,t,o){},exports.DCOUNTA=function(e,t,o){},exports.DGET=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=findResultIndex(e,o),r=[];if("string"==typeof t){var l=exports.FINDFIELD(e,t);r=utils.rest(e[l])}else r=utils.rest(e[t]);return 0===n.length?error.value:n.length>1?error.num:r[n[0]]},exports.DMAX=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=findResultIndex(e,o),r=[];if("string"==typeof t){var l=exports.FINDFIELD(e,t);r=utils.rest(e[l])}else r=utils.rest(e[t]);for(var c=r[n[0]],i=1;i<n.length;i++)c<r[n[i]]&&(c=r[n[i]]);return c},exports.DMIN=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=findResultIndex(e,o),r=[];if("string"==typeof t){var l=exports.FINDFIELD(e,t);r=utils.rest(e[l])}else r=utils.rest(e[t]);for(var c=r[n[0]],i=1;i<n.length;i++)c>r[n[i]]&&(c=r[n[i]]);return c},exports.DPRODUCT=function(e,t,o){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=findResultIndex(e,o),r=[];if("string"==typeof t){var l=exports.FINDFIELD(e,t);r=utils.rest(e[l])}else r=utils.rest(e[t]);for(var c=[],i=0;i<n.length;i++)c[i]=r[n[i]];c=compact(c);var d=1;for(i=0;i<c.length;i++)d*=c[i];return d},exports.DSTDEV=function(e,t,o){},exports.DSTDEVP=function(e,t,o){},exports.DSUM=function(e,t,o){},exports.DVAR=function(e,t,o){},exports.DVARP=function(e,t,o){},exports.MATCH=function(e,t,o){if(!e&&!t)return error.na;if(2===arguments.length&&(o=1),!(t instanceof Array))return error.na;if(-1!==o&&0!==o&&1!==o)return error.na;for(var n,r,l=0;l<t.length;l++)if(1===o){if(t[l]===e)return l+1;t[l]<e&&(r?t[l]>r&&(n=l+1,r=t[l]):(n=l+1,r=t[l]))}else if(0===o){if("string"==typeof e){if(e=e.replace(/\?/g,"."),t[l].toLowerCase().match(e.toLowerCase()))return l+1}else if(t[l]===e)return l+1}else if(-1===o){if(t[l]===e)return l+1;t[l]>e&&(r?t[l]<r&&(n=l+1,r=t[l]):(n=l+1,r=t[l]))}return n||error.na},exports}(),jexcel.methods.engineering=function(){var e={};function t(e){return/^[01]{1,10}$/.test(e)}return e.BESSELI=function(e,t){},e.BESSELJ=function(e,t){},e.BESSELK=function(e,t){},e.BESSELY=function(e,t){},e.BIN2DEC=function(e){if(!t(e))return error.num;var o=parseInt(e,2),n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:o},e.BIN2HEX=function(e,o){if(!t(e))return error.num;var n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var r=parseInt(e,2).toString(16);return void 0===o?r:isNaN(o)?error.value:o<0?error.num:(o=Math.floor(o))>=r.length?REPT("0",o-r.length)+r:error.num},e.BIN2OCT=function(e,o){if(!t(e))return error.num;var n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var r=parseInt(e,2).toString(8);return void 0===o?r:isNaN(o)?error.value:o<0?error.num:(o=Math.floor(o))>=r.length?REPT("0",o-r.length)+r:error.num},e.BITAND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?error.num:e&t},e.BITLSHIFT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?error.num:t>=0?e<<t:e>>-t},e.BITOR=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?error.num:e|t},e.BITRSHIFT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?error.num:t>=0?e>>t:e<<-t},e.BITXOR=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?error.num:e^t},e.COMPLEX=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return e;if("i"!==(o=void 0===o?"i":o)&&"j"!==o)return error.value;if(0===e&&0===t)return 0;if(0===e)return 1===t?o:t.toString()+o;if(0===t)return e.toString();var n=t>0?"+":"";return e.toString()+n+(1===t?o:t.toString()+o)},e.CONVERT=function(e,t,o){if((e=utils.parseNumber(e))instanceof Error)return e;for(var n,r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],l={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},c={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},d=null,f=null,h=t,m=o,j=1,v=1,i=0;i<r.length;i++)n=null===r[i][2]?[]:r[i][2],(r[i][1]===h||n.indexOf(h)>=0)&&(d=r[i]),(r[i][1]===m||n.indexOf(m)>=0)&&(f=r[i]);if(null===d){var x=l[t.substring(0,2)],w=c[t.substring(0,1)];"da"===t.substring(0,2)&&(w=["dekao",10,"da"]),x?(j=x[2],h=t.substring(2)):w&&(j=w[1],h=t.substring(w[2].length));for(var y=0;y<r.length;y++)n=null===r[y][2]?[]:r[y][2],(r[y][1]===h||n.indexOf(h)>=0)&&(d=r[y])}if(null===f){var C=l[o.substring(0,2)],E=c[o.substring(0,1)];"da"===o.substring(0,2)&&(E=["dekao",10,"da"]),C?(v=C[2],m=o.substring(2)):E&&(v=E[1],m=o.substring(E[2].length));for(var A=0;A<r.length;A++)n=null===r[A][2]?[]:r[A][2],(r[A][1]===m||n.indexOf(m)>=0)&&(f=r[A])}return null===d||null===f||d[3]!==f[3]?error.na:e*d[6]*j/(f[6]*v)},e.DEC2BIN=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return error.num;if(e<0)return"1"+REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var o=parseInt(e,10).toString(2);return void 0===t?o:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=o.length?REPT("0",t-o.length)+o:error.num},e.DEC2HEX=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return error.num;if(e<0)return(1099511627776+e).toString(16);var o=parseInt(e,10).toString(16);return void 0===t?o:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=o.length?REPT("0",t-o.length)+o:error.num},e.DEC2OCT=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return error.num;if(e<0)return(1073741824+e).toString(8);var o=parseInt(e,10).toString(8);return void 0===t?o:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=o.length?REPT("0",t-o.length)+o:error.num},e.DELTA=function(e,t){return t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e===t?1:0},e.ERF=function(e,t){},e.ERF.PRECISE=function(){},e.ERFC=function(e){},e.ERFC.PRECISE=function(){},e.GESTEP=function(e,t){return t=t||0,e=utils.parseNumber(e),utils.anyIsError(t,e)?e:e>=t?1:0},e.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var o=10===e.length&&"f"===e.substring(0,1).toLowerCase(),n=o?parseInt(e,16)-1099511627776:parseInt(e,16);if(n<-512||n>511)return error.num;if(o)return"1"+REPT("0",9-(512+n).toString(2).length)+(512+n).toString(2);var r=n.toString(2);return void 0===t?r:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=r.length?REPT("0",t-r.length)+r:error.num},e.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},e.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var o=parseInt(e,16);if(o>536870911&&o<0xffe0000000)return error.num;if(o>=0xffe0000000)return(o-0xffc0000000).toString(8);var n=o.toString(8);return void 0===t?n:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:error.num},e.IMABS=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:Math.sqrt(Math.pow(o,2)+Math.pow(n,2))},e.IMAGINARY=function(e){if(void 0===e||!0===e||!1===e)return error.value;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),o=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===o&&(o=e.indexOf("-",1));var n=e.substring(e.length-1,e.length),r="i"===n||"j"===n;return t>=0||o>=0?r?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?error.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?error.num:-Number(e.substring(o+1,e.length-1)):error.num:r?isNaN(e.substring(0,e.length-1))?error.num:e.substring(0,e.length-1):isNaN(e)?error.num:0},e.IMARGUMENT=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:0===o&&0===n?error.div0:0===o&&n>0?Math.PI/2:0===o&&n<0?-Math.PI/2:0===n&&o>0?0:0===n&&o<0?-Math.PI:o>0?Math.atan(n/o):o<0&&n>=0?Math.atan(n/o)+Math.PI:Math.atan(n/o)-Math.PI},e.IMCONJUGATE=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",0!==n?e.COMPLEX(o,-n,r):t},e.IMCOS=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",e.COMPLEX(Math.cos(o)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(o)*(Math.exp(n)-Math.exp(-n))/2,r)},e.IMCOSH=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",e.COMPLEX(Math.cos(n)*(Math.exp(o)+Math.exp(-o))/2,Math.sin(n)*(Math.exp(o)-Math.exp(-o))/2,r)},e.IMCOT=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:e.IMDIV(e.IMCOS(t),e.IMSIN(t))},e.IMDIV=function(t,o){var a=e.IMREAL(t),b=e.IMAGINARY(t),n=e.IMREAL(o),r=e.IMAGINARY(o);if(utils.anyIsError(a,b,n,r))return error.value;var l=t.substring(t.length-1),c=o.substring(o.length-1),d="i";if(("j"===l||"j"===c)&&(d="j"),0===n&&0===r)return error.num;var f=n*n+r*r;return e.COMPLEX((a*n+b*r)/f,(b*n-a*r)/f,d)},e.IMEXP=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var r=t.substring(t.length-1);r="i"===r||"j"===r?r:"i";var l=Math.exp(o);return e.COMPLEX(l*Math.cos(n),l*Math.sin(n),r)},e.IMLN=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",e.COMPLEX(Math.log(Math.sqrt(o*o+n*n)),Math.atan(n/o),r)},e.IMLOG10=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",e.COMPLEX(Math.log(Math.sqrt(o*o+n*n))/Math.log(10),Math.atan(n/o)/Math.log(10),r)},e.IMLOG2=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",e.COMPLEX(Math.log(Math.sqrt(o*o+n*n))/Math.log(2),Math.atan(n/o)/Math.log(2),r)},e.IMPOWER=function(t,o){o=utils.parseNumber(o);var n=e.IMREAL(t),r=e.IMAGINARY(t);if(utils.anyIsError(o,n,r))return error.value;var l=t.substring(t.length-1);l="i"===l||"j"===l?l:"i";var p=Math.pow(e.IMABS(t),o),c=e.IMARGUMENT(t);return e.COMPLEX(p*Math.cos(o*c),p*Math.sin(o*c),l)},e.IMPRODUCT=function(){for(var t=arguments[0],i=1;i<arguments.length;i++){var a=e.IMREAL(t),b=e.IMAGINARY(t),o=e.IMREAL(arguments[i]),n=e.IMAGINARY(arguments[i]);if(utils.anyIsError(a,b,o,n))return error.value;t=e.COMPLEX(a*o-b*n,a*n+b*o)}return t},e.IMREAL=function(e){if(void 0===e||!0===e||!1===e)return error.value;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var t=e.indexOf("+"),o=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===o&&(o=e.indexOf("-",1));var n=e.substring(e.length-1,e.length),r="i"===n||"j"===n;return t>=0||o>=0?r?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?error.num:Number(e.substring(0,t)):isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?error.num:Number(e.substring(0,o)):error.num:r?isNaN(e.substring(0,e.length-1))?error.num:0:isNaN(e)?error.num:e},e.IMSEC=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:e.IMDIV("1",e.IMCOS(t))},e.IMSECH=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:e.IMDIV("1",e.IMCOSH(t))},e.IMSIN=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",e.COMPLEX(Math.sin(o)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(o)*(Math.exp(n)-Math.exp(-n))/2,r)},e.IMSINH=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i",e.COMPLEX(Math.cos(n)*(Math.exp(o)-Math.exp(-o))/2,Math.sin(n)*(Math.exp(o)+Math.exp(-o))/2,r)},e.IMSQRT=function(t){var o=e.IMREAL(t),n=e.IMAGINARY(t);if(utils.anyIsError(o,n))return error.value;var r=t.substring(t.length-1);r="i"===r||"j"===r?r:"i";var s=Math.sqrt(e.IMABS(t)),l=e.IMARGUMENT(t);return e.COMPLEX(s*Math.cos(l/2),s*Math.sin(l/2),r)},e.IMCSC=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.num:e.IMDIV("1",e.IMSIN(t))},e.IMCSCH=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.num:e.IMDIV("1",e.IMSINH(t))},e.IMSUB=function(e,t){var a=this.IMREAL(e),b=this.IMAGINARY(e),o=this.IMREAL(t),n=this.IMAGINARY(t);if(utils.anyIsError(a,b,o,n))return error.value;var r=e.substring(e.length-1),l=t.substring(t.length-1),c="i";return("j"===r||"j"===l)&&(c="j"),this.COMPLEX(a-o,b-n,c)},e.IMSUM=function(){for(var e=utils.flatten(arguments),t=e[0],i=1;i<e.length;i++){var a=this.IMREAL(t),b=this.IMAGINARY(t),o=this.IMREAL(e[i]),n=this.IMAGINARY(e[i]);if(utils.anyIsError(a,b,o,n))return error.value;t=this.COMPLEX(a+o,b+n)}return t},e.IMTAN=function(t){if(!0===t||!1===t)return error.value;var o=e.IMREAL(t),n=e.IMAGINARY(t);return utils.anyIsError(o,n)?error.value:this.IMDIV(this.IMSIN(t),this.IMCOS(t))},e.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return error.num;var o=10===e.length&&"7"===e.substring(0,1),n=o?parseInt(e,8)-1073741824:parseInt(e,8);if(n<-512||n>511)return error.num;if(o)return"1"+REPT("0",9-(512+n).toString(2).length)+(512+n).toString(2);var r=n.toString(2);return void 0===t?r:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=r.length?REPT("0",t-r.length)+r:error.num},e.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return error.num;var t=parseInt(e,8);return t>=536870912?t-1073741824:t},e.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return error.num;var o=parseInt(e,8);if(o>=536870912)return"ff"+(o+3221225472).toString(16);var n=o.toString(16);return void 0===t?n:isNaN(t)?error.value:t<0?error.num:(t=Math.floor(t))>=n.length?REPT("0",t-n.length)+n:error.num},e}(),jexcel.methods.financial=function(){var e={};function t(e){return e&&e.getTime&&!isNaN(e.getTime())}function o(e){return e instanceof Date?e:new Date(e)}return e.ACCRINT=function(e,n,r,l,c,d,f){return e=o(e),n=o(n),r=o(r),t(e)&&t(n)&&t(r)?l<=0||c<=0||-1===[1,2,4].indexOf(d)||-1===[0,1,2,3,4].indexOf(f)||r<=e?"#NUM!":(f=f||0,(c=c||0)*l*YEARFRAC(e,r,f)):"#VALUE!"},e.ACCRINTM=null,e.AMORDEGRC=null,e.AMORLINC=null,e.COUPDAYBS=null,e.COUPDAYS=null,e.COUPDAYSNC=null,e.COUPNCD=null,e.COUPNUM=null,e.COUPPCD=null,e.CUMIPMT=function(t,o,n,r,l,c){if(t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(t,o,n))return error.value;if(t<=0||o<=0||n<=0)return error.num;if(r<1||l<1||r>l)return error.num;if(0!==c&&1!==c)return error.num;var d=e.PMT(t,o,n,0,c),f=0;1===r&&0===c&&(f=-n,r++);for(var i=r;i<=l;i++)f+=1===c?e.FV(t,i-2,d,n,1)-d:e.FV(t,i-1,d,n,0);return f*=t},e.CUMPRINC=function(t,o,n,r,l,c){if(t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(t,o,n))return error.value;if(t<=0||o<=0||n<=0)return error.num;if(r<1||l<1||r>l)return error.num;if(0!==c&&1!==c)return error.num;var d=e.PMT(t,o,n,0,c),f=0;1===r&&(f=0===c?d+n*t:d,r++);for(var i=r;i<=l;i++)f+=c>0?d-(e.FV(t,i-2,d,n,1)-d)*t:d-e.FV(t,i-1,d,n,0)*t;return f},e.DB=function(e,t,o,n,r){if(r=void 0===r?12:r,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r))return error.value;if(e<0||t<0||o<0||n<0)return error.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(r))return error.num;if(n>o)return error.num;if(t>=e)return 0;for(var l=(1-Math.pow(t/e,1/o)).toFixed(3),c=e*l*r/12,d=c,f=0,h=n===o?o-1:n,i=2;i<=h;i++)d+=f=(e-d)*l;return 1===n?c:n===o?(e-d)*l:f},e.DDB=function(e,t,o,n,r){if(r=void 0===r?2:r,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r))return error.value;if(e<0||t<0||o<0||n<0||r<=0)return error.num;if(n>o)return error.num;if(t>=e)return 0;for(var l=0,c=0,i=1;i<=n;i++)l+=c=Math.min(r/o*(e-l),e-t-l);return c},e.DISC=null,e.DOLLARDE=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(t<0)return error.num;if(t>=0&&t<1)return error.div0;t=parseInt(t,10);var o=parseInt(e,10);o+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var n=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return o=Math.round(o*n)/n},e.DOLLARFR=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(t<0)return error.num;if(t>=0&&t<1)return error.div0;t=parseInt(t,10);var o=parseInt(e,10);return o+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},e.DURATION=null,e.EFFECT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<=0||t<1?error.num:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},e.FV=function(e,t,o,n,r){if(n=n||0,r=r||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r))return error.value;var l;if(0===e)l=n+o*t;else{var c=Math.pow(1+e,t);l=1===r?n*c+o*(1+e)*(c-1)/e:n*c+o*(c-1)/e}return-l},e.FVSCHEDULE=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var o=t.length,n=e,i=0;i<o;i++)n*=1+t[i];return n},e.INTRATE=null,e.IPMT=function(t,o,n,r,l,c){if(l=l||0,c=c||0,t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),l=utils.parseNumber(l),c=utils.parseNumber(c),utils.anyIsError(t,o,n,r,l,c))return error.value;var d=e.PMT(t,n,r,l,c);return(1===o?1===c?0:-r:1===c?e.FV(t,o-2,d,r,1)-d:e.FV(t,o-1,d,r,0))*t},e.IRR=function(e,t){if(t=t||0,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;for(var o=function(e,t,o){for(var n=o+1,r=e[0],i=1;i<e.length;i++)r+=e[i]/Math.pow(n,(t[i]-t[0])/365);return r},n=function(e,t,o){for(var n=o+1,r=0,i=1;i<e.length;i++){var l=(t[i]-t[0])/365;r-=l*e[i]/Math.pow(n,l+1)}return r},r=[],l=!1,c=!1,i=0;i<e.length;i++)r[i]=0===i?0:r[i-1]+365,e[i]>0&&(l=!0),e[i]<0&&(c=!0);if(!l||!c)return error.num;var d,f,h,m=t=void 0===t?.1:t,j=!0;do{d=m-(h=o(e,r,m))/n(e,r,m),f=Math.abs(d-m),m=d,j=f>1e-10&&Math.abs(h)>1e-10}while(j);return m},e.ISPMT=function(e,t,o,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(e,t,o,n)?error.value:n*e*(t/o-1)},e.MDURATION=null,e.MIRR=function(t,o,n){if(t=utils.parseNumberArray(utils.flatten(t)),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(t,o,n))return error.value;for(var r=t.length,l=[],c=[],i=0;i<r;i++)t[i]<0?l.push(t[i]):c.push(t[i]);var d=-e.NPV(n,c)*Math.pow(1+n,r-1),f=e.NPV(o,l)*(1+o);return Math.pow(d/f,1/(r-1))-1},e.NOMINAL=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<=0||t<1?error.num:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},e.NPER=function(e,t,o,n,r){if(r=void 0===r?0:r,n=void 0===n?0:n,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r))return error.value;var l=t*(1+e*r)-n*e,c=o*e+t*(1+e*r);return Math.log(l/c)/Math.log(1+e)},e.NPV=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],o=0,n=1;n<e.length;n++)o+=e[n]/Math.pow(1+t,n);return o},e.ODDFPRICE=null,e.ODDFYIELD=null,e.ODDLPRICE=null,e.ODDLYIELD=null,e.PDURATION=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:e<=0?error.num:(Math.log(o)-Math.log(t))/Math.log(1+e)},e.PMT=function(e,t,o,n,r){if(n=n||0,r=r||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r))return error.value;var l;if(0===e)l=(o+n)/t;else{var c=Math.pow(1+e,t);l=1===r?(n*e/(c-1)+o*e/(1-1/c))/(1+e):n*e/(c-1)+o*e/(1-1/c)}return-l},e.PPMT=function(t,o,n,r,l,c){return l=l||0,c=c||0,t=utils.parseNumber(t),n=utils.parseNumber(n),r=utils.parseNumber(r),l=utils.parseNumber(l),c=utils.parseNumber(c),utils.anyIsError(t,n,r,l,c)?error.value:e.PMT(t,n,r,l,c)-e.IPMT(t,o,n,r,l,c)},e.PRICE=null,e.PRICEDISC=null,e.PRICEMAT=null,e.PV=function(e,t,o,n,r){return n=n||0,r=r||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,o,n,r)?error.value:0===e?-o*t-n:((1-Math.pow(1+e,t))/e*o*(1+e*r)-n)/Math.pow(1+e,t)},e.RATE=function(e,t,o,n,r,l){if(l=void 0===l?.01:l,n=void 0===n?0:n,r=void 0===r?0:r,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),r=utils.parseNumber(r),l=utils.parseNumber(l),utils.anyIsError(e,t,o,n,r,l))return error.value;for(var c=0,d=!1,f=l;c<100&&!d;){var h=Math.pow(f+1,e),m=Math.pow(f+1,e-1),j=f-(n+h*o+t*(h-1)*(f*r+1)/f)/(e*m*o-t*(h-1)*(f*r+1)/Math.pow(f,2)+(e*t*m*(f*r+1)/f+t*(h-1)*r/f));Math.abs(j-f)<1e-6&&(d=!0),c++,f=j}return d?f:Number.NaN+f},e.RECEIVED=null,e.RRI=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===e||0===t?error.num:Math.pow(o/t,1/e)-1},e.SLN=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===o?error.num:(e-t)/o},e.SYD=function(e,t,o,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(e,t,o,n)?error.value:0===o||n<1||n>o?error.num:(e-t)*(o-(n=parseInt(n,10))+1)*2/(o*(o+1))},e.TBILLEQ=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||e>t||t-e>31536e6?error.num:365*o/(360-o*DAYS360(e,t,!1))},e.TBILLPRICE=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||e>t||t-e>31536e6?error.num:100*(1-o*DAYS360(e,t,!1)/360)},e.TBILLYIELD=function(e,t,o){return e=utils.parseDate(e),t=utils.parseDate(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:o<=0||e>t||t-e>31536e6?error.num:360*(100-o)/(o*DAYS360(e,t,!1))},e.VDB=null,e.XIRR=function(e,t,o){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseDateArray(utils.flatten(t)),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;for(var n=function(e,t,o){for(var n=o+1,r=e[0],i=1;i<e.length;i++)r+=e[i]/Math.pow(n,DAYS(t[i],t[0])/365);return r},r=function(e,t,o){for(var n=o+1,r=0,i=1;i<e.length;i++){var l=DAYS(t[i],t[0])/365;r-=l*e[i]/Math.pow(n,l+1)}return r},l=!1,c=!1,i=0;i<e.length;i++)e[i]>0&&(l=!0),e[i]<0&&(c=!0);if(!l||!c)return error.num;var d,f,h,m=o=o||.1,j=!0;do{d=m-(h=n(e,t,m))/r(e,t,m),f=Math.abs(d-m),m=d,j=f>1e-10&&Math.abs(h)>1e-10}while(j);return m},e.XNPV=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),o=utils.parseDateArray(utils.flatten(o)),utils.anyIsError(e,t,o))return error.value;for(var n=0,i=0;i<t.length;i++)n+=t[i]/Math.pow(1+e,DAYS(o[i],o[0])/365);return n},e.YIELD=null,e.YIELDDISC=null,e.YIELDMAT=null,e}(),jexcel.methods.information=function(){var e={CELL:null,ERROR:{}};return e.ERROR.TYPE=function(e){switch(e){case error.nil:return 1;case error.div0:return 2;case error.value:return 3;case error.ref:return 4;case error.name:return 5;case error.num:return 6;case error.na:return 7;case error.data:return 8}return error.na},e.INFO=null,e.ISBLANK=function(e){return null===e},e.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},e.ISERR=function(e){return[error.value,error.ref,error.div0,error.num,error.name,error.nil].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))},e.ISERROR=function(t){return e.ISERR(t)||t===error.na},e.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},e.ISFORMULA=null,e.ISLOGICAL=function(e){return!0===e||!1===e},e.ISNA=function(e){return e===error.na},e.ISNONTEXT=function(e){return"string"!=typeof e},e.ISNUMBER=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},e.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},e.ISREF=null,e.ISTEXT=function(e){return"string"==typeof e},e.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:this.ISERROR(e)?e:0},e.NA=function(){return error.na},e.SHEET=null,e.SHEETS=null,e.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0},e}(),jexcel.methods.logical=function(){var e={AND:function(){for(var e=utils.flatten(arguments),t=!0,i=0;i<e.length;i++)e[i]||(t=!1);return t},CHOOSE:function(){if(arguments.length<2)return error.na;var e=arguments[0];return e<1||e>254||arguments.length<e+1?error.value:arguments[e]},FALSE:function(){return!1},IF:function(e,t,o){return e?t:o},IFERROR:function(e,t){return ISERROR(e)?t:e},IFNA:function(e,t){return e===error.na?t:e},NOT:function(e){return!e},OR:function(){for(var e=utils.flatten(arguments),t=!1,i=0;i<e.length;i++)e[i]&&(t=!0);return t},TRUE:function(){return!0},XOR:function(){for(var e=utils.flatten(arguments),t=0,i=0;i<e.length;i++)e[i]&&t++;return!!(1&Math.floor(Math.abs(t)))},SWITCH:function(){var e;if(arguments.length>0){var t=arguments[0],o=arguments.length-1,n=Math.floor(o/2),r=!1,l=o%2==0?null:arguments[arguments.length-1];if(n)for(var c=0;c<n;c++)if(t===arguments[2*c+1]){e=arguments[2*c+2],r=!0;break}!r&&l&&(e=l)}return e}};return e}(),jexcel.methods.math=function(){var exports={ABS:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.abs(utils.parseNumber(e))},ACOS:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.acos(e)},ACOSH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e-1))},ACOT:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.atan(1/e)},ACOTH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:.5*Math.log((e+1)/(e-1))},AGGREGATE:null,ARABIC:function(text){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text))return error.value;var e=0;return text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(i){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[i]})),e},ASIN:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.asin(e)},ASINH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},ATAN:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.atan(e)},ATAN2:function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.atan2(e,t)},ATANH:function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},BASE:function(e,t,o){if(o=o||0,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;o=void 0===o?0:o;var n=e.toString(t);return new Array(Math.max(o+1-n.length,0)).join("0")+n},CEILING:function(e,t,o){return t=void 0===t?1:t,o=void 0===o?0:o,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===t?0:(t=Math.abs(t),e>=0?Math.ceil(e/t)*t:0===o?-1*Math.floor(Math.abs(e)/t)*t:-1*Math.ceil(Math.abs(e)/t)*t)}};exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:exports.FACT(e)/(exports.FACT(t)*exports.FACT(e-t))},exports.COMBINA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===e&&0===t?1:exports.COMBIN(e+t-1,e-1)},exports.COS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.cos(e)},exports.COSH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},exports.COT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.tan(e)},exports.COTH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t+1)/(t-1)},exports.CSC=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.sin(e)},exports.CSCH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},exports.DECIMAL=function(e,t){return arguments.length<1?error.value:parseInt(e,t)},exports.DEGREES=function(e){return(e=utils.parseNumber(e))instanceof Error?e:180*e/Math.PI},exports.EVEN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:exports.CEILING(e,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];return exports.FACT=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.floor(e);return 0===t||1===t?1:(MEMOIZED_FACT[t]>0||(MEMOIZED_FACT[t]=exports.FACT(t-1)*t),MEMOIZED_FACT[t])},exports.FACTDOUBLE=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.floor(e);return t<=0?1:t*exports.FACTDOUBLE(t-2)},exports.FLOOR=function(e,t,o){return t=void 0===t?1:t,o=void 0===o?0:o,e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:0===t?0:(t=Math.abs(t),e>=0?Math.floor(e/t)*t:0===o?-1*Math.ceil(Math.abs(e)/t)*t:-1*Math.floor(Math.abs(e)/t)*t)},exports.FLOOR.MATH=exports.FLOOR,exports.GCD=null,exports.INT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.floor(e)},exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var i,t,o,n,r=1;void 0!==(o=e.pop());)for(;o>1;){if(o%2){for(i=3,t=Math.floor(Math.sqrt(o));i<=t&&o%i;i+=2);n=i<=t?i:o}else n=2;for(o/=n,r*=n,i=e.length;i;e[--i]%n==0&&1==(e[i]/=n)&&e.splice(i,1));}return r},exports.LN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e)},exports.LOG=function(e,base){return e=utils.parseNumber(e),base=void 0===base?10:utils.parseNumber(base),utils.anyIsError(e,base)?error.value:Math.log(e)/Math.log(base)},exports.LOG10=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e)/Math.log(10)},exports.MDETERM=null,exports.MINVERSE=null,exports.MMULT=null,exports.MOD=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(0===t)return error.div0;var o=Math.abs(e%t);return t>0?o:-o},exports.MROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t<0?error.num:Math.round(e/t)*t},exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,o=1,i=0;i<e.length;i++)t+=e[i],o*=exports.FACT(e[i]);return exports.FACT(t)/o},exports.MUNIT=null,exports.ODD=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>0?t:-t},exports.PI=function(){return Math.PI},exports.POWER=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var o=Math.pow(e,t);return isNaN(o)?error.num:o},exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=1,i=0;i<e.length;i++)t*=e[i];return t},exports.QUOTIENT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:parseInt(e/t,10)},exports.RADIANS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+Math.ceil((t-e+1)*Math.random())-1},exports.ROMAN=null,exports.ROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.round(e*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDDOWN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDUP=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.SEC=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.cos(e)},exports.SECH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},exports.SERIESSUM=function(e,t,o,n){if(e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),n=utils.parseNumberArray(n),utils.anyIsError(e,t,o,n))return error.value;for(var r=n[0]*Math.pow(e,t),i=1;i<n.length;i++)r+=n[i]*Math.pow(e,t+i*o);return r},exports.SIGN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e<0?-1:0===e?0:1},exports.SIN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.sin(e)},exports.SINH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},exports.SQRT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e<0?error.num:Math.sqrt(e)},exports.SQRTPI=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.sqrt(e*Math.PI)},exports.SUBTOTAL=null,exports.ADD=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+t)},exports.MINUS=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e-t)},exports.DIVIDE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===t?error.div0:e/t)},exports.MULTIPLY=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t)},exports.GTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e>=t)},exports.LT=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<t)},exports.LTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<=t)},exports.EQ=function(e,t){return 2!==arguments.length?error.na:e===t},exports.NE=function(e,t){return 2!==arguments.length?error.na:e!==t},exports.POW=function(base,e){return 2!==arguments.length?error.na:(base=utils.parseNumber(base),e=utils.parseNumber(e),utils.anyIsError(base,e)?error.error:exports.POWER(base,e))},exports.SUM=function(){for(var e=0,t=Object.keys(arguments),i=0;i<t.length;++i){var o=arguments[t[i]];if("number"==typeof o)e+=o;else if("string"==typeof o){var n=parseFloat(o);!isNaN(n)&&(e+=n)}else Array.isArray(o)&&(e+=exports.SUM.apply(null,o))}return e},exports.SUMIF=function(range,criteria){if(range=utils.parseNumberArray(utils.flatten(range)),range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=null,exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,o=e.length,i=0;i<o;i++)t+=ISNUMBER(e[i])?e[i]*e[i]:0;return t},exports.SUMX2MY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var o=0,i=0;i<e.length;i++)o+=e[i]*e[i]-t[i]*t[i];return o},exports.SUMX2PY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var o=0;e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t));for(var i=0;i<e.length;i++)o+=e[i]*e[i]+t[i]*t[i];return o},exports.SUMXMY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var o=0;e=utils.flatten(e),t=utils.flatten(t);for(var i=0;i<e.length;i++)o+=Math.pow(e[i]-t[i],2);return o},exports.TAN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.tan(e)},exports.TANH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.TRUNC=function(e,t){return t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports}(),jexcel.methods.misc=function(){var e={UNIQUE:function(){for(var e=[],i=0;i<arguments.length;++i){for(var t=!1,element=arguments[i],o=0;o<e.length&&!(t=e[o]===element);++o);t||e.push(element)}return e}};return e.FLATTEN=utils.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(e,t){try{for(var path=t.split("."),o=e,i=0;i<path.length;++i){var n=path[i];if("]"===n[n.length-1]){var r=n.indexOf("["),l=n.substring(r+1,n.length-1);o=o[n.substring(0,r)][l]}else o=o[n]}return o}catch(e){}},e.JOIN=function(e,t){return e.join(t)},e.NUMBERS=function(){var e=utils.flatten(arguments);return e.filter((function(e){return"number"==typeof e}))},e.NUMERAL=null,e}(),jexcel.methods.text=function(){var e={ASC:null,BAHTTEXT:null,CHAR:function(e){return(e=utils.parseNumber(e))instanceof Error?e:String.fromCharCode(e)},CLEAN:function(text){return(text=text||"").replace(/[\0-\x1F]/g,"")},CODE:function(text){return(text=text||"").charCodeAt(0)},CONCATENATE:function(){for(var e=utils.flatten(arguments),t=0;(t=e.indexOf(!0))>-1;)e[t]="TRUE";for(var o=0;(o=e.indexOf(!1))>-1;)e[o]="FALSE";return e.join("")},DBCS:null,DOLLAR:null,EXACT:function(e,t){return e===t},FIND:function(e,t,o){return o=void 0===o?0:o,t?t.indexOf(e,o-1)+1:null},FIXED:null,HTML2TEXT:function(e){var t="";return e&&(e instanceof Array?e.forEach((function(line){""!==t&&(t+="\n"),t+=line.replace(/<(?:.|\n)*?>/gm,"")})):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},LEFT:function(text,e){return e=void 0===e?1:e,(e=utils.parseNumber(e))instanceof Error||"string"!=typeof text?error.value:text?text.substring(0,e):null},LEN:function(text){return 0===arguments.length?error.error:"string"==typeof text?text?text.length:0:text.length?text.length:error.value},LOWER:function(text){return"string"!=typeof text?error.value:text?text.toLowerCase():text},MID:function(text,e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)||"string"!=typeof text)return t;var o=e-1,n=o+t;return text.substring(o,n)},NUMBERVALUE:null,PRONETIC:null,PROPER:function(text){return void 0===text||0===text.length?error.value:(!0===text&&(text="TRUE"),!1===text&&(text="FALSE"),isNaN(text)&&"number"==typeof text?error.value:("number"==typeof text&&(text=""+text),text.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))))},REGEXEXTRACT:function(text,e){var t=text.match(new RegExp(e));return t?t[t.length>1?t.length-1:0]:null},REGEXMATCH:function(text,e,t){var o=text.match(new RegExp(e));return t?o:!!o},REGEXREPLACE:function(text,e,t){return text.replace(new RegExp(e),t)},REPLACE:function(text,e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)||"string"!=typeof text||"string"!=typeof o?error.value:text.substr(0,e-1)+o+text.substr(e-1+t)},REPT:function(text,e){return(e=utils.parseNumber(e))instanceof Error?e:new Array(e+1).join(text)},RIGHT:function(text,e){return e=void 0===e?1:e,(e=utils.parseNumber(e))instanceof Error?e:text?text.substring(text.length-e):null},SEARCH:function(e,t,o){var n;return"string"!=typeof e||"string"!=typeof t?error.value:(o=void 0===o?0:o,0===(n=t.toLowerCase().indexOf(e.toLowerCase(),o-1)+1)?error.value:n)},SPLIT:function(text,e){return text.split(e)},SUBSTITUTE:function(text,e,t,o){if(!(text&&e&&t))return text;if(void 0===o)return text.replace(new RegExp(e,"g"),t);for(var n=0,i=0;text.indexOf(e,n)>0;)if(n=text.indexOf(e,n+1),++i===o)return text.substring(0,n)+t+text.substring(n+e.length)},T:function(e){return"string"==typeof e?e:""},TEXT:null,TRIM:function(text){return"string"!=typeof text?error.value:text.replace(/ +/g," ").trim()}};return e.UNICHAR=e.CHAR,e.UNICODE=e.CODE,e.UPPER=function(text){return"string"!=typeof text?error.value:text.toUpperCase()},e.VALUE=null,e}(),jexcel.methods.stats=function(){var exports={},SQRT2PI=2.5066282746310002;return exports.AVEDEV=null,exports.AVERAGE=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,n=0,i=0;i<t;i++)o+=e[i],n+=1;return o/n},exports.AVERAGEA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,n=0,i=0;i<t;i++){var r=e[i];"number"==typeof r&&(o+=r),!0===r&&o++,null!==r&&n++}return o/n},exports.AVERAGEIF=function(range,criteria,average_range){if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=null,exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var e=utils.flatten(arguments);return e.length-exports.COUNTBLANK(e)},exports.COUNTIN=function(e,t){for(var o=0,i=0;i<e.length;i++)e[i]===t&&o++;return o},exports.COUNTBLANK=function(){for(var element,e=utils.flatten(arguments),t=0,i=0;i<e.length;i++)null!==(element=e[i])&&""!==element||t++;return t},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)"string"!=typeof range[j]?results[j]=results[j]&&eval(range[j]+criteria):results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return UNIQUE.apply(null,utils.flatten(arguments)).length},exports.FISHER=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.FISHERINV=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.FREQUENCY=function(data,e){if(data=utils.parseNumberArray(utils.flatten(data)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(data,e))return error.value;for(var t=data.length,b=e.length,o=[],i=0;i<=b;i++){o[i]=0;for(var n=0;n<t;n++)0===i?data[n]<=e[0]&&(o[0]+=1):i<b?data[n]>e[i-1]&&data[n]<=e[i]&&(o[i]+=1):i===b&&data[n]>e[b-1]&&(o[b]+=1)}return o},exports.LARGE=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort((function(a,b){return b-a}))[t-1]},exports.MAX=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MAXA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MIN=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MINA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MODE={},exports.MODE.MULT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,o=e.length,n={},r=[],l=0,i=0;i<o;i++)n[t=e[i]]=n[t]?n[t]+1:1,n[t]>l&&(l=n[t],r=[]),n[t]===l&&(r[r.length]=t);return r},exports.MODE.SNGL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:exports.MODE.MULT(e).sort((function(a,b){return a-b}))[0]},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var o=(e=e.sort((function(a,b){return a-b}))).length;if(t<1/(o+1)||t>1-1/(o+1))return error.num;var n=t*(o+1)-1,r=Math.floor(n);return utils.cleanFloat(n===r?e[n]:e[r]+(n-r)*(e[r+1]-e[r]))},exports.PERCENTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var o=t*((e=e.sort((function(a,b){return a-b}))).length-1),n=Math.floor(o);return utils.cleanFloat(o===n?e[o]:e[n]+(o-n)*(e[n+1]-e[n]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(e,t,o){if(o=void 0===o?3:o,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;e=e.sort((function(a,b){return a-b}));for(var n=UNIQUE.apply(null,e),r=e.length,l=n.length,c=Math.pow(10,o),d=0,f=!1,i=0;!f&&i<l;)t===n[i]?(d=(e.indexOf(n[i])+1)/(r+1),f=!0):t>=n[i]&&(t<n[i+1]||i===l-1)&&(d=(e.indexOf(n[i])+1+(t-n[i])/(n[i+1]-n[i]))/(r+1),f=!0),i++;return Math.floor(d*c)/c},exports.PERCENTRANK.INC=function(e,t,o){if(o=void 0===o?3:o,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o))return error.value;e=e.sort((function(a,b){return a-b}));for(var n=UNIQUE.apply(null,e),r=e.length,l=n.length,c=Math.pow(10,o),d=0,f=!1,i=0;!f&&i<l;)t===n[i]?(d=e.indexOf(n[i])/(r-1),f=!0):t>=n[i]&&(t<n[i+1]||i===l-1)&&(d=(e.indexOf(n[i])+(t-n[i])/(n[i+1]-n[i]))/(r-1),f=!0),i++;return Math.floor(d*c)/c},exports.PERMUT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:FACT(e)/FACT(e-t)},exports.PERMUTATIONA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.pow(e,t)},exports.PHI=function(e){return(e=utils.parseNumber(e))instanceof Error?error.value:Math.exp(-.5*e*e)/SQRT2PI},exports.PROB=function(e,t,o,n){if(void 0===o)return 0;if(n=void 0===n?o:n,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),o=utils.parseNumber(o),n=utils.parseNumber(n),utils.anyIsError(e,t,o,n))return error.value;if(o===n)return e.indexOf(o)>=0?t[e.indexOf(o)]:0;for(var r=e.sort((function(a,b){return a-b})),l=r.length,c=0,i=0;i<l;i++)r[i]>=o&&r[i]<=n&&(c+=t[e.indexOf(r[i])]);return c},exports.QUARTILE={},exports.QUARTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.EXC(e,.25);case 2:return exports.PERCENTILE.EXC(e,.5);case 3:return exports.PERCENTILE.EXC(e,.75);default:return error.num}},exports.QUARTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.INC(e,.25);case 2:return exports.PERCENTILE.INC(e,.5);case 3:return exports.PERCENTILE.INC(e,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=(o=o||!1)?function(a,b){return a-b}:function(a,b){return b-a},r=(t=(t=utils.flatten(t)).sort(n)).length,l=0,i=0;i<r;i++)t[i]===e&&l++;return l>1?(2*t.indexOf(e)+l+1)/2:t.indexOf(e)+1},exports.RANK.EQ=function(e,t,o){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var n=(o=o||!1)?function(a,b){return a-b}:function(a,b){return b-a};return(t=t.sort(n)).indexOf(e)+1},exports.RSQ=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:Math.pow(exports.PEARSON(e,t),2)},exports.SMALL=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort((function(a,b){return a-b}))[t-1]},exports.STANDARDIZE=function(e,t,o){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:(e-t)/o},exports.STDEV={},exports.STDEV.P=function(){var e=exports.VAR.P.apply(this,arguments);return Math.sqrt(e)},exports.STDEV.S=function(){var e=exports.VAR.S.apply(this,arguments);return Math.sqrt(e)},exports.STDEVA=function(){var e=exports.VARA.apply(this,arguments);return Math.sqrt(e)},exports.STDEVPA=function(){var e=exports.VARPA.apply(this,arguments);return Math.sqrt(e)},exports.VAR={},exports.VAR.P=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,n=exports.AVERAGE(e),i=0;i<t;i++)o+=Math.pow(e[i]-n,2);return o/t},exports.VAR.S=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,o=0,n=exports.AVERAGE(e),i=0;i<t;i++)o+=Math.pow(e[i]-n,2);return o/(t-1)},exports.VARA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,n=0,r=exports.AVERAGEA(e),i=0;i<t;i++){var l=e[i];o+="number"==typeof l?Math.pow(l-r,2):!0===l?Math.pow(1-r,2):Math.pow(0-r,2),null!==l&&n++}return o/(n-1)},exports.VARPA=function(){for(var e=utils.flatten(arguments),t=e.length,o=0,n=0,r=exports.AVERAGEA(e),i=0;i<t;i++){var l=e[i];o+="number"==typeof l?Math.pow(l-r,2):!0===l?Math.pow(1-r,2):Math.pow(0-r,2),null!==l&&n++}return o/n},exports.WEIBULL={},exports.WEIBULL.DIST=function(e,t,o,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),o=utils.parseNumber(o),utils.anyIsError(e,t,o)?error.value:n?1-Math.exp(-Math.pow(e/o,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/o,t))*t/Math.pow(o,t)},exports.Z={},exports.Z.TEST=function(e,t,o){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;o=o||exports.STDEV.S(e);var n=e.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(e)-t)/(o/Math.sqrt(n)),!0)},exports}(),jexcel.methods.utils=function(){var e={PROGRESS:function(p,e){return'<div style="width:'+(p||"0")+"%;height:4px;background-color:"+(e||"red")+';margin-top:1px;"></div>'},RATING:function(e){for(var html='<div class="jrating">',i=0;i<5;i++)html+=i<e?'<div class="jrating-selected"></div>':"<div></div>";return html+="</div>"}};return e}();for(var i=0;i<Object.keys(jexcel.methods).length;i++)for(var methods=jexcel.methods[Object.keys(jexcel.methods)[i]],j=0;j<Object.keys(methods).length;j++)"function"==typeof methods[Object.keys(methods)[j]]?window[Object.keys(methods)[j]]=methods[Object.keys(methods)[j]]:window[Object.keys(methods)[j]]=function(){return Object.keys(methods)[j]+"Not implemented"};return jexcel},module.exports=factory()}).call(this,__webpack_require__(281),__webpack_require__(281))},711:function(e,t,o){var content=o(859);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(27).default)("893aec4c",content,!0,{sourceMap:!1})},774:function(e,t,o){"use strict";o(17),o(11),o(18),o(21);var n=o(2),r=(o(32),o(19),o(50),o(92),o(495),o(25),o(43),o(496),o(497),o(498),o(499),o(500),o(501),o(502),o(503),o(504),o(505),o(506),o(507),o(508),o(42),o(55),o(14),o(93),o(509),o(4)),l=o(72),c=o(0);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,o)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var h=["sm","md","lg","xl"],m=h.reduce((function(e,t){return e[t]={type:[Boolean,String,Number],default:!1},e}),{}),j=h.reduce((function(e,t){return e["offset"+Object(c.A)(t)]={type:[String,Number],default:null},e}),{}),v=h.reduce((function(e,t){return e["order"+Object(c.A)(t)]={type:[String,Number],default:null},e}),{}),x={col:Object.keys(m),offset:Object.keys(j),order:Object.keys(v)};function w(e,t,o){var n=e;if(null!=o&&!1!==o){if(t){var r=t.replace(e,"");n+="-".concat(r)}return"col"!==e||""!==o&&!0!==o?(n+="-".concat(o)).toLowerCase():n.toLowerCase()}}var y=new Map;t.a=r.default.extend({name:"v-col",functional:!0,props:f(f(f(f({cols:{type:[Boolean,String,Number],default:!1}},m),{},{offset:{type:[String,Number],default:null}},j),{},{order:{type:[String,Number],default:null}},v),{},{alignSelf:{type:String,default:null,validator:function(e){return["auto","start","end","center","baseline","stretch"].includes(e)}},tag:{type:String,default:"div"}}),render:function(e,t){var o=t.props,data=t.data,r=t.children,c=(t.parent,"");for(var d in o)c+=String(o[d]);var f=y.get(c);return f||function(){var e,t;for(t in f=[],x)x[t].forEach((function(e){var n=o[e],r=w(t,e,n);r&&f.push(r)}));var r=f.some((function(e){return e.startsWith("col-")}));f.push((e={col:!r||!o.cols},Object(n.a)(e,"col-".concat(o.cols),o.cols),Object(n.a)(e,"offset-".concat(o.offset),o.offset),Object(n.a)(e,"order-".concat(o.order),o.order),Object(n.a)(e,"align-self-".concat(o.alignSelf),o.alignSelf),e)),y.set(c,f)}(),e(o.tag,Object(l.a)(data,{class:f}),r)}})},775:function(e,t,o){"use strict";o(17),o(11),o(18),o(21);var n=o(2),r=(o(55),o(70),o(35),o(19),o(50),o(92),o(495),o(25),o(43),o(496),o(497),o(498),o(499),o(500),o(501),o(502),o(503),o(504),o(505),o(506),o(507),o(508),o(42),o(14),o(509),o(4)),l=o(72),c=o(0);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,o)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var h=["sm","md","lg","xl"],m=["start","end","center"];function j(e,t){return h.reduce((function(o,n){return o[e+Object(c.A)(n)]=t(),o}),{})}var v=function(e){return[].concat(m,["baseline","stretch"]).includes(e)},x=j("align",(function(){return{type:String,default:null,validator:v}})),w=function(e){return[].concat(m,["space-between","space-around"]).includes(e)},y=j("justify",(function(){return{type:String,default:null,validator:w}})),C=function(e){return[].concat(m,["space-between","space-around","stretch"]).includes(e)},E=j("alignContent",(function(){return{type:String,default:null,validator:C}})),A={align:Object.keys(x),justify:Object.keys(y),alignContent:Object.keys(E)},L={align:"align",justify:"justify",alignContent:"align-content"};function I(e,t,o){var n=L[e];if(null!=o){if(t){var r=t.replace(e,"");n+="-".concat(r)}return(n+="-".concat(o)).toLowerCase()}}var N=new Map;t.a=r.default.extend({name:"v-row",functional:!0,props:f(f(f({tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:v}},x),{},{justify:{type:String,default:null,validator:w}},y),{},{alignContent:{type:String,default:null,validator:C}},E),render:function(e,t){var o=t.props,data=t.data,r=t.children,c="";for(var d in o)c+=String(o[d]);var f=N.get(c);return f||function(){var e,t;for(t in f=[],A)A[t].forEach((function(e){var n=o[e],r=I(t,e,n);r&&f.push(r)}));f.push((e={"no-gutters":o.noGutters,"row--dense":o.dense},Object(n.a)(e,"align-".concat(o.align),o.align),Object(n.a)(e,"justify-".concat(o.justify),o.justify),Object(n.a)(e,"align-content-".concat(o.alignContent),o.alignContent),e)),N.set(c,f)}(),e(o.tag,Object(l.a)(data,{staticClass:"row",class:f}),r)}})},785:function(e,t,o){var content=o(786);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(27).default)("5c8fbe94",content,!0,{sourceMap:!1})},786:function(e,t,o){var n=o(26)(!1);n.push([e.i,".v-textarea textarea{align-self:stretch;flex:1 1 auto;line-height:1.75rem;max-width:100%;min-height:32px;outline:none;padding:0;width:100%}.v-textarea .v-text-field__prefix,.v-textarea .v-text-field__suffix{padding-top:2px;align-self:start}.v-textarea.v-text-field--box .v-text-field__prefix,.v-textarea.v-text-field--box textarea,.v-textarea.v-text-field--enclosed .v-text-field__prefix,.v-textarea.v-text-field--enclosed textarea{margin-top:24px}.v-textarea.v-text-field--box.v-text-field--outlined:not(.v-input--dense) .v-text-field__prefix,.v-textarea.v-text-field--box.v-text-field--outlined:not(.v-input--dense) .v-text-field__suffix,.v-textarea.v-text-field--box.v-text-field--outlined:not(.v-input--dense) textarea,.v-textarea.v-text-field--box.v-text-field--single-line:not(.v-input--dense) .v-text-field__prefix,.v-textarea.v-text-field--box.v-text-field--single-line:not(.v-input--dense) .v-text-field__suffix,.v-textarea.v-text-field--box.v-text-field--single-line:not(.v-input--dense) textarea,.v-textarea.v-text-field--enclosed.v-text-field--outlined:not(.v-input--dense) .v-text-field__prefix,.v-textarea.v-text-field--enclosed.v-text-field--outlined:not(.v-input--dense) .v-text-field__suffix,.v-textarea.v-text-field--enclosed.v-text-field--outlined:not(.v-input--dense) textarea,.v-textarea.v-text-field--enclosed.v-text-field--single-line:not(.v-input--dense) .v-text-field__prefix,.v-textarea.v-text-field--enclosed.v-text-field--single-line:not(.v-input--dense) .v-text-field__suffix,.v-textarea.v-text-field--enclosed.v-text-field--single-line:not(.v-input--dense) textarea{margin-top:10px}.v-textarea.v-text-field--box.v-text-field--outlined:not(.v-input--dense) .v-label,.v-textarea.v-text-field--box.v-text-field--single-line:not(.v-input--dense) .v-label,.v-textarea.v-text-field--enclosed.v-text-field--outlined:not(.v-input--dense) .v-label,.v-textarea.v-text-field--enclosed.v-text-field--single-line:not(.v-input--dense) .v-label{top:18px}.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-text-field__prefix,.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-text-field__suffix,.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense textarea,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-text-field__prefix,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-text-field__suffix,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense textarea,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-text-field__prefix,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-text-field__suffix,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense textarea,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-text-field__prefix,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-text-field__suffix,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense textarea{margin-top:6px}.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-input__append-inner,.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-input__append-outer,.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-input__prepend-inner,.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-input__prepend-outer,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-input__append-inner,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-input__append-outer,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-input__prepend-inner,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-input__prepend-outer,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-input__append-inner,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-input__append-outer,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-input__prepend-inner,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-input__prepend-outer,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-input__append-inner,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-input__append-outer,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-input__prepend-inner,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-input__prepend-outer{align-self:flex-start;margin-top:8px}.v-textarea.v-text-field--solo{align-items:flex-start}.v-textarea.v-text-field--solo .v-input__append-inner,.v-textarea.v-text-field--solo .v-input__append-outer,.v-textarea.v-text-field--solo .v-input__prepend-inner,.v-textarea.v-text-field--solo .v-input__prepend-outer{align-self:flex-start;margin-top:12px}.v-application--is-ltr .v-textarea.v-text-field--solo .v-input__append-inner{padding-left:12px}.v-application--is-rtl .v-textarea.v-text-field--solo .v-input__append-inner{padding-right:12px}.v-textarea--auto-grow textarea{overflow:hidden}.v-textarea--no-resize textarea{resize:none}.v-textarea.v-text-field--enclosed .v-text-field__slot{align-self:stretch}.v-application--is-ltr .v-textarea.v-text-field--enclosed .v-text-field__slot{margin-right:-12px}.v-application--is-rtl .v-textarea.v-text-field--enclosed .v-text-field__slot{margin-left:-12px}.v-application--is-ltr .v-textarea.v-text-field--enclosed .v-text-field__slot textarea{padding-right:12px}.v-application--is-rtl .v-textarea.v-text-field--enclosed .v-text-field__slot textarea{padding-left:12px}",""]),e.exports=n},813:function(e,t,o){"use strict";o(19),o(17),o(11),o(18),o(14),o(21);var n=o(2),r=(o(32),o(67),o(785),o(125)),l=o(8);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,o)}return t}var d=Object(l.a)(r.a);t.a=d.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(e){return!isNaN(parseFloat(e))}},rows:{type:[Number,String],default:5,validator:function(e){return!isNaN(parseInt(e,10))}}},computed:{classes:function(){return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},r.a.options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{autoGrow:function(e){var t=this;this.$nextTick((function(){var o;e?t.calculateInputHeight():null==(o=t.$refs.input)||o.style.removeProperty("height")}))},lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var e=this;setTimeout((function(){e.autoGrow&&e.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var input=this.$refs.input;if(input){input.style.height="0";var e=input.scrollHeight,t=parseInt(this.rows,10)*parseFloat(this.rowHeight);input.style.height=Math.max(t,e)+"px"}},genInput:function(){var input=r.a.options.methods.genInput.call(this);return input.tag="textarea",delete input.data.attrs.type,input.data.attrs.rows=this.rows,input},onInput:function(e){r.a.options.methods.onInput.call(this,e),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(e){this.isFocused&&13===e.keyCode&&e.stopPropagation(),this.$emit("keydown",e)}}})},856:function(e,t,o){e.exports=function(){"use strict";var e=function(t){var o={},n="4.9.21",r=function(e,component){return!(!e[component.type]||e[component.type]!=component)||!!e.parentNode&&r(e.parentNode,component)},l=function(element){if(e.current.length>0)for(var i=0;i<e.current.length;i++)e.current[i]&&!r(element,e.current[i])&&e.current[i].close()};return o.init=function(){var element=null;document.addEventListener("mousedown",(function(e){if(e.changedTouches&&e.changedTouches[0])var t=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY;else t=e.clientX,o=e.clientY;if(e.target&&e.target.shadowRoot)var n=e.target.shadowRoot;else n=document;element=n.elementFromPoint(t,o)})),document.addEventListener("click",(function(e){l(element)})),o.version=n},o.setExtensions=function(e){if("object"==typeof e)for(var t=Object.keys(e),i=0;i<t.length;i++)o[t[i]]=e[t[i]]},o.tracking=function(component,t){if(1==t)e.current=e.current.filter((function(e){return null!==e})),setTimeout((function(){e.current.push(component)}),0);else{var o=e.current.indexOf(component);o>=0&&(e.current[o]=null)}},o.path=function(e,t){if((e=e.split(".")).length){for(var o=this,p=null;e.length>1;)if(p=e.shift(),o.hasOwnProperty(p))o=o[p];else{if(void 0===t)return;o[p]={},o=o[p]}if(p=e.shift(),void 0!==t)return o[p]=t,!0;if(o)return o[p]}return!1},o.setDictionary=function(t){if(0==(n=Object.keys(o.dictionary)).length)o.dictionary=t;else for(var n=Object.keys(t),i=0;i<n.length;i++)o.dictionary[n[i]]=t[n[i]];var r=null;for(i=0;i<e.calendar.weekdays.length;i++)r=e.translate(e.calendar.weekdays[i]),e.calendar.weekdays[i]&&(e.calendar.weekdays[i]=r,e.calendar.weekdaysShort[i]=r.substr(0,3));for(i=0;i<e.calendar.months.length;i++)(r=e.translate(e.calendar.months[i]))&&(e.calendar.months[i]=r,e.calendar.monthsShort[i]=r.substr(0,3))},o.dictionary={},o.translate=function(e){return o.dictionary[e]||e},o.current=[],o}();"undefined"!=typeof document&&e.init(),e.ajax=function(t,o){if(Array.isArray(t)){var n={instance:[],complete:o};if(t.length>0)for(var i=0;i<t.length;i++)t[i].multiple=n,n.instance.push(e.ajax(t[i]));return n}if(t.data||(t.data={}),t.type&&(t.method=t.type),t.method||(t.method="GET"),t.dataType||(t.dataType="json"),t.data){var r=function(e,t){var o=[],n=Object.keys(e);if(n.length)for(var i=0;i<n.length;i++){if(t)var l=t+"["+n[i]+"]";else l=n[i];if("object"==typeof e[n[i]])for(var c=r(e[n[i]],l),d=Object.keys(c),f=0;f<d.length;f++)o[d[f]]=c[d[f]];else o[l]=e[n[i]]}return o},data=[],l=r(t.data),c=Object.keys(l);for(i=0;i<c.length;i++)data.push(c[i]+"="+encodeURIComponent(l[c[i]]));"GET"==t.method&&data.length>0&&(t.url.indexOf("?")<0&&(t.url+="?"),t.url+=data.join("&"))}var d=new XMLHttpRequest;return d.open(t.method,t.url,!0),d.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"==t.method?(d.setRequestHeader("Accept","application/json"),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded")):"json"==t.dataType?d.setRequestHeader("Content-Type","text/json"):"blob"==t.dataType?d.responseType="blob":"html"==t.dataType&&d.setRequestHeader("Content-Type","text/html"),1!=t.cache&&(d.setRequestHeader("pragma","no-cache"),d.setRequestHeader("cache-control","no-cache")),1==t.withCredentials&&(d.withCredentials=!0),"function"==typeof t.beforeSend&&t.beforeSend(d),d.onload=function(){if(200===d.status)if("json"==t.dataType)try{var o=JSON.parse(d.responseText);t.success&&"function"==typeof t.success&&t.success(o)}catch(e){t.error&&"function"==typeof t.error&&t.error(e,o)}else o="blob"==t.dataType?d.response:d.responseText,t.success&&"function"==typeof t.success&&t.success(o);else t.error&&"function"==typeof t.error&&t.error(d.responseText,d.status);if(e.ajax.queue&&e.ajax.queue.length>0&&e.ajax.send(e.ajax.queue.shift()),e.ajax.requests&&e.ajax.requests.length){var n=e.ajax.requests.indexOf(d);e.ajax.requests.splice(n,1),e.ajax.requests.length||t.complete&&"function"==typeof t.complete&&t.complete(o),t.group&&e.ajax.oncomplete&&"function"==typeof e.ajax.oncomplete[t.group]&&(e.ajax.pending(t.group)||(e.ajax.oncomplete[t.group](),e.ajax.oncomplete[t.group]=null)),t.multiple&&t.multiple.instance&&(n=t.multiple.instance.indexOf(d),t.multiple.instance.splice(n,1),t.multiple.instance.length||t.multiple.complete&&"function"==typeof t.multiple.complete&&t.multiple.complete(o))}},d.options=t,d.data=data,1==t.queue&&e.ajax.requests.length>0?e.ajax.queue.push(d):e.ajax.send(d),d},e.ajax.send=function(t){t.data?t.send(t.data.join("&")):t.send(),e.ajax.requests.push(t)},e.ajax.exists=function(e,t){var o=new XMLHttpRequest;o.open("HEAD",e,!1),o.send(),o.status&&t(o.status)},e.ajax.pending=function(t){var o=0,n=e.ajax.requests;if(n&&n.length)for(var i=0;i<n.length;i++)t&&t!=n[i].options.group||o++;return o},e.ajax.oncomplete={},e.ajax.requests=[],e.ajax.queue=[],e.alert=function(t){e.getWindowWidth()<800&&e.dialog?e.dialog.open({title:"Alert",message:t}):alert(t)},e.animation={},e.animation.slideLeft=function(element,e,t){1==e?(element.classList.add("slide-left-in"),setTimeout((function(){element.classList.remove("slide-left-in"),"function"==typeof t&&t()}),400)):(element.classList.add("slide-left-out"),setTimeout((function(){element.classList.remove("slide-left-out"),"function"==typeof t&&t()}),400))},e.animation.slideRight=function(element,e,t){1==e?(element.classList.add("slide-right-in"),setTimeout((function(){element.classList.remove("slide-right-in"),"function"==typeof t&&t()}),400)):(element.classList.add("slide-right-out"),setTimeout((function(){element.classList.remove("slide-right-out"),"function"==typeof t&&t()}),400))},e.animation.slideTop=function(element,e,t){1==e?(element.classList.add("slide-top-in"),setTimeout((function(){element.classList.remove("slide-top-in"),"function"==typeof t&&t()}),400)):(element.classList.add("slide-top-out"),setTimeout((function(){element.classList.remove("slide-top-out"),"function"==typeof t&&t()}),400))},e.animation.slideBottom=function(element,e,t){1==e?(element.classList.add("slide-bottom-in"),setTimeout((function(){element.classList.remove("slide-bottom-in"),"function"==typeof t&&t()}),400)):(element.classList.add("slide-bottom-out"),setTimeout((function(){element.classList.remove("slide-bottom-out"),"function"==typeof t&&t()}),100))},e.animation.fadeIn=function(element,e){element.style.display="",element.classList.add("fade-in"),setTimeout((function(){element.classList.remove("fade-in"),"function"==typeof e&&e()}),2e3)},e.animation.fadeOut=function(element,e){element.classList.add("fade-out"),setTimeout((function(){element.style.display="none",element.classList.remove("fade-out"),"function"==typeof e&&e()}),1e3)},e.calendar=function(t,o){if(t.calendar)return t.calendar.setOptions(o,!0);var n={type:"calendar",options:{},date:null,setOptions:function(o,r){for(var l={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:e.calendar.monthsShort,monthsFull:e.calendar.months,weekdays:e.calendar.weekdays,weekdays_short:e.calendar.weekdays,textDone:e.translate("Done"),textReset:e.translate("Reset"),textUpdate:e.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null},i=0;i<l.weekdays_short.length;i++)l.weekdays_short[i]=l.weekdays_short[i].substr(0,1);for(var c in l)o&&o.hasOwnProperty(c)?n.options[c]=o[c]:void 0!==n.options[c]&&!0!==r||(n.options[c]=l[c]);if(0==n.options.resetButton?f.style.display="none":f.style.display="",n.options.readonly?t.setAttribute("readonly","readonly"):t.removeAttribute("readonly"),n.options.placeholder?t.setAttribute("placeholder",n.options.placeholder):t.removeAttribute("placeholder"),e.isNumeric(n.options.value)&&n.options.value>0&&(n.options.value=e.calendar.numToDate(n.options.value),n.options.dataType="numeric"),f.innerHTML=n.options.textReset,h.innerHTML=n.options.textDone,L.innerHTML=n.options.textUpdate,t.setAttribute("data-mask",n.options.format.toLowerCase()),!n.options.value&&n.options.today)var d=e.calendar.now();else d=n.options.value;return d&&(n.options.value=null,n.setValue(d)),n},open:function(o){if(!d.classList.contains("jcalendar-focus")&&!d.classList.contains("jcalendar-inline")){if(e.calendar.current=n,e.tracking(n,!0),n.getDays(),"year-month-picker"==n.options.type&&n.getMonths(),n.options.time&&(I.value=n.date[3],N.value=n.date[4]),d.classList.add("jcalendar-focus"),e.getWindowWidth()<800||n.options.fullscreen)d.classList.add("jcalendar-fullsize"),e.animation.slideBottom(j,1);else{d.classList.remove("jcalendar-fullsize");var rect=t.getBoundingClientRect(),r=j.getBoundingClientRect();if(n.options.position)m.style.position="fixed",window.innerHeight<rect.bottom+r.height?m.style.top=rect.top-(r.height+2)+"px":m.style.top=rect.top+rect.height+2+"px",m.style.left=rect.left+"px";else if(window.innerHeight<rect.bottom+r.height?((l=-1*(rect.height+r.height+2))+rect.top<0&&(l=-1*(rect.top+rect.height)),m.style.top=l+"px"):m.style.top="2px",window.innerWidth<rect.left+r.width){var l=window.innerWidth-(rect.left+r.width+20);m.style.left=l+"px"}else m.style.left="0px"}"function"==typeof n.options.onopen&&n.options.onopen(t)}},close:function(o,r){if(d.classList.contains("jcalendar-focus")){if(!1!==r){var element=d.querySelector(".jcalendar-selected");if("string"==typeof r)var l=r;else l=!element||element.classList.contains("jcalendar-disabled")?n.options.value:n.getValue();n.setValue(l)}o||"function"!=typeof n.options.onclose||n.options.onclose(t),d.classList.remove("jcalendar-focus"),e.tracking(n,!1),e.calendar.current=null}return n.options.value},prev:function(){"years"==n.options.mode?(n.date[0]=n.date[0]-12,n.getYears()):"months"==n.options.mode?(n.date[0]=parseInt(n.date[0])-1,n.getMonths()):(n.date[1]<2?(n.date[0]=n.date[0]-1,n.date[1]=12):n.date[1]=n.date[1]-1,n.getDays())},next:function(){"years"==n.options.mode?(n.date[0]=parseInt(n.date[0])+12,n.getYears()):"months"==n.options.mode?(n.date[0]=parseInt(n.date[0])+1,n.getMonths()):(n.date[1]>11?(n.date[0]=parseInt(n.date[0])+1,n.date[1]=1):n.date[1]=parseInt(n.date[1])+1,n.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return n.setValue(e),e},setValue:function(e){e||(e=""+e);var o=e,r=n.options.value;if(r!=o){if(o){n.setLabel(o,n.options),(l=o.split(" "))[1]||(l[1]="00:00:00");var time=l[1].split(":"),l=l[0].split("-"),c=parseInt(l[0]),d=parseInt(l[1]),f=parseInt(l[2]),h=parseInt(time[0]),i=parseInt(time[1]);n.date=[c,d,f,h,i,0],e=n.setLabel(o,n.options)}else{n.date=null;var e=""}n.options.value=o,"function"==typeof n.options.onchange&&n.options.onchange(t,o,r),t.value!=e&&(t.value=e,"function"==typeof t.onchange&&t.onchange({type:"change",target:t,value:t.value}))}n.getDays()},getValue:function(){return n.date?n.options.time?e.two(n.date[0])+"-"+e.two(n.date[1])+"-"+e.two(n.date[2])+" "+e.two(n.date[3])+":"+e.two(n.date[4])+":"+e.two(0):e.two(n.date[0])+"-"+e.two(n.date[1])+"-"+e.two(n.date[2])+" "+e.two(0)+":"+e.two(0)+":"+e.two(0):""},update:function(element,e){if(element.classList.contains("jcalendar-disabled"));else{var t=d.querySelector(".jcalendar-selected");t&&t.classList.remove("jcalendar-selected"),element.classList.add("jcalendar-selected"),element.classList.contains("jcalendar-set-month")?n.date[1]=e:n.date[2]=element.innerText,n.options.time?(n.date[3]=I.value,n.date[4]=N.value):n.close()}c()},reset:function(){n.setValue(""),n.date=null,n.close(!1,!1)},getDays:function(){n.options.mode="days";var t=new Date,o=n.date&&e.isNumeric(n.date[0])?n.date[0]:parseInt(t.getFullYear()),r=n.date&&e.isNumeric(n.date[1])?n.date[1]:parseInt(t.getMonth())+1,l=n.date&&e.isNumeric(n.date[2])?n.date[2]:parseInt(t.getDate()),d=n.date&&e.isNumeric(n.date[3])?n.date[3]:parseInt(t.getHours()),f=n.date&&e.isNumeric(n.date[4])?n.date[4]:parseInt(t.getMinutes());n.date=[o,r,l,d,f,0],v.innerHTML=o,x.innerHTML=n.options.months[r-1];var h=t.getMonth()==r-1&&t.getFullYear()==o,m=t.getDate(),j=(t=new Date(o,r,0,0,0)).getDate(),w=(t=new Date(o,r-1,0,0,0)).getDay()+1;w-=C=n.options.startingDay||0,y.innerHTML="",(I=document.createElement("tr")).setAttribute("align","center"),y.appendChild(I);for(var i=0;i<7;i++)(M=document.createElement("td")).classList.add("jcalendar-weekday"),M.innerHTML=n.options.weekdays_short[C],I.appendChild(M),++C>6&&(C=0);for(var C=0,A=0,L=0;L<6;L++){var I;(I=document.createElement("tr")).setAttribute("align","center");var N=!0;for(i=0;i<7;i++){var M;if((M=document.createElement("td")).classList.add("jcalendar-set-day"),C>=w&&C<w+j){A++,M.innerHTML=A,A==l&&M.classList.add("jcalendar-selected"),h&&m==A&&(M.style.fontWeight="bold");var k=e.calendar.now(new Date(o,r-1,A),!0);if(n.options.validRange){if(!n.options.validRange[0]||k>=n.options.validRange[0])var D=!0;else D=!1;if(!n.options.validRange[1]||k<=n.options.validRange[1])var T=!0;else T=!1;D&&T||M.classList.add("jcalendar-disabled")}N=!1}I.appendChild(M),C++}0==N&&y.appendChild(I)}n.options.time?E.style.display="":E.style.display="none",c()},getMonths:function(){n.options.mode="months";var t=n.options.months,o=(n.options.value,new Date),r=parseInt(o.getFullYear()),l=parseInt(o.getMonth())+1,d=n.date&&e.isNumeric(n.date[0])?n.date[0]:r,f=n.date&&e.isNumeric(n.date[1])?n.date[1]:l;v.innerHTML=n.date[0],x.innerHTML=t[f-1];var table=document.createElement("table");table.setAttribute("width","100%");for(var h=null,i=0;i<12;i++){i%4||((h=document.createElement("tr")).setAttribute("align","center"),table.appendChild(h));var m=document.createElement("td");if(m.classList.add("jcalendar-set-month"),m.setAttribute("data-value",i+1),m.innerText=t[i],n.options.validRange){var j=d+"-"+e.two(i+1);if(!n.options.validRange[0]||j>=n.options.validRange[0].substr(0,7))var w=!0;else w=!1;if(!n.options.validRange[1]||j<=n.options.validRange[1].substr(0,7))var C=!0;else C=!1;w&&C||m.classList.add("jcalendar-disabled")}i+1==f&&m.classList.add("jcalendar-selected"),r==d&&i+1==l&&(m.style.fontWeight="bold"),h.appendChild(m)}y.innerHTML='<tr><td colspan="7"></td></tr>',y.children[0].children[0].appendChild(table),c()},getYears:function(){n.options.mode="years";for(var t=new Date,o=t.getFullYear(),r=n.date&&e.isNumeric(n.date[0])?n.date[0]:parseInt(t.getFullYear()),l=[],i=0;i<25;i++)l[i]=parseInt(n.date[0])+(i-12);var table=document.createElement("table");for(table.setAttribute("width","100%"),i=0;i<25;i++){if(!(i%5)){var d=document.createElement("tr");d.setAttribute("align","center"),table.appendChild(d)}var f=document.createElement("td");f.classList.add("jcalendar-set-year"),f.innerText=l[i],r==l[i]&&f.classList.add("jcalendar-selected"),o==l[i]&&(f.style.fontWeight="bold"),d.appendChild(f)}y.innerHTML='<tr><td colspan="7"></td></tr>',y.firstChild.firstChild.appendChild(table),c()},setLabel:function(t,o){return e.calendar.getDateString(t,o)},fromFormatted:function(t,o){return e.calendar.extractDateFromString(t,o)}},r=function(t){if(e.findElement(t.target,"jcalendar-container")){var o=t.target.className;if("jcalendar-prev"==o)n.prev();else if("jcalendar-next"==o)n.next();else if("jcalendar-month"==o)n.getMonths();else if("jcalendar-year"==o)n.getYears();else if("jcalendar-set-year"==o)n.date[0]=t.target.innerText,"year-month-picker"==n.options.type?n.getMonths():n.getDays();else if(t.target.classList.contains("jcalendar-set-month")){var r=parseInt(t.target.getAttribute("data-value"));"year-month-picker"==n.options.type?n.update(t.target,r):(n.date[1]=r,n.getDays())}else"jcalendar-confirm"==o||"jcalendar-update"==o||"jcalendar-close"==o?n.close():"jcalendar-backdrop"==o?n.close(!1,!1):"jcalendar-reset"==o?n.reset():t.target.classList.contains("jcalendar-set-day")&&t.target.innerText&&n.update(t.target)}else n.close()},l=function(t){if(t.target.value&&t.target.value.length>3){var o=e.calendar.extractDateFromString(t.target.value,n.options.format);o&&n.setValue(o)}},c=function(){var e=d.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(L.setAttribute("disabled","disabled"),I.setAttribute("disabled","disabled"),N.setAttribute("disabled","disabled")):(L.removeAttribute("disabled"),I.removeAttribute("disabled"),N.removeAttribute("disabled")),"function"==typeof n.options.onupdate&&n.options.onupdate(t,n.getValue())},d=null,f=null,h=null,m=null,j=null,v=null,x=null,w=null,y=null,C=null,E=null,A=null,L=null,I=null,N=null;return function(){"INPUT"==t.tagName&&t.value&&(o.value=t.value),(f=document.createElement("div")).className="jcalendar-reset",(h=document.createElement("div")).className="jcalendar-confirm",(C=document.createElement("div")).className="jcalendar-controls",C.style.borderBottom="1px solid #ddd",C.appendChild(f),C.appendChild(h),(m=document.createElement("div")).className="jcalendar-container",(j=document.createElement("div")).className="jcalendar-content",m.appendChild(j),"DIV"==t.tagName?(d=t).classList.add("jcalendar-inline"):(j.appendChild(C),(d=document.createElement("div")).className="jcalendar"),d.classList.add("jcalendar-container"),d.appendChild(m);var c=document.createElement("div");c.className="jcalendar-table",j.appendChild(c);var M=document.createElement("td");M.setAttribute("colspan","2"),M.className="jcalendar-prev",(v=document.createElement("span")).className="jcalendar-year",(x=document.createElement("span")).className="jcalendar-month";var k=document.createElement("td");k.className="jcalendar-header",k.setAttribute("colspan","3"),k.appendChild(x),k.appendChild(v);var D=document.createElement("td");D.setAttribute("colspan","2"),D.className="jcalendar-next";var T=document.createElement("thead"),S=document.createElement("tr");S.appendChild(M),S.appendChild(k),S.appendChild(D),T.appendChild(S),w=document.createElement("table"),y=document.createElement("tbody"),w.setAttribute("cellpadding","0"),w.setAttribute("cellspacing","0"),w.appendChild(T),w.appendChild(y),c.appendChild(w),(I=document.createElement("select")).className="jcalendar-select",I.onchange=function(){n.date[3]=this.value,"function"==typeof n.options.onupdate&&n.options.onupdate(t,n.getValue())};for(var i=0;i<24;i++)(element=document.createElement("option")).value=i,element.innerHTML=e.two(i),I.appendChild(element);for((N=document.createElement("select")).className="jcalendar-select",N.onchange=function(){n.date[4]=this.value,"function"==typeof n.options.onupdate&&n.options.onupdate(t,n.getValue())},i=0;i<60;i++){var element;(element=document.createElement("option")).value=i,element.innerHTML=e.two(i),N.appendChild(element)}var O=document.createElement("div");O.className="jcalendar-controls",(E=document.createElement("div")).className="jcalendar-time",E.style.maxWidth="140px",E.appendChild(I),E.appendChild(N),(L=document.createElement("button")).setAttribute("type","button"),L.className="jcalendar-update",(A=document.createElement("div")).style.flexGrow="10",A.appendChild(L),O.appendChild(E),"INPUT"==t.tagName&&O.appendChild(A),j.appendChild(O);var R=document.createElement("div");R.className="jcalendar-backdrop",d.appendChild(R),t.addEventListener("keyup",l),d.addEventListener("swipeleft",(function(t){e.animation.slideLeft(w,0,(function(){n.next(),e.animation.slideRight(w,1)})),t.preventDefault(),t.stopPropagation()})),d.addEventListener("swiperight",(function(t){e.animation.slideRight(w,0,(function(){n.prev(),e.animation.slideLeft(w,1)})),t.preventDefault(),t.stopPropagation()})),t.onmouseup=function(){n.open()},"ontouchend"in document.documentElement==1?d.addEventListener("touchend",r):d.addEventListener("mouseup",r),e.calendar.hasEvents||(e.calendar.hasEvents=!0,document.addEventListener("keydown",e.calendar.keydown)),n.setOptions(o),"INPUT"==t.tagName?(t.parentNode.insertBefore(d,t.nextSibling),t.setAttribute("autocomplete","off"),t.classList.add("jcalendar-input"),t.value=n.setLabel(n.getValue(),n.options)):(n.getDays(),n.options.time&&(I.value=n.date[3],N.value=n.date[4])),1==n.options.opened&&n.open(),t.change=n.setValue,t.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},t.calendar=d.calendar=n}(),n},e.calendar.keydown=function(t){var o=null;(o=e.calendar.current)&&(13==t.which?o.close(!1,!0):27==t.which&&o.close(!1,!1))},e.calendar.prettify=function(e,t){t||(t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"});var o=new Date,n=new Date(e),r=parseInt((o-n)/1e3/60);if(String.prototype.format=function(e){return this.replace("{0}",e)},0==r)var text=t.justNow;else text=r<90?t.xMinutesAgo.format(r):r<1440?t.xHoursAgo.format(Math.round(r/60)):r<20160?t.xDaysAgo.format(Math.round(r/1440)):r<43200?t.xWeeksAgo.format(Math.round(r/10080)):r<1036800?t.xMonthsAgo.format(Math.round(r/43200)):t.xYearsAgo.format(Math.round(r/525600));return text},e.calendar.prettifyAll=function(){for(var t=document.querySelectorAll(".prettydate"),i=0;i<t.length;i++)t[i].getAttribute("data-date")?t[i].innerHTML=e.calendar.prettify(t[i].getAttribute("data-date")):t[i].innerHTML&&(t[i].setAttribute("data-date",t[i].innerHTML),t[i].innerHTML=e.calendar.prettify(t[i].innerHTML))},e.calendar.now=function(t,o){if(Array.isArray(t))var n=t[0],r=t[1],l=t[2],c=t[3],i=t[4],s=t[5];else t||(t=new Date),n=t.getFullYear(),r=t.getMonth()+1,l=t.getDate(),c=t.getHours(),i=t.getMinutes(),s=t.getSeconds();return 1==o?e.two(n)+"-"+e.two(r)+"-"+e.two(l):e.two(n)+"-"+e.two(r)+"-"+e.two(l)+" "+e.two(c)+":"+e.two(i)+":"+e.two(s)},e.calendar.toArray=function(e){var time=(t=e.split(-1!==e.indexOf("T")?"T":" "))[1],t=t[0].split("-"),o=parseInt(t[0]),n=parseInt(t[1]),r=parseInt(t[2]);if(time){time=time.split(":");var l=parseInt(time[0]),i=parseInt(time[1])}else l=0,i=0;return[o,n,r,l,i,0]},e.calendar.extractDateFromString=function(t,o){if(t>0&&Number(t)==t){var n=new Date(Math.round(86400*(t-25569)*1e3));return n.getFullYear()+"-"+e.two(n.getMonth())+"-"+e.two(n.getDate())+" 00:00:00"}var r=e.mask(t,{mask:o},!0);return r.date[0]&&r.date[1]?(r.date[2]||(r.date[2]=1),r.date[0]+"-"+e.two(r.date[1])+"-"+e.two(r.date[2])+" "+e.two(r.date[3])+":"+e.two(r.date[4])+":"+e.two(r.date[5])):""},e.calendar.dateToNum=function(a,b){a=new Date(a),b||(b="1899-12-30 "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()),b=new Date(b);var e=a.getTime()-b.getTime();return Math.round(e/864e5)},e.calendar.numToDate=function(t){var o=new Date(Math.round(86400*(t-25569)*1e3));return o.getFullYear()+"-"+e.two(o.getMonth()+1)+"-"+e.two(o.getDate())+" 00:00:00"},e.calendar.getDateString=function(t,o){if(o||(o={}),o&&"object"==typeof o)var n=o.format;else n=o;if(n||(n="YYYY-MM-DD"),"number"==typeof t&&n.indexOf("[h]")>=0){var r=parseFloat(24*Number(t));if(n.indexOf("mm")>=0){if((m=(""+r).split("."))[1]){var l=60*parseFloat("0."+m[1]);l=parseFloat(l.toFixed(2))}else l=0;r=parseInt(m[0])+":"+e.two(l)}return r}t instanceof Date?t=e.calendar.now(t):t&&e.isNumeric(t)&&(t=e.calendar.numToDate(t));for(var c=new RegExp(["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."].join("|"),"gi"),d=n.match(c),i=0;i<d.length;i++)"MM"==d[i].toUpperCase()&&(d[i-1]&&d[i-1].toUpperCase().indexOf("H")>=0||d[i-2]&&d[i-2].toUpperCase().indexOf("H")>=0||d[i+1]&&d[i+1].toUpperCase().indexOf("S")>=0||d[i+2]&&d[i+2].toUpperCase().indexOf("S")>=0)&&(d[i]="mi");var f={tokens:d};if(t){var h=-1!==(l=""+t).indexOf("T")?"T":" ",m=0,j=0,s=0;if((l=l.split(h))[1]&&(j=(m=l[1].split(":"))[1]?m[1]:0,s=m[2]?m[2]:0,m=m[0]?m[0]:0),(l=l[0].split("-"))[0]&&l[1]&&l[2]&&l[0]>0&&l[1]>0&&l[1]<13&&l[2]>0&&l[2]<32){f.data=[l[0],l[1],l[2],m,j,s],f.value=[];var v=new Date(f.data[0],f.data[1]-1,f.data[2],f.data[3],f.data[4],f.data[5]),x=function(i){var t=this.tokens[i],s=t.toUpperCase(),o=null;"YYYY"===s?o=this.data[0]:"YYY"===s?o=this.data[0].substring(1,4):"YY"===s?o=this.data[0].substring(2,4):"Y"===s?o=this.data[0].substring(3,4):"MON"===t?o=e.calendar.months[v.getMonth()].substr(0,3).toUpperCase():"mon"===t?o=e.calendar.months[v.getMonth()].substr(0,3).toLowerCase():"MONTH"===t?o=e.calendar.months[v.getMonth()].toUpperCase():"month"===t?o=e.calendar.months[v.getMonth()].toLowerCase():"MMMMM"===s?o=e.calendar.months[v.getMonth()].substr(0,1):"MMMM"===s||"Month"===t?o=e.calendar.months[v.getMonth()]:"MMM"===s||"Mon"==t?o=e.calendar.months[v.getMonth()].substr(0,3):"MM"===s?o=e.two(this.data[1]):"M"===s?o=v.getMonth()+1:"DAY"===t?o=e.calendar.weekdays[v.getDay()].toUpperCase():"day"===t?o=e.calendar.weekdays[v.getDay()].toLowerCase():"DDDD"===s||"Day"==t?o=e.calendar.weekdays[v.getDay()]:"DDD"===s?o=e.calendar.weekdays[v.getDay()].substr(0,3):"DD"===s?o=e.two(this.data[2]):"D"===s?o=this.data[2]:"Q"===s?o=Math.floor((v.getMonth()+3)/3):"HH24"===s||"HH"===s?o=e.two(this.data[3]):"HH12"===s?o=this.data[3]>12?e.two(this.data[3]-12):e.two(this.data[3]):"H"===s?o=this.data[3]:"MI"===s?o=e.two(this.data[4]):"SS"===s?o=e.two(this.data[5]):"MS"===s?o=v.getMilliseconds():"AM/PM"===s?o=this.data[3]>=12?"PM":"AM":"WD"===s&&(o=e.calendar.weekdays[v.getDay()]),this.value[i]=null===o?this.tokens[i]:o};for(i=0;i<f.tokens.length;i++)x.call(f,i);t=f.value.join("")}else t=""}return t},e.calendar.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e.calendar.months=["January","February","March","April","May","June","July","August","September","October","November","December"],e.calendar.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e.calendar.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.color=function(t,o){if(t.color)return t.color.setOptions(o,!0);var n={type:"color",options:{}},r=null,l=null,content=null,c=null,d=null,f=null,h=null;n.setOptions=function(o,r){var l={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(var f in o||(o={}),o&&!o.palette&&(o.palette=e.palette()),l)o&&o.hasOwnProperty(f)?n.options[f]=o[f]:void 0!==n.options[f]&&!0!==r||(n.options[f]=l[f]);return c&&(c.innerHTML=n.options.resetLabel),d&&(d.innerHTML=n.options.doneLabel),n.options.palette&&h&&h.updateContent(0,table()),"string"==typeof n.options.value&&(t.value=n.options.value),n.options.placeholder?t.setAttribute("placeholder",n.options.placeholder):t.getAttribute("placeholder")&&t.removeAttribute("placeholder"),n},n.open=function(){if(!r.classList.contains("jcolor-focus")){e.tracking(n,!0),r.classList.add("jcolor-focus");var o=content.getBoundingClientRect();if(e.getWindowWidth()<800||1==n.options.fullscreen)content.style.top="",content.classList.add("jcolor-fullscreen"),e.animation.slideBottom(content,1),l.style.display="block";else{content.classList.contains("jcolor-fullscreen")&&(content.classList.remove("jcolor-fullscreen"),l.style.display="");var rect=t.getBoundingClientRect();n.options.position?(content.style.position="fixed",window.innerHeight<rect.bottom+o.height?content.style.top=rect.top-(o.height+2)+"px":content.style.top=rect.top+rect.height+2+"px",content.style.left=rect.left+"px"):window.innerHeight<rect.bottom+o.height?content.style.top=-1*(o.height+rect.height+2)+"px":content.style.top="2px"}if("function"==typeof n.options.onopen&&n.options.onopen(t),h.setBorder(h.getActive()),n.options.value){var c=w(n.options.value);I.forEach((function(e,t){e.value=c[t],e.dispatchEvent(new Event("input"))}))}}},n.close=function(o){return r.classList.contains("jcolor-focus")&&(r.classList.remove("jcolor-focus"),l.style.display="",o||"function"!=typeof n.options.onclose||n.options.onclose(t),e.tracking(n,!1)),n.options.value},n.setValue=function(e){if(e||(e=""),e!=n.options.value){n.options.value=e,L=e;var o=r.querySelector(".jcolor-selected");o&&o.classList.remove("jcolor-selected"),n.values[e]&&n.values[e].classList.add("jcolor-selected"),"function"==typeof n.options.onchange&&n.options.onchange(t,e),t.value!=n.options.value&&(t.value=n.options.value,"function"==typeof t.onchange&&t.onchange({type:"change",target:t,value:t.value})),1==n.options.closeOnChange&&n.close()}},n.getValue=function(){return n.options.value};var m=!1,j=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},v=function(e,g,b){return"#"+j(e)+j(g)+j(b)},x=function(e){return parseInt("0x"+e)},w=function(e){return[x(e.substr(1,2)),x(e.substr(3,2)),x(e.substr(5,2))]},table=function(){var e=document.createElement("div");e.className="jcolor-grid",n.values=[];var t=document.createElement("table");t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var o=0;o<n.options.palette.length;o++){for(var tr=document.createElement("tr"),i=0;i<n.options.palette[o].length;i++){var td=document.createElement("td"),r=n.options.palette[o][i];r.length<7&&"#"!==r.substr(0,1)&&(r="#"+r),td.style.backgroundColor=r,td.setAttribute("data-value",r),td.innerHTML="",tr.appendChild(td),n.options.value==r&&td.classList.add("jcolor-selected"),n.values[r]=td}t.appendChild(tr)}return e.appendChild(t),e.addEventListener("mousedown",(function(e){if("TD"==e.target.tagName){var t=e.target.getAttribute("data-value");t&&n.setValue(t)}})),e},canvas=document.createElement("canvas");canvas.width=200,canvas.height=160;var y=canvas.getContext("2d"),C=function(){var e=f.firstChild.getBoundingClientRect();canvas.width=e.width-14,E()},E=function(){var g=y.createLinearGradient(0,0,canvas.width,0);g.addColorStop(0,"rgb(255,0,0)"),g.addColorStop(.15,"rgb(255,0,255)"),g.addColorStop(.33,"rgb(0,0,255)"),g.addColorStop(.49,"rgb(0,255,255)"),g.addColorStop(.67,"rgb(0,255,0)"),g.addColorStop(.84,"rgb(255,255,0)"),g.addColorStop(1,"rgb(255,0,0)"),y.fillStyle=g,y.fillRect(0,0,canvas.width,canvas.height),(g=y.createLinearGradient(0,0,0,canvas.height)).addColorStop(0,"rgba(255,255,255,1)"),g.addColorStop(.5,"rgba(255,255,255,0)"),g.addColorStop(.5,"rgba(0,0,0,0)"),g.addColorStop(1,"rgba(0,0,0,1)"),y.fillStyle=g,y.fillRect(0,0,canvas.width,canvas.height)},A=function(){var element=document.createElement("div");element.className="jcolor-hsl";var e=document.createElement("div");e.className="jcolor-point";var div=document.createElement("div");div.appendChild(canvas),div.appendChild(e),element.appendChild(div);var t=function(t,o,n){if(1===t){var rect=element.getBoundingClientRect(),r=o-rect.left,l=n-rect.top;r<0&&(r=0),l<0&&(l=0),r>rect.width&&(r=rect.width),l>rect.height&&(l=rect.height),e.style.left=r+"px",e.style.top=l+"px";var c=y.getImageData(r,l,1,1).data;L=v(c[0],c[1],c[2])}};return element.addEventListener("mousedown",(function(e){t(e.buttons,e.clientX,e.clientY)})),element.addEventListener("mousemove",(function(e){t(e.buttons,e.clientX,e.clientY)})),element.addEventListener("touchmove",(function(e){t(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)})),element},L="",I=[],N=function(){if(""!==L)for(var e=0;e<I.length;e++){var t=w(L);t[e]=0;var o="linear-gradient(90deg, rgb(";o+=t.join(", "),o+="), rgb(",t[e]=255,o+=t.join(", "),o+="))",I[e].style.backgroundImage=o}},M=function(){var e=document.createElement("div");e.className="jcolor-sliders";var t=document.createElement("div"),o=function(e){var o=document.createElement("div");o.className="jcolor-sliders-input-container";var label=document.createElement("label");label.innerText=e;var n=document.createElement("div");n.className="jcolor-sliders-input-subcontainer";var input=document.createElement("input");input.type="range",input.min=0,input.max=255,input.value=0,o.appendChild(label),n.appendChild(input);var r=document.createElement("div");return r.innerText=input.value,input.addEventListener("input",(function(){r.innerText=input.value})),n.appendChild(r),o.appendChild(n),t.appendChild(o),input};I=[o("Red"),o("Green"),o("Blue")],e.appendChild(t);var n=document.createElement("div");n.className="jcolor-sliders-final-color";var r=document.createElement("div");r.style.visibility="hidden",r.innerText="a",n.appendChild(r);var l=function(){var e=v(parseInt(I[0].value),parseInt(I[1].value),parseInt(I[2].value));r.innerText=e,r.style.color=e,r.style.removeProperty("visibility"),L=e};return I.forEach((function(e){e.addEventListener("input",(function(){l(),N()}))})),e.appendChild(n),e};return function(){n.setOptions(o),"INPUT"==t.tagName&&(t.classList.add("jcolor-input"),t.readOnly=!0),(r=document.createElement("div")).className="jcolor",(l=document.createElement("div")).className="jcolor-backdrop",r.appendChild(l),(content=document.createElement("div")).className="jcolor-content";var j=document.createElement("div");j.className="jcolor-controls",content.appendChild(j),(c=document.createElement("div")).className="jcolor-reset",c.innerHTML=n.options.resetLabel,c.onclick=function(e){n.setValue(""),n.close()},j.appendChild(c),(d=document.createElement("div")).className="jcolor-close",d.innerHTML=n.options.doneLabel,d.onclick=function(e){h.getActive()>0&&n.setValue(L),n.close()},j.appendChild(d),f=document.createElement("div"),content.appendChild(f),h=e.tabs(f,{animation:!0,data:[{title:"Grid",contentElement:table()},{title:"Spectrum",contentElement:A()},{title:"Sliders",contentElement:M()}],onchange:function(element,e,t){if(1===t)C();else{var o=""!==L?L:n.getValue();if(2===t&&o){var r=w(o);I.forEach((function(e,t){e.value=r[t],e.dispatchEvent(new Event("input"))}))}}},palette:"modern"}),r.appendChild(content),"INPUT"==t.tagName?t.parentNode.insertBefore(r,t.nextSibling):t.appendChild(r),t.addEventListener("mouseup",(function(e){n.open()})),l.addEventListener("mousedown",(function(e){m=!0})),l.addEventListener("mouseup",(function(e){m&&(n.close(),m=!1)})),window.addEventListener("resize",(function(){r.classList.contains("jcolor-focus")&&1==h.getActive()&&C()})),1==n.options.opened&&n.open(),t.change=n.setValue,t.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},t.color=n,r.color=n}(),n},e.contextmenu=function(t,o){var n={options:{}},r={items:null,onclick:null};for(var l in r)o&&o.hasOwnProperty(l)?n.options[l]=o[l]:n.options[l]=r[l];function c(){var header=document.createElement("div");header.classList.add("header"),header.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation()}));var title=document.createElement("a");title.classList.add("title"),title.innerHTML=e.translate("Menu"),header.appendChild(title);var t=document.createElement("a");return t.classList.add("close"),t.innerHTML=e.translate("close"),t.addEventListener("click",(function(e){n.close()})),header.appendChild(t),header}function d(e){if(!e.type||"line"!=e.type&&"divisor"!=e.type){f=document.createElement("div");var t=document.createElement("a");if(t.innerHTML=e.title,e.tooltip&&f.setAttribute("title",e.tooltip),e.icon&&f.setAttribute("data-icon",e.icon),e.id&&(f.id=e.id),e.disabled?f.className="jcontextmenu-disabled":e.onclick&&(f.method=e.onclick,f.addEventListener("mousedown",(function(e){e.preventDefault()})),f.addEventListener("mouseup",(function(){this.method(this)}))),f.appendChild(t),e.submenu){var o=document.createElement("span");o.innerHTML="&#9658;",f.appendChild(o),f.classList.add("jcontexthassubmenu");var n=document.createElement("div");n.classList.add("jcontextmenu"),n.setAttribute("tabindex","900");for(var r=e.submenu,i=0;i<r.length;i++){var l=d(r[i]);n.appendChild(l)}f.appendChild(n)}else if(e.shortcut){var c=document.createElement("span");c.innerHTML=e.shortcut,f.appendChild(c)}}else var f=document.createElement("hr");return f}return t.classList.add("jcontextmenu"),t.setAttribute("tabindex","900"),n.open=function(e,o){if(o&&(n.options.items=o,n.create(o)),n.options.items&&n.options.items.length>0||t.children.length){if(e.target)var r=e.clientX,l=e.clientY;else r=e.x,l=e.y;t.classList.add("jcontextmenu-focus"),t.focus();var rect=t.getBoundingClientRect();if(window.innerHeight<l+rect.height){var c=l-rect.height;c<0&&(c=0),t.style.top=c+"px"}else t.style.top=l+"px";window.innerWidth<r+rect.width?r-rect.width>0?t.style.left=r-rect.width+"px":t.style.left="10px":t.style.left=r+"px"}},n.close=function(){t.classList.contains("jcontextmenu-focus")&&t.classList.remove("jcontextmenu-focus")},n.create=function(e){t.innerHTML="";var o=c();t.appendChild(o);for(var i=0;i<e.length;i++){var n=d(e[i]);t.appendChild(n)}},"function"==typeof n.options.onclick&&t.addEventListener("click",(function(e){n.options.onclick(n,e)})),n.options.items&&n.create(n.options.items),t.addEventListener("blur",(function(e){n.close()})),e.contextmenu.hasEvents||(window.addEventListener("mousewheel",(function(){n.close()})),document.addEventListener("contextmenu",(function(t){var o=e.contextmenu.getElement(t.target);if(o){var element=document.querySelector("#"+o);element?(element.contextmenu.open(t),t.preventDefault()):console.error("JSUITES: Contextmenu id not found")}})),e.contextmenu.hasEvents=!0),t.contextmenu=n,n},e.contextmenu.getElement=function(element){var e=0;function path(element){element.parentNode&&element.getAttribute("aria-contextmenu-id")?e=element.getAttribute("aria-contextmenu-id"):element.parentNode&&path(element.parentNode)}return path(element),e},e.dropdown=function(t,o){if(t.dropdown)return t.dropdown.setOptions(o,!0);var n={type:"dropdown",options:{}},r=function(data,e){data&&data.length&&(!1!==n.options.sortResults&&("function"==typeof n.options.sortResults?data.sort(n.options.sortResults):data.sort(l)),n.setData(data),"function"==typeof n.options.onload&&n.options.onload(t,n,data,e)),e&&d(e),null==e&&(n.options.value=""),t.value=n.options.value,1==n.options.opened&&n.open()},l=function(e,t){var o,n;return"string"==typeof e?o=e:e.text?o=e.text:e.name&&(o=e.name),"string"==typeof t?n=t:t.text?n=t.text:t.name&&(n=t.name),"string"==typeof o||"string"==typeof n?("string"!=typeof o&&(o=""+o),"string"!=typeof n&&(n=""+n),o.localeCompare(n)):o-n},c=function(){n.value={};for(var i=0;i<n.items.length;i++)1==n.items[i].selected&&(n.items[i].element&&n.items[i].element.classList.remove("jdropdown-selected"),n.items[i].selected=null);n.options.value=""},d=function(e){if(c(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var i=0;i<e.length;i++)n.value[e[i]]=""}else void 0!==n.value[""]&&(n.value[""]="");for(i=0;i<n.items.length;i++)void 0!==n.value[f(i)]&&(n.items[i].element&&n.items[i].element.classList.add("jdropdown-selected"),n.items[i].selected=!0,n.value[f(i)]=h(i));n.options.value=Object.keys(n.value).join(";"),n.header.value=n.getText()},f=function(e,t){if(n.options.format)o="id";else var o="value";return n.items[e]?void 0!==t?n.items[e].data[o]=t:n.items[e].data[o]:""},h=function(e,t){if(n.options.format)o="name";else var o="text";return n.items[e]?void 0!==t?n.items[e].data[o]=t:n.items[e].data[o]:""},m=function(){return Object.keys(n.value)},j=function(){for(var data=[],e=Object.keys(n.value),i=0;i<e.length;i++)data.push(n.value[e[i]]);return data};n.setOptions=function(o,l){o||(o={});var c={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,sortResults:!1,autofocus:!1};for(var d in c)o&&o.hasOwnProperty(d)?n.options[d]=o[d]:void 0!==n.options[d]&&!0!==l||(n.options[d]=c[d]);return 1!=n.options.remoteSearch&&"searchbar"!==n.options.type||(n.options.autocomplete=!0),1==n.options.newOptions?n.header.classList.add("jdropdown-add"):n.header.classList.remove("jdropdown-add"),1==n.options.autocomplete?n.header.removeAttribute("readonly"):n.header.setAttribute("readonly","readonly"),n.options.placeholder?n.header.setAttribute("placeholder",n.options.placeholder):n.header.removeAttribute("placeholder"),t.classList.remove("jdropdown-searchbar"),t.classList.remove("jdropdown-picker"),t.classList.remove("jdropdown-list"),"searchbar"==n.options.type?t.classList.add("jdropdown-searchbar"):"list"==n.options.type?t.classList.add("jdropdown-list"):"picker"==n.options.type?t.classList.add("jdropdown-picker"):e.getWindowWidth()<800?n.options.autocomplete?(t.classList.add("jdropdown-searchbar"),n.options.type="searchbar"):(t.classList.add("jdropdown-picker"),n.options.type="picker"):(n.options.width?(t.style.width=n.options.width,t.style.minWidth=n.options.width):(t.style.removeProperty("width"),t.style.removeProperty("min-width")),t.classList.add("jdropdown-default"),n.options.type="default"),"searchbar"==n.options.type?v.appendChild(w):x.insertBefore(w,x.firstChild),n.options.url&&!o.data?e.ajax({url:n.options.url,method:"GET",dataType:"json",success:function(data){data&&r(data,n.options.value)}}):r(n.options.data,n.options.value),n};var v=null,x=null,content=null,w=null,y=null,C=null,E=null,A=function(){if(o||(o={}),"SELECT"==t.tagName){var r=e.dropdown.extractFromDom(t,o);t=r.el,o=r.options}!o.placeholder&&t.getAttribute("placeholder")&&(o.placeholder=t.getAttribute("placeholder")),n.value={},n.items=[],n.groups=[],n.search="",n.results=null,t.classList.add("jdropdown"),(v=document.createElement("div")).className="jdropdown-container-header",n.header=document.createElement("input"),n.header.className="jdropdown-header",n.header.type="text",n.header.setAttribute("autocomplete","off"),n.header.onfocus=function(){"function"==typeof n.options.onfocus&&n.options.onfocus(t)},n.header.onblur=function(){"function"==typeof n.options.onblur&&n.options.onblur(t)},n.header.onkeyup=function(e){1!=n.options.autocomplete||E?n.options.autocomplete||n.next(e.key):(n.search!=n.header.value.trim()&&(E=setTimeout((function(){n.find(n.header.value.trim()),E=null}),400)),t.classList.contains("jdropdown-focus")||n.open())},e.dropdown.hasEvents||(e.dropdown.hasEvents=!0,document.addEventListener("keydown",e.dropdown.keydown)),(x=document.createElement("div")).className="jdropdown-container",(content=document.createElement("div")).className="jdropdown-content",(w=document.createElement("div")).className="jdropdown-close",w.innerHTML="Done",(y=document.createElement("div")).className="jdropdown-reset",y.innerHTML="x",y.onclick=function(){n.reset(),n.close()},(C=document.createElement("div")).className="jdropdown-backdrop",v.appendChild(n.header),x.appendChild(content),t.appendChild(v),t.appendChild(x),t.appendChild(C),n.setOptions(o),"ontouchsend"in document.documentElement==1?t.addEventListener("touchsend",e.dropdown.mouseup):t.addEventListener("mouseup",e.dropdown.mouseup),1==n.options.lazyLoading&&e.lazyLoading(content,{loadUp:n.loadUp,loadDown:n.loadDown}),content.onwheel=function(e){e.stopPropagation()},t.change=n.setValue,t.val=function(e){if(void 0===e)return n.getValue(!!n.options.multiple);n.setValue(e)},t.dropdown=n};n.getUrl=function(){return n.options.url},n.setUrl=function(t,o){n.options.url=t,e.ajax({url:n.options.url,method:"GET",dataType:"json",success:function(data){n.setData(data),"function"==typeof o&&o(n)}})},n.setId=function(e,t){if(n.options.format)o="id";else var o="value";"object"==typeof e?e[o]=t:n.items[e].data[o]=t},n.add=function(title,t){if(!title){var o=1==n.options.autocomplete?n.header.value:"";if(!(title=prompt(e.translate("Add A New Option"),o)))return!1}if(t||(t=e.guid()),n.options.format)r={id:t,name:title};else var r={value:t,text:title};if("function"==typeof n.options.onbeforeinsert){var l=n.options.onbeforeinsert(n,r);if(!1===l)return!1;l&&(r=l)}n.options.data.push(r);var c=n.createItem(r);return content.appendChild(c.element),"function"==typeof n.options.oninsert&&n.options.oninsert(n,r,c),"none"==content.style.display&&(content.style.display=""),n.results&&n.results.push(c),r},n.createItem=function(data,e,t){n.options.format?(data.id||void 0===data.value||(data.id=data.value),data.name||void 0===data.text||(data.name=data.text)):(data.value||void 0===data.id||(data.value=data.id),data.text||void 0===data.name||(data.text=data.name));var o={};if(o.element=document.createElement("div"),o.element.className="jdropdown-item",o.element.indexValue=n.items.length,o.data=data,e&&(o.group=e),data.id&&o.element.setAttribute("id",data.id),1==data.disabled&&o.element.setAttribute("data-disabled",!0),data.tooltip&&o.element.setAttribute("title",data.tooltip),data.image){var image=document.createElement("img");image.className="jdropdown-image",image.src=data.image,data.title||image.classList.add("jdropdown-image-small"),o.element.appendChild(image)}else if(data.icon){var r=document.createElement("span");r.className="jdropdown-icon material-icons",r.innerText=data.icon,data.title||r.classList.add("jdropdown-icon-small"),data.color&&(r.style.color=data.color),o.element.appendChild(r)}else if(data.color){var l=document.createElement("div");l.className="jdropdown-color",l.style.backgroundColor=data.color,o.element.appendChild(l)}if(n.options.format)text=data.name;else var text=data.text;var c=document.createElement("div");if(c.className="jdropdown-description",c.innerHTML=text||"&nbsp;",data.title){var title=document.createElement("div");title.className="jdropdown-title",title.innerText=data.title,c.appendChild(title)}if(n.options.format)d=data.id;else var d=data.value;return n.value[d]&&(o.element.classList.add("jdropdown-selected"),o.selected=!0),n.items.push(o),o.element.appendChild(c),o},n.appendData=function(data){if(data.length){for(var e=[],t=[],i=0;i<data.length;i++)data[i].group?(t[data[i].group]||(t[data[i].group]=[]),t[data[i].group].push(i)):e.push(i);var o=0,r=Object.keys(t);if(r.length>0)for(i=0;i<r.length;i++){var l=document.createElement("div");l.className="jdropdown-group";var c=document.createElement("div");c.className="jdropdown-group-name",c.innerHTML=r[i];var d=document.createElement("i");d.className="jdropdown-group-arrow jdropdown-group-arrow-down",c.appendChild(d);var f=document.createElement("div");f.className="jdropdown-group-items";for(var h=0;h<t[r[i]].length;h++){var m=n.createItem(data[t[r[i]][h]],l,r[i]);(0==n.options.lazyLoading||o<200)&&(f.appendChild(m.element),o++)}l.appendChild(c),l.appendChild(f),n.groups.push(l),f.children.length>0&&content.appendChild(l)}if(e.length)for(i=0;i<e.length;i++)m=n.createItem(data[e[i]]),(0==n.options.lazyLoading||o<200)&&(content.appendChild(m.element),o++)}},n.setData=function(data){if(data.length){for(var i=0;i<data.length;i++)"object"!=typeof data[i]&&(n.options.format?data[i]={id:data[i],name:data[i]}:data[i]={value:data[i],text:data[i]});c(),content.innerHTML="",n.header.value="",n.items=[],n.appendData(data),n.options.data=data}},n.getData=function(){return n.options.data},n.getPosition=function(e){for(var i=0;i<n.items.length;i++)if(f(i)==e)return i;return!1},n.getText=function(e){var t=j();return e?t:t.join("; ")},n.getValue=function(e){var t=m();return e?t:t.join(";")};var L=function(e){"function"==typeof n.options.onchange&&n.options.onchange(t,n,e,n.options.value),t.value!=n.options.value&&(t.value=n.options.value,"function"==typeof t.onchange&&t.onchange({type:"change",target:t,value:t.value}))};n.setValue=function(e){var t=n.getValue();Array.isArray(e)&&(e=e.join(";")),t!==e&&(d(e),L(t))},n.resetSelected=function(){n.setValue(null)},n.selectIndex=function(e,t){if(e=parseInt(e),n.items&&n.items[e]&&(!0===t||!0!==n.items[e].data.disabled))if(n.setCursor(e,!1),n.options.multiple){var o=n.options.value;n.items[e].selected?(n.items[e].element.classList.remove("jdropdown-selected"),n.items[e].selected=!1,delete n.value[f(e)]):(n.items[e].element.classList.add("jdropdown-selected"),n.items[e].selected=!0,n.value[f(e)]=h(e)),n.options.value=Object.keys(n.value).join(";"),0==n.options.autocomplete&&(n.header.value=j().join("; ")),L(o)}else n.items[e].selected?n.setValue(null):n.setValue(f(e)),n.close()},n.selectItem=function(e){n.selectIndex(e.indexValue)};var I=function(e,t){for(var o=0;o<t.length;o++)if(n.options.format){if(t[o].id==e)return!0}else if(t[o].value==e)return!0;return!1};return n.find=function(t){if(n.search==t.trim())return!1;if(n.search=t,n.setCursor(),n.groups.length)for(var i=0;i<n.groups.length;i++)n.groups[i].lastChild.innerHTML="";if(content.innerHTML="",1==n.options.remoteSearch){n.results=null;var o=n.options.url+(n.options.url.indexOf("?")>0?"&":"?")+"q="+t;e.ajax({url:o,method:"GET",dataType:"json",success:function(e){n.items=[];var t=Object.keys(n.value);if(t.length)for(var i=0;i<t.length;i++)I(t[i],e)||(n.options.format?e.unshift({id:t[i],name:n.value[t[i]]}):e.unshift({value:t[i],text:n.value[t[i]]}));n.appendData(e),e.length?content.style.display="":content.style.display="none"}})}else{t=new RegExp(t,"gi");var r=[];for(i=0;i<n.items.length;i++){var label=h(i),title=n.items[i].data.title||"",l=n.items[i].data.group||"",c=n.items[i].data.synonym||"";c&&(c=c.join(" ")),(null==t||1==n.items[i].selected||label.match(t)||title.match(t)||l.match(t)||c.match(t))&&r.push(n.items[i])}if(r.length){content.style.display="",n.results=r;var d=r.length||0;for(1==n.options.lazyLoading&&d>200&&(d=200),i=0;i<d;i++)n.results[i].group?(n.results[i].group.parentNode||content.appendChild(n.results[i].group),n.results[i].group.lastChild.appendChild(n.results[i].element)):content.appendChild(n.results[i].element)}else content.style.display="none",n.results=null}1==n.options.autofocus&&n.first()},n.open=function(){if(!t.classList.contains("jdropdown-focus")){e.dropdown.current=n,e.tracking(n,!0),t.classList.add("jdropdown-focus"),e.getWindowWidth()<800&&(null!=n.options.type&&"picker"!=n.options.type||e.animation.slideBottom(x,1)),1==n.options.autocomplete&&(n.header.value=n.search,n.header.focus());var o=m();if(o[0]){var cursor=n.getPosition(o[0]);!1!==cursor&&n.setCursor(cursor)}if(!n.options.type||"default"==n.options.type){var rect=t.getBoundingClientRect(),r=x.getBoundingClientRect();n.options.position?(x.style.position="fixed",window.innerHeight<rect.bottom+r.height?(x.style.top="",x.style.bottom=window.innerHeight-rect.top+1+"px"):(x.style.top=rect.bottom+"px",x.style.bottom=""),x.style.left=rect.left+"px"):window.innerHeight<rect.bottom+r.height?(x.style.top="",x.style.bottom=rect.height+1+"px"):(x.style.top="",x.style.bottom=""),x.style.minWidth=rect.width+"px",n.options.maxWidth&&(x.style.maxWidth=n.options.maxWidth),n.items.length||1!=n.options.autocomplete?content.style.display="":content.style.display="none"}}"function"==typeof n.options.onopen&&n.options.onopen(t)},n.close=function(o){return t.classList.contains("jdropdown-focus")&&(n.header.value=n.getText(),n.setCursor(),o||"function"!=typeof n.options.onclose||n.options.onclose(t),n.header.blur&&n.header.blur(),t.classList.remove("jdropdown-focus"),e.tracking(n,!1),e.dropdown.current=null),n.getValue()},n.setCursor=function(e,t){if(null!=n.currentIndex&&n.items&&n.items[n.currentIndex]&&n.items[n.currentIndex].element.classList.remove("jdropdown-cursor"),null==e)n.currentIndex=null;else if(e=parseInt(e),n.items[e].element.parentNode&&(n.items[e].element.classList.add("jdropdown-cursor"),n.currentIndex=e,!1!==t&&n.items[n.currentIndex].element)){content.scrollTop;var element=n.items[n.currentIndex].element;content.scrollTop=element.offsetTop-element.scrollTop+element.clientTop-95}},n.resetCursor=n.setCursor,n.updateCursor=n.setCursor,n.reset=function(){n.setCursor(),n.setValue(null)},n.first=function(){!0===n.options.lazyLoading&&n.loadFirst();var e=content.querySelectorAll(".jdropdown-item");if(e.length){var t=e[0].indexValue;n.setCursor(t)}},n.last=function(){!0===n.options.lazyLoading&&n.loadLast();var e=content.querySelectorAll(".jdropdown-item");if(e.length){var t=e[e.length-1].indexValue;n.setCursor(t)}},n.next=function(e){var t=null;if(e){if(1==e.length){var o=n.currentIndex||-1;e=e.toLowerCase();var r=null,l=null,c=content.querySelectorAll(".jdropdown-item");if(c.length){for(var i=0;i<c.length;i++)if(c[i].indexValue>o&&(r=n.items[c[i].indexValue])&&(l=r.element.innerText[0])&&e==(l=l.toLowerCase())){t=c[i].indexValue;break}n.setCursor(t)}}}else if(null==n.currentIndex||null==n.currentIndex)n.first();else{var element=n.items[n.currentIndex].element,d=element.nextElementSibling;d?(d.classList.contains("jdropdown-group")&&(d=d.lastChild.firstChild),t=d.indexValue):element.parentNode.classList.contains("jdropdown-group-items")&&((d=element.parentNode.parentNode.nextElementSibling)&&(d.classList.contains("jdropdown-group")?d=d.lastChild.firstChild:d.classList.contains("jdropdown-item")?t=d.indexValue:d=null),d&&(t=d.indexValue)),null!==t&&n.setCursor(t)}},n.prev=function(){var e=null;if(null===n.currentIndex)n.first();else{var element=n.items[n.currentIndex].element,t=element.previousElementSibling;t?(t.classList.contains("jdropdown-group")&&(t=t.lastChild.lastChild),e=t.indexValue):element.parentNode.classList.contains("jdropdown-group-items")&&((t=element.parentNode.parentNode.previousElementSibling)&&(t.classList.contains("jdropdown-group")?t=t.lastChild.lastChild:t.classList.contains("jdropdown-item")?e=t.indexValue:t=null),t&&(e=t.indexValue))}null!==e&&n.setCursor(e)},n.loadFirst=function(){if(n.results)var e=n.results;else e=n.items;var t=e.length||0;1==n.options.lazyLoading&&t>200&&(t=200),content.innerHTML="";for(var i=0;i<t;i++)e[i].group?(e[i].group.parentNode||content.appendChild(e[i].group),e[i].group.lastChild.appendChild(e[i].element)):content.appendChild(e[i].element);content.scrollTop=0},n.loadLast=function(){if(n.results)var e=n.results;else e=n.items;var t=e.length;if(t>200){t-=200,content.innerHTML="";for(var i=t;i<e.length;i++)e[i].group?(e[i].group.parentNode||content.appendChild(e[i].group),e[i].group.lastChild.appendChild(e[i].element)):content.appendChild(e[i].element);content.scrollTop=content.scrollHeight}},n.loadUp=function(){var e=!1;if(n.results)var t=n.results;else t=n.items;var o=content.querySelectorAll(".jdropdown-item")[0].indexValue;o=n.items[o];var r=t.indexOf(o)-1;if(r>0){for(var l=0;r>0&&t[r]&&l<200;)t[r].group?(t[r].group.parentNode||content.insertBefore(t[r].group,content.firstChild),t[r].group.lastChild.insertBefore(t[r].element,t[r].group.lastChild.firstChild)):content.insertBefore(t[r].element,content.firstChild),r--,l++;e=!0}return e},n.loadDown=function(){var e=!1;if(n.results)var t=n.results;else t=n.items;var o=content.querySelectorAll(".jdropdown-item"),r=o[o.length-1].indexValue;r=n.items[r];var l=t.indexOf(r)+1;if(l<t.length){for(var c=0;l<t.length&&t[l]&&c<200;)t[l].group?(t[l].group.parentNode||content.appendChild(t[l].group),t[l].group.lastChild.appendChild(t[l].element)):content.appendChild(t[l].element),l++,c++;e=!0}return e},A(),n},e.dropdown.keydown=function(t){var o=null;if(o=e.dropdown.current)if(13==t.which||9==t.which)o.header.value&&null==o.currentIndex&&o.options.newOptions?o.add():(null==o.currentIndex&&1==o.options.autocomplete&&""!=o.header.value&&o.find(o.header.value),o.selectIndex(o.currentIndex));else if(38==t.which)null==o.currentIndex?o.first():o.currentIndex>0&&o.prev(),t.preventDefault();else if(40==t.which)null==o.currentIndex?o.first():o.currentIndex+1<o.items.length&&o.next(),t.preventDefault();else if(36==t.which)o.first(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(35==t.which)o.last(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(27==t.which)o.close();else if(33==t.which){if(null==o.currentIndex)o.first();else if(o.currentIndex>0)for(var i=0;i<7;i++)o.prev();t.preventDefault()}else if(34==t.which){if(null==o.currentIndex)o.first();else if(o.currentIndex+1<o.items.length)for(i=0;i<7;i++)o.next();t.preventDefault()}},e.dropdown.mouseup=function(t){var element=e.findElement(t.target,"jdropdown");if(element){var o=element.dropdown;if(t.target.classList.contains("jdropdown-header"))if(element.classList.contains("jdropdown-focus")&&element.classList.contains("jdropdown-default")){var rect=element.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var n=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else n=t.clientX,t.clientY;rect.width-(n-rect.left)<30?t.target.classList.contains("jdropdown-add")?o.add():o.close():0==o.options.autocomplete&&o.close()}else o.open();else if(t.target.classList.contains("jdropdown-group-name")){var r=t.target.nextSibling.children;if("none"!=t.target.nextSibling.style.display)for(var i=0;i<r.length;i++)"none"!=r[i].style.display&&o.selectItem(r[i])}else t.target.classList.contains("jdropdown-group-arrow")?t.target.classList.contains("jdropdown-group-arrow-down")?(t.target.classList.remove("jdropdown-group-arrow-down"),t.target.classList.add("jdropdown-group-arrow-up"),t.target.parentNode.nextSibling.style.display="none"):(t.target.classList.remove("jdropdown-group-arrow-up"),t.target.classList.add("jdropdown-group-arrow-down"),t.target.parentNode.nextSibling.style.display=""):t.target.classList.contains("jdropdown-item")?o.selectItem(t.target):t.target.classList.contains("jdropdown-image")||t.target.classList.contains("jdropdown-description")?o.selectItem(t.target.parentNode):t.target.classList.contains("jdropdown-title")?o.selectItem(t.target.parentNode.parentNode):(t.target.classList.contains("jdropdown-close")||t.target.classList.contains("jdropdown-backdrop"))&&o.close()}},e.dropdown.extractFromDom=function(e,t){var select=e;if(t||(t={}),!e.getAttribute("multiple")||t&&null!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&null!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&null!=t.autocomplete||(t.autocomplete=!0),t&&null!=t.width||(t.width=e.offsetWidth),!e.value||t&&null!=t.value||(t.value=e.value),!t||null==t.data){t.data=[];for(var o=0;o<e.children.length;o++)if("OPTGROUP"==e.children[o].tagName)for(var i=0;i<e.children[o].children.length;i++)t.data.push({value:e.children[o].children[i].value,text:e.children[o].children[i].innerHTML,group:e.children[o].getAttribute("label")});else t.data.push({value:e.children[o].value,text:e.children[o].innerHTML})}t&&null!=t.onchange||(t.onchange=function(a,b,e,o){1==t.multiple?obj.items[b].classList.contains("jdropdown-selected")?select.options[b].setAttribute("selected","selected"):select.options[b].removeAttribute("selected"):select.value=o});var div=document.createElement("div");return e.parentNode.insertBefore(div,e),e.style.display="none",{el:e=div,options:t}},e.editor=function(t,o){var n={type:"editor",options:{}},r={value:null,snippet:null,toolbar:null,remoteParser:null,placeholder:null,parseURL:!1,filterPaste:!0,dropZone:!1,dropAsSnippet:!1,acceptImages:!1,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,border:!0,padding:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null};for(var l in r)o&&o.hasOwnProperty(l)?n.options[l]=o[l]:n.options[l]=r[l];var c=null,d=null,f=[];t.innerHTML="",n.el=t,"function"==typeof n.options.onclick&&(t.onclick=function(e){n.options.onclick(t,n,e)}),t.classList.add("jeditor-container"),1==n.options.padding&&t.classList.add("jeditor-padding"),0==n.options.border&&(t.style.border="0px");var h=document.createElement("div");h.className="jsnippet",h.setAttribute("contenteditable",!1);var m=document.createElement("div");m.className="jeditor-toolbar";var j=document.createElement("div");if(j.setAttribute("contenteditable",!0),j.setAttribute("spellcheck",!1),j.className="jeditor",n.options.placeholder&&j.setAttribute("data-placeholder",n.options.placeholder),(n.options.maxHeight||n.options.height)&&(j.style.overflowY="auto",n.options.maxHeight&&(j.style.maxHeight=n.options.maxHeight),n.options.height&&(j.style.height=n.options.height)),n.options.value)var v=n.options.value;else v=t.innerHTML?t.innerHTML:"";v||(v="");var x=function(e){"function"==typeof n.options.onchange&&n.options.onchange(t,n,e),n.options.value=n.getData(),t.value!=n.options.value&&(t.value=n.options.value,"function"==typeof t.onchange&&t.onchange({type:"change",target:t,value:t.value}))},w=function(html){var div=document.createElement("div");div.innerHTML=html;var img=div.querySelectorAll("img");if(img.length)for(var i=0;i<img.length;i++)n.addImage(img[i].src)},y=function(e){var t,o;window.getSelection&&(t=window.getSelection()).rangeCount&&((o=t.getRangeAt(0)).toString(),o.deleteContents(),o.insertNode(e),o.setStartAfter(e),o.setEndAfter(e),t.removeAllRanges(),t.addRange(o))},C=function(){var e=null;if(e=h.children[0]){e.classList.contains("jslider-grid")||e.classList.add("jslider-grid");var t=e.children.length;e.setAttribute("data-number",t>4?4:t),t>4?e.setAttribute("data-total",t-4):e.removeAttribute("data-total")}},E=function(image){h.innerHTML||A({}),h.children[0].appendChild(image),C()},A=function(data){h.innerHTML="";for(var a=["image","title","description","host","url"],i=0;i<a.length;i++){var div=document.createElement("div");if(div.className="jsnippet-"+a[i],div.setAttribute("data-k",a[i]),h.appendChild(div),data[a[i]])if("image"==a[i]){Array.isArray(data.image)||(data.image=[data.image]);for(var e=0;e<data.image.length;e++){var img=document.createElement("img");img.src=data.image[e],div.appendChild(img)}}else div.innerHTML=data[a[i]]}j.appendChild(document.createElement("br")),j.appendChild(h)},L=function(){clearTimeout(c),c=setTimeout((function(){if(!j.querySelector(".jsnippet")){var html=j.innerHTML.replace(/\n/g," "),t=document.createElement("div");t.innerHTML=html;var text=t.innerText,o=e.editor.detectUrl(text);if(o)if("jpg"==o[0].substr(-3)||"png"==o[0].substr(-3)||"gif"==o[0].substr(-3))n.addImage(o[0],!0);else{var r=e.editor.youtubeParser(o[0]);n.parseWebsite(o[0],r)}}}),1e3)};n.parseContent=function(){L()},n.parseWebsite=function(t,o){if(n.options.remoteParser){o&&(t="https://www.youtube.com/watch?v="+o);var p={title:"",description:"",image:"",host:t.split("/")[2],url:t};e.ajax({url:n.options.remoteParser+encodeURI(t.trim()),method:"GET",dataType:"json",success:function(e){e.title&&(p.title=e.title),e.description&&(p.description=e.description),e.host&&(p.host=e.host),e.url&&(p.url=e.url),A(p),e.image?n.addImage(e.image,!0):e["og:image"]&&n.addImage(e["og:image"],!0)}})}else console.log("The remoteParser is not defined")},n.setData=function(html){j.innerHTML=html,n.options.focus&&e.editor.setCursor(j,!0),f=[]},n.getFiles=function(){for(var e=j.querySelectorAll(".jfile"),t=[],i=0;i<e.length;i++)f[e[i].src]&&t.push(f[e[i].src]);return t},n.getText=function(){return j.innerText},n.getData=function(e){if(e){if(data={content:""},h.innerHTML){data.snippet={};for(var i=0;i<h.children.length;i++){var t=h.children[i].getAttribute("data-k");if(t)if("image"==t){data.snippet.image||(data.snippet.image=[]);for(var o=0;o<h.children[i].children.length;o++)data.snippet.image.push(h.children[i].children[o].getAttribute("src"))}else data.snippet[t]=h.children[i].innerHTML}}var n=Object.keys(f);if(n.length)for(data.files=[],i=0;i<n.length;i++)data.files.push(f[n[i]]);var text=j.innerHTML;text=(text=(text=text.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),data.content=text.trim()}else var data=j.innerHTML;return data},n.reset=function(){j.innerHTML="",h.innerHTML="",f=[]},n.addPdf=function(data){if("data"!=data.result.substr(0,4))console.error("Invalid source");else{var canvas=document.createElement("canvas");canvas.width=60,canvas.height=60;var img=new Image;canvas.getContext("2d").drawImage(img,0,0,canvas.width,canvas.height),canvas.toBlob((function(e){var t=document.createElement("img");t.src=window.URL.createObjectURL(e),t.title=data.name,t.className="jfile pdf",f[t.src]={file:t.src,extension:"pdf",content:data.result},y(t)}))}},n.addImage=function(e,t){if(e||(e=""),"data"==e.substr(0,4)||n.options.remoteParser){if("data"==e.substr(0,4))o=(o=(o=e.split(";"))[0].split("/"))[1];else{var o=e.substr(e.lastIndexOf(".")+1);e=n.options.remoteParser+e}var img=new Image;img.onload=function(){var canvas=document.createElement("canvas");canvas.width=img.width,canvas.height=img.height,canvas.getContext("2d").drawImage(img,0,0,canvas.width,canvas.height),canvas.toBlob((function(e){var r=document.createElement("img");r.src=window.URL.createObjectURL(e),r.classList.add("jfile"),r.setAttribute("tabindex","900"),f[r.src]={file:r.src,extension:o,content:canvas.toDataURL()},n.options.dropAsSnippet||t?(E(r),f[r.src].snippet=!0):y(r),x()}))},img.src=e}else console.error("remoteParser not defined in your initialization")},n.addFile=function(e){for(var t=[],i=0;i<e.length;i++)if(e[i].size>n.options.maxFileSize)alert("The file is too big");else{var o=e[i].type.split("/");(o="image"==o[0]?1:"pdf"==o[1]?2:0)?(t[i]=new FileReader,t[i].index=i,t[i].type=o,t[i].name=e[i].name,t[i].date=e[i].lastModified,t[i].size=e[i].size,t[i].addEventListener("load",(function(data){2==data.target.type?1==n.options.acceptFiles&&n.addPdf(data.target):n.addImage(data.target.result)}),!1),t[i].readAsDataURL(e[i])):alert("The extension is not allowed")}},n.destroy=function(){j.removeEventListener("mouseup",I),j.removeEventListener("mousedown",N),j.removeEventListener("mousemove",M),j.removeEventListener("keyup",k),j.removeEventListener("keydown",D),j.removeEventListener("dragstart",F),j.removeEventListener("dragenter",z),j.removeEventListener("dragover",B),j.removeEventListener("drop",P),j.removeEventListener("paste",H),"function"==typeof n.options.onblur&&j.removeEventListener("blur",_),"function"==typeof n.options.onfocus&&j.removeEventListener("focus",V),t.editor=null,t.classList.remove("jeditor-container"),m.remove(),h.remove(),j.remove()};var I=function(e){d&&d.e&&d.e.classList.remove("resizing"),d=!1},N=function(e){var t=function(t){var rect=t.getBoundingClientRect();rect.width-(e.clientX-rect.left)<40&&e.clientY-rect.top<40&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){var rect=e.target.getBoundingClientRect();d={e:e.target,x:e.clientX,y:e.clientY,w:rect.width,h:rect.height,d:e.target.style.cursor},e.target.width||(e.target.width=rect.width+"px"),e.target.height||(e.target.height=rect.height+"px");var s=window.getSelection();if(s.rangeCount)for(var i=0;i<s.rangeCount;i++)s.removeRange(s.getRangeAt(i));e.target.classList.add("resizing")}else d=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),d=!0},M=function(e){if("IMG"==e.target.tagName&&!e.target.parentNode.classList.contains("jsnippet-image")&&1==n.options.allowImageResize&&e.target.getAttribute("tabindex")){var rect=e.target.getBoundingClientRect();e.clientY-rect.top<5?rect.width-(e.clientX-rect.left)<5?e.target.style.cursor="ne-resize":e.clientX-rect.left<5?e.target.style.cursor="nw-resize":e.target.style.cursor="n-resize":rect.height-(e.clientY-rect.top)<5?rect.width-(e.clientX-rect.left)<5?e.target.style.cursor="se-resize":e.clientX-rect.left<5?e.target.style.cursor="sw-resize":e.target.style.cursor="s-resize":rect.width-(e.clientX-rect.left)<5?e.target.style.cursor="e-resize":e.clientX-rect.left<5?e.target.style.cursor="w-resize":e.target.style.cursor=""}if(1==e.which&&d&&d.d){if("e-resize"==d.d||"ne-resize"==d.d||"se-resize"==d.d)if(d.e.width=d.w+(e.clientX-d.x),e.shiftKey){var t=(e.clientX-d.x)*(d.h/d.w);d.e.height=d.h+t}else t=null;t||"s-resize"!=d.d&&"se-resize"!=d.d&&"sw-resize"!=d.d||e.shiftKey||(d.e.height=d.h+(e.clientY-d.y))}},k=function(e){j.innerHTML||(j.innerHTML="<div><br></div>"),"function"==typeof n.options.onkeyup&&n.options.onkeyup(t,n,e)},D=function(e){1==n.options.parseURL&&L(),"function"==typeof n.options.onkeydown&&n.options.onkeydown(t,n,e),"Delete"==e.key&&"IMG"==e.target.tagName&&e.target.parentNode.classList.contains("jsnippet-image")&&(e.target.remove(),C())},T=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],S=["width","height","align","border","src","tabindex"],O=["color","font-weight","font-size","background","background-color","margin"],R=function(element){if(element.attributes&&element.attributes.length){var style=null,e=element.getAttribute("style");if(e){style=[];for(var t=e.split(";"),o=0;o<t.length;o++){var r=t[o].trim().split(":");if(O.indexOf(r[0].trim())>=0){var l=r.shift();r=r.join(":"),style.push(l+":"+r)}}}"IMG"==element.tagName.toUpperCase()&&(n.options.acceptImages&&element.src?(element.setAttribute("tabindex","900"),n.addImage(element.src)):element.parentNode.removeChild(element));var c=[],d=element.attributes.length-1;if(d>0){for(var i=d;i>=0;i--)c.push(element.attributes[i].name);c.forEach((function(e){-1==S.indexOf(e)&&element.removeAttribute(e)}))}element.style="",style&&style.length&&element.setAttribute("style",style.join(";"))}if(element.children.length)for(i=0;i<element.children.length;i++)R(element.children[i]);T.indexOf(element.constructor)>=0&&element.remove()},filter=function(data){data&&(data=data.replace(new RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var e=(new DOMParser).parseFromString(data,"text/html");R(e);var span=document.createElement("span");return span.innerHTML=e.firstChild.innerHTML,span},H=function(e){if(1==n.options.filterPaste){if(e.clipboardData||e.originalEvent.clipboardData)var html=(e.originalEvent||e).clipboardData.getData("text/html"),text=(e.originalEvent||e).clipboardData.getData("text/plain"),t=(e.originalEvent||e).clipboardData.files;else window.clipboardData&&(html=window.clipboardData.getData("Html"),text=window.clipboardData.getData("Text"),t=window.clipboardData.files);if(t.length)n.addFile(t);else if(html){var o=filter(html);document.execCommand("insertHtml",!1,o.innerHTML)}else html=text.split("\r\n"),e.target.innerText?(html=html.map((function(e){return"<div>"+e+"</div>"})),document.execCommand("insertHtml",!1,html.join(""))):html.map((function(e){var t=document.createElement("div");t.innerText=e,j.appendChild(t)}));e.preventDefault()}},F=function(e){d&&d.e&&e.preventDefault()},z=function(e){d||0==n.options.dropZone||(t.classList.add("jeditor-dragging"),e.preventDefault())},B=function(e){d||0==n.options.dropZone||(c&&clearTimeout(c),c=setTimeout((function(){t.classList.remove("jeditor-dragging")}),100),e.preventDefault())},P=function(e){if(d||0==n.options.dropZone);else{var o=null;document.caretRangeFromPoint?o=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(o=document.createRange()).setStart(e.rangeParent,e.rangeOffset);var r=window.getSelection();r.removeAllRanges(),r.addRange(o),r.anchorNode.parentNode.focus();var html=(e.originalEvent||e).dataTransfer.getData("text/html"),text=(e.originalEvent||e).dataTransfer.getData("text/plain"),l=(e.originalEvent||e).dataTransfer.files;l.length?n.addFile(l):text&&w(html),t.classList.remove("jeditor-dragging"),e.preventDefault()}},_=function(e){"function"==typeof n.options.onblur&&n.options.onblur(t,n,e),x(e)},V=function(e){"function"==typeof n.options.onfocus&&n.options.onfocus(t,n,e)};return j.addEventListener("mouseup",I),j.addEventListener("mousedown",N),j.addEventListener("mousemove",M),j.addEventListener("keyup",k),j.addEventListener("keydown",D),j.addEventListener("dragstart",F),j.addEventListener("dragenter",z),j.addEventListener("dragover",B),j.addEventListener("drop",P),j.addEventListener("paste",H),j.addEventListener("focus",V),j.addEventListener("blur",_),"function"==typeof n.options.onload&&n.options.onload(t,n,j),j.innerHTML=v,t.appendChild(j),n.options.snippet&&A(n.options.snippet),null==n.options.toolbar&&(n.options.toolbar=e.editor.getDefaultToolbar()),n.options.toolbar&&(t.appendChild(m),e.toolbar(m,{container:!0,responsive:!0,items:n.options.toolbar})),n.options.focus&&e.editor.setCursor(j,"initial"==n.options.focus),t.change=n.setData,t.val=function(e){if(void 0===e){var o="true"!==t.getAttribute("data-html");return n.getData(o)}n.setData(e)},t.editor=n,n},e.editor.setCursor=function(element,e){element.focus(),document.execCommand("selectAll");var t=window.getSelection(),o=t.getRangeAt(0);if(1==e)var n=o.startContainer,r=0;else r=(n=o.endContainer).length;o.setStart(n,r),o.setEnd(n,r),t.removeAllRanges(),t.addRange(o)},e.editor.getDomain=function(e){return e.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split(/:/g)[0]},e.editor.detectUrl=function(text){var e=/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi,t=text.match(e);return t&&"www"==t[0].substr(0,3)&&(t[0]="http://"+t[0]),t},e.editor.youtubeParser=function(e){var t=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,o=e.match(t);return!(!o||11!=o[7].length)&&o[7]},e.editor.getDefaultToolbar=function(){return[{content:"undo",onclick:function(){document.execCommand("undo")}},{content:"redo",onclick:function(){document.execCommand("redo")}},{type:"divisor"},{content:"format_bold",onclick:function(a,b,e){document.execCommand("bold"),document.queryCommandState("bold")?e.classList.add("selected"):e.classList.remove("selected")}},{content:"format_italic",onclick:function(a,b,e){document.execCommand("italic"),document.queryCommandState("italic")?e.classList.add("selected"):e.classList.remove("selected")}},{content:"format_underline",onclick:function(a,b,e){document.execCommand("underline"),document.queryCommandState("underline")?e.classList.add("selected"):e.classList.remove("selected")}},{type:"divisor"},{content:"format_list_bulleted",onclick:function(a,b,e){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?e.classList.add("selected"):e.classList.remove("selected")}},{content:"format_list_numbered",onclick:function(a,b,e){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?e.classList.add("selected"):e.classList.remove("selected")}},{content:"format_indent_increase",onclick:function(a,b,e){document.execCommand("indent",!0,null),document.queryCommandState("indent")?e.classList.add("selected"):e.classList.remove("selected")}},{content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}]},e.form=function(t,o){var n={options:{}},r={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(t,o){e.alert(o)}};for(var l in r)o&&o.hasOwnProperty(l)?n.options[l]=o[l]:n.options[l]=r[l];n.options.validations||(n.options.validations={}),n.options.submitButton||(n.options.submitButton=t.querySelector("input[type=submit]")),n.options.submitButton&&n.options.url&&(n.options.submitButton.onclick=function(){n.save()}),n.options.validations.email||(n.options.validations.email=e.validations.email),n.options.validations.length||(n.options.validations.length=e.validations.length),n.options.validations.required||(n.options.validations.required=e.validations.required),n.setUrl=function(e){n.options.url=e},n.load=function(){e.ajax({url:n.options.url,method:"GET",dataType:"json",queue:!0,success:function(data){if("function"==typeof n.options.onbeforeload){var o=n.options.onbeforeload(t,data);o&&(data=o)}e.form.setElements(t,data),"function"==typeof n.options.onload&&n.options.onload(t,data)}})},n.save=function(){var o=n.validate();if(o)n.options.onerror(t,o);else{var data=e.form.getElements(t,!0);if("function"==typeof n.options.onbeforesave&&!1===(data=n.options.onbeforesave(t,data)))return;e.ajax({url:n.options.url,method:"POST",dataType:"json",data:data,success:function(e){"function"==typeof n.options.onsave&&n.options.onsave(t,data,e)}})}},n.remove=function(){if("function"==typeof n.options.onbeforeremove&&!1===n.options.onbeforeremove(t,n))return!1;e.ajax({url:n.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof n.options.onremove&&n.options.onremove(t,n,e),n.reset()}})};var c=function(element){element.classList.add("error"),n.options.submitButton&&n.options.submitButton.setAttribute("disabled",!0);var e=element.getAttribute("data-error")||"There is an error in the form";return element.setAttribute("title",e),e},d=function(element){var e=!1;element.classList.remove("error"),element.removeAttribute("title");for(var o=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<o.length;i++)o[i].getAttribute("data-validation")&&o[i].classList.contains("error")&&(e=!0);n.options.submitButton&&(e?n.options.submitButton.setAttribute("disabled",!0):n.options.submitButton.removeAttribute("disabled"))};return n.validateElement=function(element){var t=!1,o=e.form.getValue(element),r=element.getAttribute("data-validation");return"function"!=typeof n.options.validations[r]||n.options.validations[r](o,element)?element.classList.contains("error")&&d(element):t=c(element),t},n.reset=function(){for(var e=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<e.length;i++)e[i].getAttribute("name")&&("checkbox"==e[i].type||"radio"==e[i].type?e[i].checked=!1:"function"==typeof e[i].val?e[i].val(""):e[i].value="")},n.validate=function(){for(var e=[],o=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<o.length;i++)if(o[i].getAttribute("data-validation")){var r=n.validateElement(o[i]);r&&e.push(r)}return e.length>0&&e.join("<br>")},n.getError=function(){return!!n.validation()},n.setHash=function(){return n.getHash(e.form.getElements(t))},n.getHash=function(e){var i,t=0;if(0===e.length)return t;for(i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t},n.isChanged=function(){var e=n.setHash();return n.options.currentHash!=e},n.resetTracker=function(){n.options.currentHash=n.setHash(),n.options.ignore=!1},n.setIgnore=function(e){n.options.ignore=!!e},setTimeout((function(){n.options.currentHash=n.setHash()}),1e3),t.addEventListener("keyup",(function(e){e.target.getAttribute("data-validation")&&n.validateElement(e.target)})),e.form.hasEvents||(window.addEventListener("beforeunload",(function(e){if(n.isChanged()&&0==n.options.ignore){var t=n.options.message?n.options.message:"o/";return t?(void 0===e&&(e=window.event),e&&(e.returnValue=t),t):void 0}})),e.form.hasEvents=!0),t.form=n,n},e.form.getValue=function(element){var e=null;if("checkbox"==element.type)1==element.checked&&(e=element.value||!0);else if("radio"==element.type)1==element.checked&&(e=element.value);else if("select"==element.tagName&&1==element.multiple){e=[];for(var t=element.querySelectorAll("options[selected]"),o=0;o<t.length;o++)e.push(t[o].value)}else e="function"==typeof element.val?element.val():element.value||"";return e},e.form.getElements=function(t,o){for(var data={},n=null,r=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<r.length;i++)(n=r[i].getAttribute("name"))&&(data[n]=e.form.getValue(r[i])||"");return 1==o?data:JSON.stringify(data)},e.form.setElements=function(t,data){for(var o=null,n=null,r=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<r.length;i++){var l=r[i].getAttribute("type");if(o=r[i].getAttribute("name")){if(n=null,(o=o.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)){var c=e.path.call(data,o)||"";void 0!==c&&(n=c)}else void 0!==data[o]&&(n=data[o]);null!==n&&("checkbox"==l||"radio"==l?r[i].checked=!!n:"function"==typeof r[i].val?r[i].val(n):r[i].value=n)}}},e.tracker=e.form,e.focus=function(e){if(e.innerText.length){var t=document.createRange(),o=window.getSelection(),n=e.childNodes[e.childNodes.length-1];t.setStart(n,n.length),t.collapse(!0),o.removeAllRanges(),o.addRange(t),e.scrollLeft=e.scrollWidth}},e.isNumeric=function(e){return!isNaN(e)&&null!==e&&""!==e},e.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e.getNode=function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},e.hash=function(e){var i,t,o=0;if(0===e.length)return o;for(i=0;i<e.length;i++)(t=e.charCodeAt(i))>32&&(o=(o<<5)-o+t,o|=0);return o},e.randomColor=function(t){var o=-.25,n=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");n.length<6&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]);var r,i,l=[];for(i=0;i<3;i++)r=parseInt(n.substr(2*i,2),16),r=Math.round(Math.min(Math.max(0,r+r*o),255)).toString(16),l.push(("00"+r).substr(r.length));return 1==t?"#"+e.two(l[0].toString(16))+e.two(l[1].toString(16))+e.two(l[2].toString(16)):l},e.getWindowWidth=function(){var e=window,t=document,o=t.documentElement,g=t.getElementsByTagName("body")[0];return e.innerWidth||o.clientWidth||g.clientWidth},e.getWindowHeight=function(){var e=window,t=document,o=t.documentElement,g=t.getElementsByTagName("body")[0];return e.innerHeight||o.clientHeight||g.clientHeight},e.getPosition=function(e){if(e.changedTouches&&e.changedTouches[0])var t=e.changedTouches[0].pageX,o=e.changedTouches[0].pageY;else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),o=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,o]},e.click=function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},e.findElement=function(element,e){var t=!1;function path(element){element&&!t&&("function"==typeof e?t=e(element):"string"==typeof e&&element.classList&&element.classList.contains(e)&&(t=element)),element.parentNode&&!t&&path(element.parentNode)}return path(element),t},e.two=function(e){return 1==(e=""+e).length&&(e="0"+e),e},e.sha512=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}var a,b,o,n,r,l,g,c,d,f,h=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],m=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],j=new Array(64),v=8;function x(e){return unescape(encodeURIComponent(e))}function w(e){for(var t=[],mask=(1<<v)-1,o=e.length*v,i=0;i<o;i+=v)t[i>>5]|=(e.charCodeAt(i/v)&mask)<<32-v-i%32;return t}function y(e){for(var t,o="0123456789abcdef",n="",r=4*e.length,i=0;i<r;i+=1)t=e[i>>2]>>8*(3-i%4),n+=o.charAt(t>>4&15)+o.charAt(15&t);return n}function C(e,o){var n,r,l;return n=(65535&e.lowOrder)+(65535&o.lowOrder),l=(65535&(r=(e.lowOrder>>>16)+(o.lowOrder>>>16)+(n>>>16)))<<16|65535&n,n=(65535&e.highOrder)+(65535&o.highOrder)+(r>>>16),new t((65535&(r=(e.highOrder>>>16)+(o.highOrder>>>16)+(n>>>16)))<<16|65535&n,l)}function E(a,b,e,o){var n,r,l;return n=(65535&a.lowOrder)+(65535&b.lowOrder)+(65535&e.lowOrder)+(65535&o.lowOrder),l=(65535&(r=(a.lowOrder>>>16)+(b.lowOrder>>>16)+(e.lowOrder>>>16)+(o.lowOrder>>>16)+(n>>>16)))<<16|65535&n,n=(65535&a.highOrder)+(65535&b.highOrder)+(65535&e.highOrder)+(65535&o.highOrder)+(r>>>16),new t((65535&(r=(a.highOrder>>>16)+(b.highOrder>>>16)+(e.highOrder>>>16)+(o.highOrder>>>16)+(n>>>16)))<<16|65535&n,l)}function A(a,b,e,o,n){var r,l,c;return r=(65535&a.lowOrder)+(65535&b.lowOrder)+(65535&e.lowOrder)+(65535&o.lowOrder)+(65535&n.lowOrder),c=(65535&(l=(a.lowOrder>>>16)+(b.lowOrder>>>16)+(e.lowOrder>>>16)+(o.lowOrder>>>16)+(n.lowOrder>>>16)+(r>>>16)))<<16|65535&r,r=(65535&a.highOrder)+(65535&b.highOrder)+(65535&e.highOrder)+(65535&o.highOrder)+(65535&n.highOrder)+(l>>>16),new t((65535&(l=(a.highOrder>>>16)+(b.highOrder>>>16)+(e.highOrder>>>16)+(o.highOrder>>>16)+(n.highOrder>>>16)+(r>>>16)))<<16|65535&r,c)}function L(e,o,n){return new t(e.highOrder&o.highOrder^e.highOrder&n.highOrder^o.highOrder&n.highOrder,e.lowOrder&o.lowOrder^e.lowOrder&n.lowOrder^o.lowOrder&n.lowOrder)}function I(e,o,n){return new t(e.highOrder&o.highOrder^~e.highOrder&n.highOrder,e.lowOrder&o.lowOrder^~e.lowOrder&n.lowOrder)}function N(e,o){return o<=32?new t(e.highOrder>>>o|e.lowOrder<<32-o,e.lowOrder>>>o|e.highOrder<<32-o):new t(e.lowOrder>>>o|e.highOrder<<32-o,e.highOrder>>>o|e.lowOrder<<32-o)}function M(e){var o=N(e,28),n=N(e,34),r=N(e,39);return new t(o.highOrder^n.highOrder^r.highOrder,o.lowOrder^n.lowOrder^r.lowOrder)}function k(e){var o=N(e,14),n=N(e,18),r=N(e,41);return new t(o.highOrder^n.highOrder^r.highOrder,o.lowOrder^n.lowOrder^r.lowOrder)}function D(e){var o=N(e,1),n=N(e,8),r=S(e,7);return new t(o.highOrder^n.highOrder^r.highOrder,o.lowOrder^n.lowOrder^r.lowOrder)}function T(e){var o=N(e,19),n=N(e,61),r=S(e,6);return new t(o.highOrder^n.highOrder^r.highOrder,o.lowOrder^n.lowOrder^r.lowOrder)}function S(e,o){return o<=32?new t(e.highOrder>>>o,e.lowOrder>>>o|e.highOrder<<32-o):new t(0,e.highOrder<<32-o)}var O=(e=x(e)).length*v;(e=w(e))[O>>5]|=128<<24-O%32,e[31+(O+128>>10<<5)]=O;for(var i=0;i<e.length;i+=32){a=h[0],b=h[1],o=h[2],n=h[3],r=h[4],l=h[5],g=h[6],c=h[7];for(var R=0;R<80;R++)j[R]=R<16?new t(e[2*R+i],e[2*R+i+1]):E(T(j[R-2]),j[R-7],D(j[R-15]),j[R-16]),d=A(c,k(r),I(r,l,g),m[R],j[R]),f=C(M(a),L(a,b,o)),c=g,g=l,l=r,r=C(n,d),n=o,o=b,b=a,a=C(d,f);h[0]=C(a,h[0]),h[1]=C(b,h[1]),h[2]=C(o,h[2]),h[3]=C(n,h[3]),h[4]=C(r,h[4]),h[5]=C(l,h[5]),h[6]=C(g,h[6]),h[7]=C(c,h[7])}var H=[];for(i=0;i<h.length;i++)H.push(h[i].highOrder),H.push(h[i].lowOrder);return y(H)},e.login||(e.login={},e.login.sha512=e.sha512),e.image=e.upload=function(t,o){var n={options:{}},r={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null,text:{extensionNotAllowed:"The extension is not allowed"}};for(var l in r)o&&o.hasOwnProperty(l)?n.options[l]=o[l]:n.options[l]=r[l];1==n.options.multiple&&t.setAttribute("data-multiple",!0),t.content=[],t.classList.add("jupload"),1==n.options.input&&t.classList.add("input"),n.add=function(data){if(0==n.options.multiple&&(t.content=[],t.innerText=""),"image"==n.options.type){var img=document.createElement("img");img.setAttribute("src",data.file),img.setAttribute("tabindex",-1),t.getAttribute("name")||(img.className="jfile",img.content=data),t.appendChild(img)}else{if(data.name)var o=data.name;else o=data.file;var div=document.createElement("div");div.innerText=o||n.options.type,div.classList.add("jupload-item"),div.setAttribute("tabindex",-1),t.appendChild(div)}data.content&&(data.file=e.guid()),t.content.push(data),"function"==typeof n.options.onchange&&n.options.onchange(t,data)},n.addFromFile=function(e){if(e.type.split("/")[0]==n.options.type){var t=new FileReader;t.addEventListener("load",(function(t){var data={file:t.srcElement.result,extension:e.name.substr(e.name.lastIndexOf(".")+1),name:e.name,size:e.size,lastmodified:e.lastModified,content:t.srcElement.result};n.add(data)})),t.readAsDataURL(e)}else alert(n.options.text.extensionNotAllowed)},n.addFromUrl=function(t){if("data"==t.substr(0,4)||n.options.remoteParser)if("data"==t.substr(0,4))if((o=(o=t.split(";"))[0].split("/"))[0].replace("data:","")==n.options.type){var data={file:t,name:"",extension:o[1],content:t};n.add(data)}else alert(n.options.text.extensionNotAllowed);else{var o=t.substr(t.lastIndexOf(".")+1);t=n.options.remoteParser+t,e.ajax({url:t,type:"GET",dataType:"blob",success:function(data){}})}else console.error("remoteParser not defined in your initialization")};var c=n.options.type+"/"+n.options.extension,input=document.createElement("input");input.type="file",input.setAttribute("accept",c),input.onchange=function(){for(var i=0;i<this.files.length;i++)n.addFromFile(this.files[i])},1==n.options.multiple&&input.setAttribute("multiple",!0);var d=null;return t.addEventListener("click",(function(o){d=null,t.children.length&&o.target!==t?o.target.parentNode==t&&(d=o.target):e.click(input)})),t.addEventListener("dblclick",(function(t){e.click(input)})),t.addEventListener("dragenter",(function(e){t.style.border="1px dashed #000"})),t.addEventListener("dragleave",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragstop",(function(e){t.style.border="1px solid #eee"})),t.addEventListener("dragover",(function(e){e.preventDefault()})),t.addEventListener("keydown",(function(e){if(d&&46==e.which){var o=Array.prototype.indexOf.call(t.children,d);o>=0&&(t.content.splice(o,1),d.remove(),d=null)}})),t.addEventListener("drop",(function(e){e.preventDefault(),e.stopPropagation();var html=(e.originalEvent||e).dataTransfer.getData("text/html");if((e.originalEvent||e).dataTransfer.files.length)for(var i=0;i<e.dataTransfer.files.length;i++)n.addFromFile(e.dataTransfer.files[i]);else if(html){0==n.options.multiple&&(t.innerText="");var div=document.createElement("div");div.innerHTML=html;var img=div.querySelectorAll("img");if(img.length)for(i=0;i<img.length;i++)n.addFromUrl(img[i].src)}return t.style.border="1px solid #eee",!1})),t.val=function(e){if(void 0===e)return t.content&&t.content.length?t.content:null;if(t.innerText="",t.content=[],e)if(Array.isArray(e))for(var i=0;i<e.length;i++)"string"==typeof e[i]?n.add({file:e[i]}):n.add(e[i]);else"string"==typeof e&&n.add({file:e})},t.upload=t.image=n,n},e.image.create=function(data){var img=document.createElement("img");return img.setAttribute("src",data.file),img.className="jfile",img.setAttribute("tabindex",-1),img.content=data,img},e.lazyLoading=function(e,t){var o={};t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var n=null,r=function(o){if(null==n){var r=!1,l=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&(l==e.scrollTop&&(e.scrollTop=e.scrollTop-e.clientHeight),r=!0):e.scrollTop<=e.clientHeight&&t.loadUp()&&(l==e.scrollTop&&(e.scrollTop=e.scrollTop+e.clientHeight),r=!0),n=setTimeout((function(){n=null}),t.timer),r&&"function"==typeof t.onupdate&&t.onupdate()}};return e.onscroll=function(e){r(e)},e.onwheel=function(e){r(e)},o},e.loading=function(){var e={},t=null;return e.show=function(){t||((t=document.createElement("div")).className="jloading"),document.body.appendChild(t)},e.hide=function(){t&&t.parentNode&&document.body.removeChild(t)},e}(),e.mask=function(){var t={currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","HH24","HH12","HH","\\[H\\]","H","AM/PM","PM","AM","MI","SS","MS","MONTH","MON","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},o=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var t=0;this.date[4]&&(t=parseFloat(this.date[4]/60));var o=parseInt(this.date[3])+t;o/=24}else this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),o=e.two(this.date[0])+"-"+e.two(this.date[1])+"-"+e.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(o+=" "+e.two(this.date[3])+":"+e.two(this.date[4])+":"+e.two(this.date[5]))):o=e.two(this.date[3])+":"+e.two(this.date[4])+":"+e.two(this.date[5]);return o},n=function(e){return null===e||""===e||void 0===e},r=function(e){return"="==(""+e).chartAt(0)},l=function(e){return"currency"===e||"percentage"===e||"numeric"===e},c=function(e){if(e&&Number(e)==e)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var t=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=t[1]}if(e||(e=this.mask),(t=(o=new RegExp("0{1}(.{1})0+","ig")).exec(e))&&t[1]&&1==t[1].length)return this.options.decimal=t[1],t[1];var o=new RegExp("#,##","ig");return e&&e.match(o)||"."=="1.1".toLocaleString().substring(1,2)?this.options.decimal=".":this.options.decimal=",",this.options.decimal?this.options.decimal:null},d=function(e,t){return""==e?"":(t||(t=c.call(this)),(e=(""+e).split(t))[0]=e[0].match(/[\-0-9]+/g,""),e[0]&&(e[0]=e[0].join("")),e[0]||e[1]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g,""),e[1]?e[1]=e[1].join(""):e[1]=""),e):"")},f=function(e){if(""==e)return"";var t=c.call(this),o=Object.create(this.options||{});if(o.minimumFractionDigits||(o.minimumFractionDigits=1),""==(e=d.call(this,e)))return"";if(e[0]){var n=parseFloat(e.join("."));"percent"==o.style&&(n/=100)}else n=null;var r=new Intl.NumberFormat(this.locale,o).format(n),s=(r=r.split(t))[1].replace(/[0-9]*/g,"");return s&&(r[2]=s),void 0!==e[1]?r[1]=t+e[1]:r[1]="",r.join("")},h=function(e){var t=v.call(e);if(t){c.call(this);var o=f.call(this,t),n=o.length-t.length,r=j.call(e)+n;v.call(e,o,r,!0)}},m=function(e){var t=d.call(this,e);return t?parseFloat(t.join(".")):null},j=function(e,t){if(void 0===e){if("DIV"==this.tagName){var o=0;return(s=window.getSelection())&&0!==s.rangeCount&&((p=(r=s.getRangeAt(0)).cloneRange()).selectNodeContents(this),p.setEnd(r.endContainer,r.endOffset),o=p.toString().length),o}return this.selectionStart}var n=v.call(this);if(t){for(var p=null,i=0;i<n.length;i++)(n[i].match(/[\-0-9]/g)||"."==n[i]||","==n[i])&&(p=i);null===p&&(p=n.indexOf(" ")),e>=p&&(e=p+1)}if(e>n.length&&(e=n.length),e)if("DIV"==this.tagName){var r,s=window.getSelection();(r=document.createRange()).setStart(this.childNodes[0],e),s.removeAllRanges(),s.addRange(r)}else this.selectionStart=e,this.selectionEnd=e},v=function(e,t,o){if("DIV"==this.tagName){if(void 0===e)return this.innerText;this.innerText!==e&&(this.innerText=e,t&&j.call(this,t,o))}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t&&j.call(this,t,o))}},x=e.calendar.weekdays,w=e.calendar.weekdaysShort,y=e.calendar.months,C=e.calendar.monthsShort,E={YEAR:function(e,s){var t=""+(new Date).getFullYear();void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<=10&&this.values[this.index].length<s&&(this.values[this.index]+=e),this.values[this.index].length==s&&(2==s?t=t.substr(0,2)+this.values[this.index]:3==s?t=t.substr(0,1)+this.values[this.index]:4==s&&(t=this.values[this.index]),this.date[0]=t,this.index++)},YYYY:function(e){E.YEAR.call(this,e,4)},YYY:function(e){E.YEAR.call(this,e,3)},YY:function(e){E.YEAR.call(this,e,2)},FIND:function(e,a){n(this.values[this.index])&&(this.values[this.index]="");for(var t=0,o=0,r=(this.values[this.index]+e).toLowerCase(),i=0;i<a.length;i++)0==a[i].toLowerCase().indexOf(r)&&(t=i,o++);if(o>1)this.values[this.index]+=e;else if(1==o){var l=a[t].length-this.values[this.index].length-1;return this.position+=l,this.values[this.index]=a[t],this.index++,t}},MMM:function(e){var t=E.FIND.call(this,e,C);void 0!==t&&(this.date[1]=t+1)},MMMM:function(e){var t=E.FIND.call(this,e,y);void 0!==t&&(this.date[1]=t+1)},MMMMM:function(e){n(this.values[this.index])&&(this.values[this.index]="");for(var t=(this.values[this.index]+e).toLowerCase(),i=0;i<y.length;i++)if(0==y[i][0].toLowerCase().indexOf(t)){this.values[this.index]=y[i][0],this.date[1]=i+1,this.index++;break}},MM:function(e){n(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(this.date[1]=this.values[this.index]="0"+e,this.index++):parseInt(e)<2&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?n(this.values[this.index])?(this.values[this.index]=e,e>1&&(this.date[1]=this.values[this.index],this.index++)):1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0?(this.date[1]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var o=parseInt(this.values[this.index]);o>0&&o<12&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},D:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?n(this.values[this.index])?(this.values[this.index]=e,parseInt(e)>3&&(this.date[2]=this.values[this.index],this.index++)):3==this.values[this.index]&&parseInt(e)<2||1==this.values[this.index]||2==this.values[this.index]||0==this.values[this.index]&&parseInt(e)>0?(this.date[2]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var o=parseInt(this.values[this.index]);o>0&&o<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(e){n(this.values[this.index])?parseInt(e)>3&&parseInt(e)<10?(this.date[2]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(3==this.values[this.index]&&parseInt(e)<2||(1==this.values[this.index]||2==this.values[this.index])&&parseInt(e)<10||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){E.FIND.call(this,e,w)},DDDD:function(e){E.FIND.call(this,e,x)},HH12:function(e,t){n(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||this.values[this.index]<1&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++)},HH24:function(e,t){parseInt(e)>=0&&parseInt(e)<10&&(null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>2&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(2==this.values[this.index]&&parseInt(e)<4||this.values[this.index]<2&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++))},HH:function(e){E.HH24.call(this,e,1)},H:function(e){E.HH24.call(this,e,0)},"\\[H\\]":function(e){null==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,i){null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>5&&parseInt(e)<10?(this.date[i]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):parseInt(e)<10&&(this.date[i]=this.values[this.index]+=e,this.index++)},MI:function(e){E.N60.call(this,e,4)},SS:function(e){E.N60.call(this,e,5)},"AM/PM":function(e){this.values[this.index]="",e&&(this.date[3]>12?this.values[this.index]="PM":this.values[this.index]="AM"),this.index++},WD:function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<7&&(this.values[this.index]=e),1==this.value[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=c.call(this),o=!1;n(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(o=!0);var r=d.call(this,this.values[this.index],t);r&&(this.values[this.index]=r.join(t)),parseInt(e)>=0&&parseInt(e)<10?"0"==this.values[this.index]&&e!=t||(this.values[this.index]+=e):t&&e==t?-1==this.values[this.index].indexOf(t)&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=e):"-"==e&&(o=!0),!0===o&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(e){E["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){E["0{1}(.{1}0+)?"].call(this,e);var t=c.call(this),o=this.tokens[this.index].substr(1,1),n="-"===this.values[this.index][0],r=d.call(this,this.values[this.index],t);if(""!==r){var l=r[0].match(/[0-9]/g);if(l){for(var f=[],s=0,h=(l=l.join("")).length-1;h>=0;h--)f.push(l[h]),++s%3||f.push(o);f=f.reverse(),r[0]=f.join(""),r[0].substr(0,1)==o&&(r[0]=r[0].substr(1))}else r[0]="";this.values[this.index]=r.join(t),n&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){n(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){E["[0-9a-zA-Z$]+"].call(this,e)}},A=function(e){if("general"==this.type)var o=[].concat(t.general);else o=[].concat(t.currency,t.datetime,t.percentage,t.numeric,t.general);var n=new RegExp(o.join("|"),"gi");return e.match(n)},L=function(e){if(this.type)o="general"==this.type?["general"]:"datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","numeric","general"];else var o=Object.keys(t);for(var i=0;i<o.length;i++)for(var n=o[i],r=0;r<t[n].length;r++){var l=new RegExp(t[n][r],"gi");if(e.match(l))return{type:n,method:t[n][r]}}},I=function(e){for(var t=[],i=0;i<e.length;i++){var o=L.call(this,e[i]);o?t.push(o.method):t.push(null)}for(i=0;i<t.length;i++)"MM"==t[i]&&(t[i-1]&&t[i-1].indexOf("H")>=0||t[i-2]&&t[i-2].indexOf("H")>=0||t[i+1]&&t[i+1].indexOf("S")>=0||t[i+2]&&t[i+2].indexOf("S")>=0)&&(t[i]="MI");return t},N=function(e){var t=L.call(this,e);if(t)var o=t.type;if(o){for(var n=0,r=A.call(this,e),i=0;i<r.length;i++)(t=L.call(this,r[i]))&&l(t.type)&&n++;n>1&&(o="general")}return o},M=function(){"function"==typeof E[this.methods[this.index]]?(E[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},k=(r=function(e){return"="==(""+e)[0]},function(e){return(""+ +e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,(function(a,b,e,t,o){return o<0?b+"0."+Array(1-o-e.length).join(0)+e+t:b+e+t+Array(o-t.length+1).join(0)}))}),D=function(t,n,d){var x=null,w={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof t){if(w.input=t.target,w.value=v.call(t.target),w.caret=j.call(t.target),(x=t.target.getAttribute("data-mask"))&&(w.mask=x),(x=t.target.getAttribute("data-type"))&&(w.type=x),t.target.mask?(t.target.mask.options&&(w.options=t.target.mask.options),t.target.mask.locale&&(w.locale=t.target.mask.locale)):(x=t.target.getAttribute("data-locale"))&&(w.locale=x,w.mask&&(w.options.style=w.mask)),t.target.attributes&&t.target.attributes.length)for(var i=0;i<t.target.attributes.length;i++){var y=t.target.attributes[i].name,C=t.target.attributes[i].value;"data"==y.substr(0,4)&&(w.options[y.substr(5)]=C)}}else{if("string"==typeof n)w.mask=n;else for(y=Object.keys(n),i=0;i<y.length;i++)w[y[i]]=n[y[i]];"number"==typeof t&&(c.call(w,w.mask),t=(""+t).replace(".",w.options.decimal)),w.value=t,w.input&&(v.call(w.input,t),e.focus(w.input),w.caret=j.call(w.input))}if(!r(w.value)&&(w.mask||w.locale)){if(w.mask){if(w.mask=w.mask.replace("[-]",""),-1!==w.mask.indexOf("##")){var E=w.mask.split(";");E[0]&&(E[0]=E[0].replace("*",""),E[0]=E[0].replace(/_/g,""),E[0]=E[0].replace(/-/g,""),E[0]=E[0].replace("(",""),E[0]=E[0].replace(")",""),E[0]=E[0].replace("##0.###","##0.000"),E[0]=E[0].replace("##0.##","##0.00"),E[0]=E[0].replace("##0.#","##0.0")),w.mask=E[0]}w.type||(w.type=N.call(w,w.mask)),w.tokens=A.call(w,w.mask)}if("object"!=typeof t||!t.inputType||"insertText"==t.inputType||"insertFromPaste"==t.inputType)if(w.locale)if(w.input)h.call(w,w.input);else var k=f.call(w,w.value);else{for(w.methods=I.call(w,w.tokens);w.position<w.value.length&&void 0!==w.tokens[w.index];)M.call(w);if(l(w.type)){for(;void 0!==w.tokens[w.index];)(x=L.call(w,w.tokens[w.index]))&&"general"==x.type&&(w.values[w.index]=w.tokens[w.index]),w.index++;var D=!0}else D=!1;if(k=w.values.join(""),w.input){if((x=k.length-w.value.length)>0)var T=w.caret+x;else T=w.caret;v.call(w.input,k,T,D)}}if(w.input){var label=null;l(w.type)?(w.number=m.call(w,v.call(w.input)),label="percentage"==w.type?w.number/100:w.number):"datetime"==w.type&&(label=o.call(w),w.date[0]&&w.date[1]&&w.date[2]&&w.input.setAttribute("data-completed",!0)),label&&w.input.setAttribute("data-value",label)}if(void 0!==k)return d?w:k}};return D.prepare=function(e,t){return t||(t={}),A.call(t,e)},D.apply=function(e){var t=v.call(e.target);1==e.key.length&&(t+=e.key),v.call(e.target,D(t,e.target.getAttribute("data-mask")))},D.run=function(e,mask,t){return D(e,{mask:mask,decimal:t})},D.extract=function(t,r,l){if(n(t))return t;if("object"!=typeof r)return j;r.options||(r.options={}),!r.mask&&r.format&&(r.mask=r.format),c.call(r,r.mask);var d=null;if("percent"==r.type||"percent"==r.options.style?d="percentage":r.mask&&(d=N.call(r,r.mask)),"datetime"===d){if(t instanceof Date)var f=e.calendar.getDateString(j,r.mask);var h=D(t,r,!0),j=o.call(h);h.date[0]&&h.date[1]&&h.date[2]&&!(h.date[3]||h.date[4]||h.date[5])&&(f=e.calendar.now(h.date),j=e.calendar.dateToNum(f))}else j=m.call(r,t),"percentage"==d&&(j/=100),h=r;return h.value=j,l?h:j},D.render=function(t,o,r){if(n(t))return t;if("object"!=typeof o)return t;o.options||(o.options={}),!o.mask&&o.format&&(o.mask=o.format);var l=null;"percent"==o.type||"percent"==o.options.style?l="percentage":o.mask?l=N.call(o,o.mask):t instanceof Date&&(l="datetime");var d=!1;if("datetime"==l||"calendar"==o.type)(f=e.calendar.getDateString(t,o.mask))&&(t=f),o.mask&&r&&(d=!0);else if("percentage"==l&&(t*=100),"number"==typeof t){var f=null;if(o.mask&&r){var h=new RegExp("0{1}(.{1})0+","ig");(m=o.mask.match(h))&&m[0]?(m=m[0].length-2,f=t.toFixed(m)):f=""+t}else if(o.locale&&r){var m;(m=(""+t).split("."))[1]?1==m[1].length&&(m[1]+="0"):m[1]="00",f=m.join(".")}else f=k(t);null!==f&&(t=f,c.call(o,o.mask),o.options.decimal&&(t=t.replace(".",o.options.decimal)))}else o.mask&&r&&(d=!0);if(d){var s=o.mask.length-t.length;if(s>0)for(var i=0;i<s;i++)t+=" "}return t=D(t,o)},D.set=function(e,t){if(t){e.setAttribute("data-mask",t);var o=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(o)}},"undefined"!=typeof document&&document.addEventListener("input",(function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&D(e)})),D}(),e.modal=function(t,o){var n={options:{}},r={url:null,onopen:null,onclose:null,closed:!1,width:null,height:null,title:null,padding:null};for(var l in r)o&&o.hasOwnProperty(l)?n.options[l]=o[l]:n.options[l]=r[l];!n.options.title&&t.getAttribute("title")&&(n.options.title=t.getAttribute("title"));for(var c=document.createElement("div");t.children[0];)c.appendChild(t.children[0]);for(n.content=document.createElement("div"),n.content.className="jmodal_content",n.content.innerHTML=t.innerHTML;c.children[0];)n.content.appendChild(c.children[0]);n.container=document.createElement("div"),n.container.className="jmodal",n.container.appendChild(n.content),n.options.padding&&(n.content.style.padding=n.options.padding),n.options.width&&(n.container.style.width=n.options.width),n.options.height&&(n.container.style.height=n.options.height),n.options.title?n.container.setAttribute("title",n.options.title):n.container.classList.add("no-title"),t.innerHTML="",t.style.display="none",t.appendChild(n.container);var d=document.createElement("div");return d.className="jmodal_backdrop",d.onclick=function(){n.close()},t.appendChild(d),n.open=function(){t.style.display="block";var rect=n.container.getBoundingClientRect();e.getWindowWidth()<rect.width?(n.container.style.top="",n.container.style.left="",n.container.classList.add("jmodal_fullscreen"),e.animation.slideBottom(n.container,1)):d.style.display="block",e.modal.current=n,"function"==typeof n.options.onopen&&n.options.onopen(t,n)},n.resetPosition=function(){n.container.style.top="",n.container.style.left=""},n.isOpen=function(){return"none"!=t.style.display},n.close=function(){t.style.display="none",d.style.display="",e.modal.current=null,n.container.classList.remove("jmodal_fullscreen"),"function"==typeof n.options.onclose&&n.options.onclose(t,n)},e.modal.hasEvents||(e.modal.current=n,"ontouchstart"in document.documentElement==1?document.addEventListener("touchstart",e.modal.mouseDownControls):(document.addEventListener("mousedown",e.modal.mouseDownControls),document.addEventListener("mousemove",e.modal.mouseMoveControls),document.addEventListener("mouseup",e.modal.mouseUpControls)),document.addEventListener("keydown",e.modal.keyDownControls),e.modal.hasEvents=!0),n.options.url?e.ajax({url:n.options.url,method:"GET",dataType:"text/html",success:function(data){n.content.innerHTML=data,n.options.closed||n.open()}}):n.options.closed||n.open(),t.modal=n,n},e.modal.current=null,e.modal.position=null,e.modal.keyDownControls=function(t){27==t.which&&e.modal.current&&e.modal.current.close()},e.modal.mouseUpControls=function(t){e.modal.current&&(e.modal.current.container.style.cursor="auto"),e.modal.position=null},e.modal.mouseMoveControls=function(t){if(e.modal.current&&e.modal.position)if(1==t.which||3==t.which){var o=e.modal.position;e.modal.current.container.style.top=o[1]+(t.clientY-o[3])+o[5]/2+"px",e.modal.current.container.style.left=o[0]+(t.clientX-o[2])+o[4]/2+"px",e.modal.current.container.style.cursor="move"}else e.modal.current.container.style.cursor="auto"},e.modal.mouseDownControls=function(t){e.modal.position=[],t.target.classList.contains("jmodal")&&setTimeout((function(){var rect=t.target.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var o=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY;else o=t.clientX,n=t.clientY;rect.width-(o-rect.left)<50&&n-rect.top<50?setTimeout((function(){e.modal.current.close()}),100):t.target.getAttribute("title")&&n-rect.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),e.modal.position=[rect.left,rect.top,t.clientX,t.clientY,rect.width,rect.height])}),100)},e.notification=function(t){var o={options:{}},n={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var r in n)t&&t.hasOwnProperty(r)?o.options[r]=t[r]:o.options[r]=n[r];var l=document.createElement("div");l.className="jnotification",o.options.error&&l.classList.add("jnotification-error");var c=document.createElement("div");c.className="jnotification-container",l.appendChild(c);var d=document.createElement("div");d.className="jnotification-header",c.appendChild(d);var f=document.createElement("div");if(f.className="jnotification-image",d.appendChild(f),o.options.icon){var h=document.createElement("img");h.src=o.options.icon,f.appendChild(h)}var m=document.createElement("div");if(m.className="jnotification-name",m.innerHTML=o.options.name,d.appendChild(m),1==o.options.closeable){var j=document.createElement("div");j.className="jnotification-close",j.onclick=function(){o.hide()},d.appendChild(j)}var v=document.createElement("div");v.className="jnotification-date",d.appendChild(v);var x=document.createElement("div");if(x.className="jnotification-content",c.appendChild(x),o.options.title){var w=document.createElement("div");w.className="jnotification-title",w.innerHTML=o.options.title,x.appendChild(w)}var y=document.createElement("div");if(y.className="jnotification-message",y.innerHTML=o.options.message,x.appendChild(y),o.show=function(){document.body.appendChild(l),e.getWindowWidth()>800?e.animation.fadeIn(l):e.animation.slideTop(l,1)},o.hide=function(){e.getWindowWidth()>800?e.animation.fadeOut(l,(function(){l.parentNode&&(l.parentNode.removeChild(l),C&&clearTimeout(C))})):e.animation.slideTop(l,0,(function(){l.parentNode&&(l.parentNode.removeChild(l),C&&clearTimeout(C))}))},o.show(),1==o.options.autoHide)var C=setTimeout((function(){o.hide()}),o.options.timeout);return e.getWindowWidth()<800&&l.addEventListener("swipeup",(function(e){o.hide(),e.preventDefault(),e.stopPropagation()})),o},e.notification.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e.palette=function(e){var t={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]]};return t[e]?t[e]:t.material},e.picker=function(t,o){if(t.picker)return t.picker.setOptions(o,!0);var n={type:"picker",options:{}},r=null,l=null,c=function(){l.innerHTML="";for(var e=Object.keys(n.options.data),i=0;i<e.length;i++){var t=document.createElement("div");t.classList.add("jpicker-item"),t.k=e[i],t.v=n.options.data[e[i]],t.innerHTML=n.getLabel(e[i]),l.appendChild(t)}};return n.setOptions=function(e,t){var o={value:0,data:null,render:null,onchange:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,content:!1,columns:null,height:null};for(var d in e&&e.options&&(e.data=e.options),o)e&&e.hasOwnProperty(d)?n.options[d]=e[d]:void 0!==n.options[d]&&!0!==t||(n.options[d]=o[d]);return!1===n.options.header?r.style.display="none":r.style.display="",n.options.width?r.style.width=parseInt(n.options.width)+"px":r.style.width="",n.options.height?(l.style.maxHeight=n.options.height+"px",l.style.overflow="scroll"):l.style.overflow="",n.options.columns>0&&(l.classList.add("jpicker-columns"),l.style.width=n.options.width?n.options.width:36*n.options.columns+"px"),isNaN(n.options.value)&&(n.options.value="0"),c(),n.setValue(n.options.value),n},n.getValue=function(){return n.options.value},n.setValue=function(e){n.setLabel(e),n.options.value=String(e),t.value!=n.options.value&&(t.value=n.options.value,"function"==typeof t.onchange&&t.onchange({type:"change",target:t,value:t.value})),"generic"!==l.children[e].getAttribute("type")&&n.close()},n.getLabel=function(e){var label=n.options.data[e]||null;return"function"==typeof n.options.render&&(label=n.options.render(label)),label},n.setLabel=function(e){if(n.options.content)var label='<i class="material-icons">'+n.options.content+"</i>";else label=n.getLabel(e);r.innerHTML=label},n.open=function(){if(!t.classList.contains("jpicker-focus")){e.tracking(n,!0),t.classList.add("jpicker-focus"),t.focus();var o=r.getBoundingClientRect(),c=l.getBoundingClientRect();window.innerHeight<o.bottom+c.height?l.style.marginTop=-1*(c.height+4)+"px":l.style.marginTop=o.height+2+"px",!0===n.options.right&&(l.style.marginLeft=-1*c.width+24+"px"),"function"==typeof n.options.onopen&&n.options.onopen(t,n)}},n.close=function(){t.classList.contains("jpicker-focus")&&(t.classList.remove("jpicker-focus"),e.tracking(n,!1),"function"==typeof n.options.onclose&&n.options.onclose(t,n))},t.classList.add("jpicker"),t.setAttribute("tabindex","900"),t.onmousedown=function(e){t.classList.contains("jpicker-focus")||n.open()},(r=document.createElement("div")).classList.add("jpicker-header"),(l=document.createElement("div")).classList.add("jpicker-content"),l.onclick=function(o){var r=e.findElement(o.target,"jpicker-item");r&&r.parentNode===l&&(n.setValue(r.k),"function"==typeof n.options.onchange&&n.options.onchange.call(n,t,n,r.v,r.v,r.k))},t.appendChild(r),t.appendChild(l),t.value=o.value||0,n.setOptions(o),"function"==typeof n.options.onload&&n.options.onload(t,n),t.change=n.setValue,t.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},t.picker=n,n},e.progressbar=function(e,t){var o={options:{}},n={value:0,onchange:null,width:null};for(var r in n)t&&t.hasOwnProperty(r)?o.options[r]=t[r]:o.options[r]=n[r];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",o.options.value);var l=document.createElement("div");l.style.width=o.options.value+"%",l.style.color="#fff",e.appendChild(l),o.options.width&&(e.style.width=o.options.width),o.setValue=function(t){t=parseInt(t),o.options.value=t,l.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=t<6?"#000":"#fff",o.options.value=t,"function"==typeof o.options.onchange&&o.options.onchange(e,t),e.value!=o.options.value&&(e.value=o.options.value,"function"==typeof e.onchange&&e.onchange({type:"change",target:e,value:e.value}))},o.getValue=function(){return o.options.value};var c=function(t){if(t.which){var rect=e.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var n=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else n=t.clientX,t.clientY;o.setValue(Math.round((n-rect.left)/rect.width*100))}};return"touchstart"in document.documentElement==1?(e.addEventListener("touchstart",c),e.addEventListener("touchend",c)):(e.addEventListener("mousedown",c),e.addEventListener("mousemove",c)),e.change=o.setValue,e.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},e.progressbar=o,o},e.rating=function(e,t){if(e.rating)return e.rating.setOptions(t,!0);var o={options:{},setOptions:function(t,n){var r={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var l in r)t&&t.hasOwnProperty(l)?o.options[l]=t[l]:void 0!==o.options[l]&&!0!==n||(o.options[l]=r[l]);e.innerHTML="";for(var i=0;i<o.options.number;i++){var div=document.createElement("div");div.setAttribute("data-index",i+1),div.setAttribute("title",o.options.tooltip[i]),e.appendChild(div)}if(o.options.value)for(i=0;i<o.options.number;i++)i<o.options.value&&e.children[i].classList.add("jrating-selected");return o},setValue:function(t){for(var i=0;i<o.options.number;i++)i<t?e.children[i].classList.add("jrating-selected"):(e.children[i].classList.remove("jrating-over"),e.children[i].classList.remove("jrating-selected"));o.options.value=t,"function"==typeof o.options.onchange&&o.options.onchange(e,t),e.value!=o.options.value&&(e.value=o.options.value,"function"==typeof e.onchange&&e.onchange({type:"change",target:e,value:e.value}))},getValue:function(){return o.options.value}};return o.setOptions(t),e.classList.add("jrating"),e.addEventListener("click",(function(e){var t=e.target.getAttribute("data-index");null!=t&&(t==o.options.value?o.setValue(0):o.setValue(t))})),e.addEventListener("mouseover",(function(t){for(var n=t.target.getAttribute("data-index"),i=0;i<o.options.number;i++)i<n?e.children[i].classList.add("jrating-over"):e.children[i].classList.remove("jrating-over")})),e.addEventListener("mouseout",(function(t){for(var i=0;i<o.options.number;i++)e.children[i].classList.remove("jrating-over")})),e.change=o.setValue,e.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},e.rating=o,o},e.search=function(t,o){if(t.search)return t.search;var n=null,select=function(e){if(e.target.classList.contains("jsearch_item"))var element=e.target;else element=e.target.parentNode;d.selectIndex(element),e.preventDefault()},r=function(data){if(f.innerHTML="",data.length){t.style.display="block";for(var e=data.length<11?data.length:10,i=0;i<e;i++){if("string"==typeof data[i])var text=data[i],o=data[i];else!(text=data[i].text)&&data[i].name&&(text=data[i].name),!(o=data[i].value)&&data[i].id&&(o=data[i].id);var div=document.createElement("div");div.setAttribute("data-value",o),div.setAttribute("data-text",text),div.className="jsearch_item",data[i].id&&div.setAttribute("id",data[i].id),d.options.forceSelect&&0==i&&div.classList.add("selected");var img=document.createElement("img");data[i].image?img.src=data[i].image:img.style.display="none",div.appendChild(img);var n=document.createElement("div");n.innerHTML=text,div.appendChild(n),f.appendChild(div)}}else t.style.display=""},l=function(t){if(t!=d.terms)if(d.terms=t,n=d.options.forceSelect?0:null,Array.isArray(d.options.data)){var o=function(e){if("string"==typeof e){if((""+e).toLowerCase().search(t.toLowerCase())>=0)return!0}else for(var o in e)if((""+e[o]).toLowerCase().search(t.toLowerCase())>=0)return!0;return!1},l=d.options.data.filter((function(e){return o(e)}));r(l)}else e.ajax({url:d.options.data+t,method:"GET",dataType:"json",success:function(data){r(data)}})},c=null,d=function(e){c&&clearTimeout(c),c=setTimeout((function(){l(e)}),500)};null===o.forceSelect&&(o.forceSelect=!0),d.options={data:o.data||null,input:o.input||null,onselect:o.onselect||null,forceSelect:o.forceSelect},d.selectIndex=function(e){var t=e.getAttribute("id"),text=e.getAttribute("data-text"),o=e.getAttribute("data-value");"function"==typeof d.options.onselect&&d.options.onselect(d,text,o,t),d.close()},d.open=function(){t.style.display="block"},d.close=function(){c&&clearTimeout(c),d.terms="",f.innerHTML="",t.style.display=""},d.isOpened=function(){return!!t.style.display},d.keydown=function(e){d.isOpened()&&("Enter"==e.key?null!==n&&f.children[n]?(d.selectIndex(f.children[n]),e.preventDefault()):d.close():"ArrowUp"===e.key?(null!==n&&f.children[0]&&(f.children[n].classList.remove("selected"),d.options.forceSelect||0!==n?(n=Math.max(0,n-1),f.children[n].classList.add("selected")):n=null),e.preventDefault()):"ArrowDown"===e.key&&(null==n?n=-1:f.children[n].classList.remove("selected"),n<9&&f.children[n+1]&&n++,f.children[n].classList.add("selected"),e.preventDefault()))},d.keyup=function(t){if(d.options.input)d(d.options.input.value);else{var o=e.getNode();o&&d(o.innerText)}},d.options.input&&(d.options.input.addEventListener("keyup",d.keyup),d.options.input.addEventListener("keydown",d.keydown));var f=document.createElement("div");return f.classList.add("jsearch_container"),f.onmousedown=select,t.appendChild(f),t.classList.add("jsearch"),t.search=d,d},e.slider=function(e,t){var o={options:{},currentImage:null};if(t&&(o.options=t),e.setAttribute("tabindex","900"),o.options.items=[],!e.classList.contains("jslider")){if(e.classList.add("jslider"),e.classList.add("unselectable"),o.options.height&&(e.style.minHeight=o.options.height),o.options.width&&(e.style.width=o.options.width),o.options.grid){e.classList.add("jslider-grid");var n=e.children.length;n>4&&e.setAttribute("data-total",n-4),e.setAttribute("data-number",n>4?4:n)}var r=document.createElement("div");if(r.classList.add("jslider-counter"),e.children.length>0)for(var i=0;i<e.children.length;i++){o.options.items.push(e.children[i]);var l=document.createElement("div");l.onclick=function(){var e=Array.prototype.slice.call(r.children).indexOf(this);o.show(o.currentImage=o.options.items[e])},r.appendChild(l)}var caption=document.createElement("div");caption.className="jslider-caption";var c=document.createElement("div"),d=document.createElement("div");d.className="jslider-close",d.innerHTML="",d.onclick=function(){o.close()},c.appendChild(caption),c.appendChild(d)}o.updateCounter=function(e){for(var i=0;i<r.children.length;i++)if(r.children[i].classList.contains("jslider-counter-focus")){r.children[i].classList.remove("jslider-counter-focus");break}r.children[e].classList.add("jslider-counter-focus")},o.show=function(t){t||(t=e.children[0]),e.classList.add("jslider-focus"),e.classList.remove("jslider-grid"),e.appendChild(c),e.appendChild(r);var n=o.options.items.indexOf(t);o.updateCounter(n);for(var i=0;i<e.children.length;i++)e.children[i].style.display="";t.style.display="block",t.previousElementSibling?e.classList.add("jslider-left"):e.classList.remove("jslider-left"),t.nextElementSibling&&"IMG"==t.nextElementSibling.tagName?e.classList.add("jslider-right"):e.classList.remove("jslider-right"),o.currentImage=t,o.currentImage.offsetHeight>o.currentImage.offsetWidth&&o.currentImage.classList.add("jslider-vertical"),c.children[0].innerText=o.currentImage.getAttribute("title")},o.open=function(){o.show(),"function"==typeof o.options.onopen&&o.options.onopen(e)},o.close=function(){e.classList.remove("jslider-focus"),e.classList.remove("jslider-left"),e.classList.remove("jslider-right"),o.options.grid&&e.classList.add("jslider-grid");for(var i=0;i<e.children.length;i++)e.children[i].style.display="";r.remove(),c.remove(),o.currentImage=null,"function"==typeof o.options.onclose&&o.options.onclose(e)},o.reset=function(){e.innerHTML=""},o.next=function(){var e=o.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&o.show(o.currentImage.nextElementSibling)},o.prev=function(){o.currentImage.previousElementSibling&&o.show(o.currentImage.previousElementSibling)};var f=function(e){if("IMG"==e.target.tagName)o.show(e.target);else if(!e.target.classList.contains("jslider-close")&&!e.target.parentNode.classList.contains("jslider-counter")&&!e.target.classList.contains("jslider-counter")){var t=e.offsetX||e.changedTouches[0].clientX;e.target.clientWidth-t<40?o.next():t<40&&o.prev()}};return"ontouchend"in document.documentElement==1?e.addEventListener("touchend",f):e.addEventListener("mouseup",f),e.addEventListener("swipeleft",(function(e){o.next(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("swiperight",(function(e){o.prev(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("keydown",(function(e){27==e.which&&o.close()})),e.slider=o,o},e.sorting=function(e,t){var o={options:{}},n={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},r=null;for(var l in n)t&&t.hasOwnProperty(l)?o.options[l]=t[l]:o.options[l]=n[l];e.classList.add("jsorting"),e.addEventListener("dragstart",(function(t){var n=Array.prototype.indexOf.call(t.target.parentNode.children,t.target);r={element:t.target,o:n,d:n},t.target.style.opacity="0.25","function"==typeof o.options.ondragstart&&o.options.ondragstart(e,t.target,t)})),e.addEventListener("dragover",(function(e){if(e.preventDefault(),c(e.target)&&r&&"true"==e.target.getAttribute("draggable")&&r.element!=e.target){if(o.options.direction)t=e.target.clientWidth/2>e.offsetX;else var t=e.target.clientHeight/2>e.offsetY;t?e.target.parentNode.insertBefore(r.element,e.target):e.target.parentNode.insertBefore(r.element,e.target.nextSibling),r.d=Array.prototype.indexOf.call(e.target.parentNode.children,r.element)}})),e.addEventListener("dragleave",(function(e){e.preventDefault()})),e.addEventListener("dragend",(function(t){t.preventDefault(),r&&("function"==typeof o.options.ondragend&&o.options.ondragend(e,r.element,t),r.o<r.d?t.target.parentNode.insertBefore(r.element,t.target.parentNode.children[r.o]):t.target.parentNode.insertBefore(r.element,t.target.parentNode.children[r.o].nextSibling),r.element.style.opacity="",r=null)})),e.addEventListener("drop",(function(t){t.preventDefault(),r&&r.o!=r.d&&"function"==typeof o.options.ondrop&&o.options.ondrop(e,r.o,r.d,r.element,t.target,t),r.element.style.opacity="",r=null}));for(var c=function(element){var e=!1;function path(element){element.className&&element.classList.contains("jsorting")&&(e=!0),e||path(element.parentNode)}return path(element),e},i=0;i<e.children.length;i++)e.children[i].hasAttribute("draggable")||e.children[i].setAttribute("draggable","true");return e.val=function(){for(var t=null,data=[],i=0;i<e.children.length;i++)(t=e.children[i].getAttribute("data-id"))&&data.push(t);return data},e},e.tabs=function(t,o){var n={options:{}},r={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var l in r)o&&o.hasOwnProperty(l)?n.options[l]=o[l]:n.options[l]=r[l];t.classList.add("jtabs");var c=null,d=null,f=null,h=function(e){if(n.options.animation){var rect=n.headers.children[e].getBoundingClientRect();"modern"==n.options.palette?(f.style.width=rect.width-4+"px",f.style.left=n.headers.children[e].offsetLeft+2+"px"):(f.style.width=rect.width+"px",f.style.left=n.headers.children[e].offsetLeft+"px"),"bottom"==n.options.position?f.style.top="0px":f.style.bottom="0px"}},m=function(e){"function"==typeof n.headers.scrollTo?n.headers.scrollTo({left:e,behavior:"smooth"}):n.headers.scrollLeft=e,e<=1?c.classList.add("disabled"):c.classList.remove("disabled"),e>=n.headers.scrollWidth-n.headers.offsetWidth?d.classList.add("disabled"):d.classList.remove("disabled"),n.headers.scrollWidth<=n.headers.offsetWidth?(c.style.display="none",d.style.display="none"):(c.style.display="",d.style.display="")};if(n.setBorder=h,n.open=function(e){for(var o=null,i=0;i<n.headers.children.length;i++)n.headers.children[i].classList.contains("jtabs-selected")&&(o=i),n.headers.children[i].classList.remove("jtabs-selected"),n.content.children[i]&&n.content.children[i].classList.remove("jtabs-selected");if(n.headers.children[e].classList.add("jtabs-selected"),n.content.children[e]&&n.content.children[e].classList.add("jtabs-selected"),o!=e&&"function"==typeof n.options.onchange&&n.content.children[e]&&n.options.onchange(t,n,e,n.headers.children[e],n.content.children[e]),1==n.options.hideHeaders&&n.headers.children.length<3&&0==n.options.allowCreate)n.headers.parentNode.style.display="none";else{h(e),n.headers.parentNode.style.display="";var r=n.headers.children[e].offsetLeft,l=r+n.headers.children[e].offsetWidth,c=n.headers.scrollLeft,d=c+n.headers.offsetWidth;c<=r&&d>=l||m(r-1)}},n.selectIndex=function(a){var e=Array.prototype.indexOf.call(n.headers.children,a);return e>=0&&n.open(e),e},n.rename=function(i,title){title||(title=prompt("New title",n.headers.children[i].innerText)),n.headers.children[i].innerText=title,n.open(i)},n.create=function(title,e){if("function"==typeof n.options.onbeforecreate){var o=n.options.onbeforecreate(t);if(!1===o)return!1;title=o}var div=n.appendElement(title);return"function"==typeof n.options.oncreate&&n.options.oncreate(t,div),div},n.remove=function(e){return n.deleteElement(e)},n.nextNumber=function(){for(var e=0,i=0;i<n.headers.children.length;i++){var t=n.headers.children[i].innerText.match(/[0-9].*/);t>e&&(e=parseInt(t))}return e?e++:e=1,e},n.deleteElement=function(e){if(!n.headers.children[e])return!1;n.headers.removeChild(n.headers.children[e]),n.content.removeChild(n.content.children[e]),n.open(0),"function"==typeof n.options.ondelete&&n.options.ondelete(t,e)},n.appendElement=function(title,e){if(title||(title=prompt("Title?","")),title){var div=document.createElement("div");n.content.appendChild(div);var t=document.createElement("div");return t.innerHTML=title,t.content=div,n.headers.insertBefore(t,n.headers.lastChild),n.options.allowChangePosition&&t.setAttribute("draggable","true"),n.selectIndex(t),"function"==typeof e&&e(div,t),div}},n.getActive=function(){for(var i=0;i<n.headers.children.length;i++)if(n.headers.children[i].classList.contains("jtabs-selected"))return i;return 0},n.updateContent=function(e,t){"string"!=typeof t||(document.createElement("div").innerHTML=t),n.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),n.content.replaceChild(t,n.content.children[e])},n.updatePosition=function(e,t){e>t?n.content.insertBefore(n.content.children[e],n.content.children[t]):n.content.insertBefore(n.content.children[e],n.content.children[t].nextSibling),n.open(t),"function"==typeof n.options.onchangeposition&&n.options.onchangeposition(n.headers,e,t)},n.move=function(e,t){e>t?n.headers.insertBefore(n.headers.children[e],n.headers.children[t]):n.headers.insertBefore(n.headers.children[e],n.headers.children[t].nextSibling),n.updatePosition(e,t)},n.setBorder=h,n.init=function(){t.innerHTML="",n.headers=document.createElement("div"),n.content=document.createElement("div"),n.headers.classList.add("jtabs-headers"),n.content.classList.add("jtabs-content"),n.options.palette?t.classList.add("jtabs-modern"):t.classList.remove("jtabs-modern"),n.options.padding&&(n.content.style.padding=parseInt(n.options.padding)+"px");var header=document.createElement("div");header.className="jtabs-headers-container",header.appendChild(n.headers),n.options.maxWidth&&(header.style.maxWidth=parseInt(n.options.maxWidth)+"px");var o=document.createElement("div");if(o.className="jtabs-controls",o.setAttribute("draggable","false"),header.appendChild(o),"bottom"==n.options.position?(t.appendChild(n.content),t.appendChild(header)):(t.appendChild(header),t.appendChild(n.content)),1==n.options.allowCreate){var r=document.createElement("div");r.className="jtabs-add",r.onclick=function(){n.create()},o.appendChild(r)}(c=document.createElement("div")).className="jtabs-prev",c.onclick=function(){m(n.headers.scrollLeft-n.headers.offsetWidth)},o.appendChild(c),(d=document.createElement("div")).className="jtabs-next",d.onclick=function(){m(n.headers.scrollLeft+n.headers.offsetWidth)},o.appendChild(d);for(var i=0;i<n.options.data.length;i++){if(n.options.data[i].titleElement)var l=n.options.data[i].titleElement;else l=document.createElement("div");if(n.options.data[i].icon){var h=document.createElement("div"),j=document.createElement("i");j.classList.add("material-icons"),j.innerHTML=n.options.data[i].icon,h.appendChild(j),l.appendChild(h)}if(n.options.data[i].title){var title=document.createTextNode(n.options.data[i].title);l.appendChild(title)}if(n.options.data[i].width&&(l.style.width=n.options.data[i].width),n.options.data[i].contentElement)var v=n.options.data[i].contentElement;else(v=document.createElement("div")).innerHTML=n.options.data[i].content;n.headers.appendChild(l),n.content.appendChild(v)}(f=document.createElement("div")).className="jtabs-border",n.headers.appendChild(f),n.options.animation&&t.classList.add("jtabs-animation"),n.headers.addEventListener("click",(function(e){if(e.target.parentNode.classList.contains("jtabs-headers"))var o=e.target;else o="I"==e.target.tagName?e.target.parentNode.parentNode:e.target.parentNode;var r=n.selectIndex(o);"function"==typeof n.options.onclick&&n.options.onclick(t,n,r,n.headers.children[r],n.content.children[r])})),n.headers.addEventListener("contextmenu",(function(e){n.selectIndex(e.target)})),n.headers.children.length&&n.open(0),m(0),1==n.options.allowChangePosition&&e.sorting(n.headers,{direction:1,ondrop:function(a,b,e){n.updatePosition(b,e)}}),"function"==typeof n.options.onload&&n.options.onload(t,n)},t.children[0]&&t.children[0].children.length)for(var i=0;i<t.children[0].children.length;i++){var j=n.options.data&&n.options.data[i]?n.options.data[i]:{};t.children[1]&&t.children[1].children[i]?(j.titleElement=t.children[0].children[i],j.contentElement=t.children[1].children[i]):j.contentElement=t.children[0].children[i],n.options.data[i]=j}var v=!1;if(n.options.data)for(i=0;i<n.options.data.length;i++)n.options.data[i].url&&(e.ajax({url:n.options.data[i].url,type:"GET",dataType:"text/html",index:i,success:function(e){n.options.data[this.index].content=e},complete:function(){n.init()}}),v=!0);return v||n.init(),t.tabs=n,n},e.tags=function(t,o){if(t.tags)return t.tags.setOptions(o,!0);var n={type:"tags",options:{}},r=function(){return!!(n.options.limit&&t.children.length>=n.options.limit)},l=null,c=null;n.setOptions=function(o,r){var d={value:"",limit:null,limitMessage:null,search:null,placeholder:null,validation:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null,colors:null};for(var f in d)o&&o.hasOwnProperty(f)?n.options[f]=o[f]:void 0!==n.options[f]&&!0!==r||(n.options[f]=d[f]);return n.options.placeholder?t.setAttribute("data-placeholder",n.options.placeholder):t.removeAttribute("data-placeholder"),t.placeholder=n.options.placeholder,n.setValue(n.options.value),filter(),n.options.search?c||(c=document.createElement("div"),t.parentNode.insertBefore(c,t.nextSibling),l=e.search(c,{data:n.options.search,onselect:function(a,b,e){n.selectIndex(b,e)}})):c&&(l=null,c.remove(),c=null),n},n.add=function(o,c){if("function"==typeof n.options.onbeforechange){var m=n.options.onbeforechange(t,n,n.options.value,o);if(!1===m)return!1;null!=m&&(o=m)}if(l&&l.close(),r())"function"==typeof n.options.onlimit?n.options.onlimit(n,n.options.limit):n.options.limitMessage&&alert(n.options.limitMessage+" "+n.options.limit);else{var j=e.getNode();if(!(j&&j.parentNode&&j.parentNode.classList.contains("jtags")&&j.nextSibling)||j.nextSibling.innerText&&j.nextSibling.innerText.trim()){if(t.lastChild&&(t.lastChild.innerText.trim()||t.removeChild(t.lastChild)),o&&"string"!=typeof o){for(var i=0;i<=o.length;i++)if(!r()){if(o[i]&&"string"!=typeof o[i])v=o[i].text,x=o[i].value;else var v=o[i]||"",x=null;div=f(v,x)}}else var div=f(o,o,j);h()}else div=j.nextSibling;c&&d(div)}},n.setLimit=function(e){for(n.options.limit=e,t.children.length;t.children.length>e;)t.removeChild(t.lastChild)},n.remove=function(e){e.parentNode.removeChild(e),t.children.length?h():n.add("",!0)},n.getData=function(){for(var data=[],i=0;i<t.children.length;i++){var text=t.children[i].innerText.replace("\n",""),e=t.children[i].getAttribute("data-value");e||(e=text),(text||e)&&data.push({text:text,value:e})}return data},n.getValue=function(e){var o=null;if(null!=e)(o=t.children[e].getAttribute("data-value"))||(o=t.children[e].innerText.replace("\n",""));else{for(var data=[],i=0;i<t.children.length;i++)(o=t.children[i].innerText.replace("\n",""))&&data.push(n.getValue(i));o=data.join(",")}return o},n.setValue=function(e){if(e){if(t.value!=e)if(Array.isArray(e))n.add(e);else{var text=(""+e).trim(),data=j(text);t.innerHTML="",n.add(data)}}else n.reset()},n.reset=function(){t.classList.add("jtags-empty"),t.innerHTML="<div></div>",h()},n.isValid=function(){for(var e=0,i=0;i<t.children.length;i++)t.children[i].classList.contains("jtags_error")&&e++;return 0==e},n.selectIndex=function(text,t){var o=e.getNode();o&&(o.innerText=text,t&&o.setAttribute("data-value",t),o.classList.remove("jtags_error"),r()||n.add("",!0))},n.search=function(e){e.innerText},n.destroy=function(){t.removeEventListener("mouseup",C),t.removeEventListener("keydown",x),t.removeEventListener("keyup",w),t.removeEventListener("paste",y),t.removeEventListener("focus",E),t.removeEventListener("blur",A),t.parentNode.removeChild(t)};var d=function(e){if(t.children.length>1){var o=document.createRange(),n=window.getSelection();e||(e=t.childNodes[t.childNodes.length-1]),o.setStart(e,e.length),o.collapse(!0),n.removeAllRanges(),n.addRange(o),t.scrollLeft=t.scrollWidth}},f=function(label,e,o){var div=document.createElement("div");return div.innerHTML=label||"",e&&div.setAttribute("data-value",e),o&&o.parentNode.classList.contains("jtags")?t.insertBefore(div,o.nextSibling):t.appendChild(div),div},h=function(){var e=n.getValue();e!=n.options.value&&(n.options.value=e,"function"==typeof n.options.onchange&&n.options.onchange(t,n,n.options.value),t.value!=n.options.value&&(t.value=n.options.value,"function"==typeof t.onchange&&t.onchange({type:"change",target:t,value:t.value}))),filter()},filter=function(){for(var i=0;i<t.children.length;i++)n.getValue(i)?(t.children[i].classList.add("jtags_label"),"function"==typeof n.options.validation&&n.getValue(i)?n.options.validation(t.children[i],t.children[i].innerText,t.children[i].getAttribute("data-value"))?t.children[i].classList.remove("jtags_error"):t.children[i].classList.add("jtags_error"):t.children[i].classList.remove("jtags_error")):t.children[i].classList.remove("jtags_label");m()},m=function(){t.innerText.trim()?t.classList.remove("jtags-empty"):(t.innerHTML="<div></div>",t.classList.add("jtags-empty"))},j=function(text){var data=[],e="";if(text=text.trim()){for(var i=0;i<text.length;i++)","==text[i]||";"==text[i]||"\n"==text[i]?e&&(data.push(e.trim()),e=""):e+=text[i];e&&data.push(e)}return data},v=0,x=function(e){v=window.getSelection().anchorOffset,m(),"Tab"===e.key||";"===e.key||","===e.key?(window.getSelection().anchorOffset>1&&(r()?"function"==typeof n.options.onlimit&&n.options.onlimit(n,n.options.limit):n.add("",!0)),e.preventDefault()):"Enter"==e.key?l&&l.isOpened()||(window.getSelection().anchorOffset>1&&(r()||n.add("",!0)),e.preventDefault()):"Backspace"==e.key&&1==t.children.length&&window.getSelection().anchorOffset<1&&e.preventDefault(),l&&l.keydown(e)},w=function(e){if(39==e.which){var t=window.getSelection().anchorOffset;t>1&&t==v&&n.add("",!0)}else 13==e.which||38==e.which||40==e.which?e.preventDefault():l&&l.keyup(e);filter()},y=function(e){if(e.clipboardData||e.originalEvent.clipboardData)var text=(e.originalEvent||e).clipboardData.getData("text/plain");else window.clipboardData&&(text=window.clipboardData.getData("Text"));var data=j(text);data.length>1&&(n.add(data,!0),e.preventDefault())},C=function(e){if(e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))){var rect=e.target.getBoundingClientRect();rect.width-(e.clientX-rect.left)<16&&n.remove(e.target)}e.target==t&&d()},E=function(){t.classList.contains("jtags-focus")||(t.children.length&&!n.getValue(t.children.length-1)||r()||f(""),"function"==typeof n.options.onfocus&&n.options.onfocus(t,n,n.getValue()),t.classList.add("jtags-focus"))},A=function(){if(t.classList.contains("jtags-focus")){l&&l.close();for(var i=0;i<t.children.length-1;i++)n.getValue(i)||t.removeChild(t.children[i]);h(),t.classList.remove("jtags-focus"),"function"==typeof n.options.onblur&&n.options.onblur(t,n,n.getValue())}};return"touchend"in document.documentElement==1?t.addEventListener("touchend",C):t.addEventListener("mouseup",C),t.addEventListener("keydown",x),t.addEventListener("keyup",w),t.addEventListener("paste",y),t.addEventListener("focus",E),t.addEventListener("blur",A),t.setAttribute("contenteditable",!0),t.classList.add("jtags"),n.setOptions(o),"function"==typeof n.options.onload&&n.options.onload(t,n),t.change=n.setValue,t.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},t.tags=n,n},e.toolbar=function(t,o){var n={type:"toolbar",options:{}},r={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var l in r)o&&o.hasOwnProperty(l)?n.options[l]=o[l]:n.options[l]=r[l];!t&&o.app&&o.app.el&&(t=document.createElement("div"),o.app.el.appendChild(t));var c=document.createElement("div");c.classList.add("jtoolbar-item"),c.classList.add("jtoolbar-arrow");var d=document.createElement("div");d.classList.add("jtoolbar-floating"),c.appendChild(d),n.selectItem=function(element){for(var e=f.children,i=0;i<e.length;i++)element!=e[i]&&e[i].classList.remove("jtoolbar-selected");element.classList.add("jtoolbar-selected")},n.hide=function(){e.animation.slideBottom(t,0,(function(){t.style.display="none"}))},n.show=function(){t.style.display="",e.animation.slideBottom(t,1)},n.get=function(){return t},n.setBadge=function(e,t){f.children[e].children[1].firstChild.innerHTML=t},n.destroy=function(){toolbar.remove(),t.innerHTML=""},n.update=function(a,b){for(var i=0;i<f.children.length;i++){var e=f.children[i];"function"==typeof e.updateState&&e.updateState(t,n,e,a,b)}},n.create=function(o){f.innerHTML="";for(var i=0;i<o.length;i++){var r=document.createElement("div");if(r.classList.add("jtoolbar-item"),o[i].width&&(r.style.width=parseInt(o[i].width)+"px"),o[i].k&&(r.k=o[i].k),o[i].tooltip&&r.setAttribute("title",o[i].tooltip),o[i].id&&r.setAttribute("id",o[i].id),o[i].updateState&&(r.updateState=o[i].updateState),o[i].active&&r.classList.add("jtoolbar-active"),"select"==o[i].type||"dropdown"==o[i].type)e.picker(r,o[i]);else if("divisor"==o[i].type)r.classList.add("jtoolbar-divisor");else if("label"==o[i].type)r.classList.add("jtoolbar-label"),r.innerHTML=o[i].content;else{var l=document.createElement("i");if(void 0===o[i].class)l.classList.add("material-icons");else for(var c=o[i].class.split(" "),d=0;d<c.length;d++)l.classList.add(c[d]);if(l.innerHTML=o[i].content?o[i].content:"",r.appendChild(l),1==n.options.badge){var h=document.createElement("div");h.classList.add("jbadge");var m=document.createElement("div");m.innerHTML=o[i].badge?o[i].badge:"",h.appendChild(m),r.appendChild(h)}if(o[i].title)if(1==n.options.title){var j=document.createElement("span");j.innerHTML=o[i].title,r.appendChild(j)}else r.setAttribute("title",o[i].title);n.options.app&&o[i].route&&(r.route=o[i].route,r.onclick=function(){n.options.app.pages(this.route)},n.options.app.pages(o[i].route,{toolbarItem:r,closed:!0}))}o[i].onclick&&(r.onclick=o[i].onclick.bind(o[i],t,n,r)),f.appendChild(r)}setTimeout((function(){n.refresh()}),0)},n.open=function(){c.classList.add("jtoolbar-arrow-selected"),t.getBoundingClientRect(),d.getBoundingClientRect().bottom>window.innerHeight||n.options.bottom?d.style.bottom="0":d.style.removeProperty("bottom"),d.style.right="0",c.children[0].focus(),e.tracking(n,!0)},n.close=function(){c.classList.remove("jtoolbar-arrow-selected"),e.tracking(n,!1)},n.refresh=function(){if(1==n.options.responsive){var rect=t.parentNode.getBoundingClientRect();n.options.maxWidth||(n.options.maxWidth=rect.width);var e=parseInt(n.options.maxWidth);for(c.remove();d.firstChild;)f.appendChild(d.firstChild);if(e<f.offsetWidth)for(e-=50;f.lastChild&&e<f.offsetWidth;)d.insertBefore(f.lastChild,d.firstChild);d.children.length>0&&f.appendChild(c)}},t.onclick=function(t){var element=e.findElement(t.target,"jtoolbar-item");element&&n.selectItem(element),t.target.classList.contains("jtoolbar-arrow")&&n.open()},window.addEventListener("resize",(function(){n.refresh()})),t.classList.add("jtoolbar"),t.innerHTML="",1==n.options.container&&t.classList.add("jtoolbar-container");var f=document.createElement("div");return t.appendChild(f),n.options.app&&t.classList.add("jtoolbar-mobile"),n.create(n.options.items),t.toolbar=n,n},e.validations=function(t,o){return"function"==typeof e.validations[o.type]?e.validations[o.type](t,o):null},e.validations.email=function(data){var pattern=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!data||!pattern.test(data))},e.validations.required=function(data){return!!data.trim()},e.validations.number=function(data){return e.isNumber(data)},e.validations.login=function(data){var pattern=new RegExp(/^[a-zA-Z0-9\_\-\.\s+]+$/);return!(!data||!pattern.test(data))};var t=function(data,e){return"="===e.constraint?data===e.reference:"<"===e.constraint?data<e.reference:"<="===e.constraint?data<=e.reference:">"===e.constraint?data>e.reference:">="===e.constraint?data>=e.reference:"between"===e.constraint?data>=e.reference[0]&&data<=e.reference[1]:"not between"===e.constraint?data<e.reference[0]||data>e.reference[1]:null};return e.validations.number=function(data,o){return!!e.isNumeric(data)&&(void 0===o||void 0===o.constraint||t(data,o))},e.validations.date=function(data,e){return"Invalid Date"!=new Date(data)&&(void 0===e||void 0===e.constraint||("object"==typeof e?(data=new Date(data).getTime(),Array.isArray(e.reference)?e.reference=e.reference.map((function(e){return new Date(e).getTime()})):e.reference=new Date(e.reference).getTime(),t(data,e)):null))},e.validations.itemList=function(data,e){return e.reference.some((function(e){return e==data}))},e.validations.text=function(data,t){return"string"==typeof data&&(void 0===t||void 0===t.constraint||("="===t.constraint?data===t.reference:"contains"===t.constraint?data.includes(t.reference):"not contain"===t.constraint?!data.includes(t.reference):"email"===t.constraint?e.validations.email(data):"url"===t.constraint?!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(data):null))},e.validations.constraints=function(){},e}()},857:function(e,t,o){var content=o(858);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(27).default)("57792a00",content,!0,{sourceMap:!1})},858:function(e,t,o){var n=o(26)(!1);n.push([e.i,":root{--button-color:#298ba8;--active-color:#007aff}div[data-before]:before{content:attr(data-before)}.unselectable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jreadonly{pointer-events:none}.jdragging{opacity:.2;filter:alpha(opacity=20)}.jupload.input{position:relative;box-sizing:border-box;background-size:auto auto;background-size:initial;height:33px;min-height:0;padding:6px 30px 6px 6px}.jupload.input:before{content:\"save\";font-size:18px;font-family:\"Material Icons\";color:#000;position:absolute;right:5px}.jupload img{width:100%}.jupload.input img{width:auto;max-width:100%;height:100%}.jupload[data-multiple]{padding:10px}.jupload[data-multiple] img{height:70px;width:100px;-o-object-fit:cover;object-fit:cover;margin-right:5px;margin-bottom:5px}.jupload{position:relative;border:1px dotted #eee;cursor:pointer;box-sizing:border-box;width:100%;max-height:100%;min-height:180px}.jupload:not(.input):before{content:\"\\e2c3\";font-family:\"Material Icons\";font-size:90px;color:#eee;width:100%;height:100%;display:flex;align-items:center;justify-content:center;position:absolute;z-index:-1}.jupload-item{padding-right:22px;border-radius:1px;display:inline-block;position:relative}.jremove{opacity:.2;filter:alpha(opacity=20)}.round img{border-radius:1000px}.fade-in{-webkit-animation:fade-in 2s forwards;animation:fade-in 2s forwards}.fade-out{-webkit-animation:fade-out 1s forwards;animation:fade-out 1s forwards}.slide-left-in{position:relative;-webkit-animation:slide-left-in .4s forwards;animation:slide-left-in .4s forwards}.slide-left-out{position:relative;-webkit-animation:slide-left-out .4s forwards;animation:slide-left-out .4s forwards}.slide-right-in{position:relative;-webkit-animation:slide-right-in .4s forwards;animation:slide-right-in .4s forwards}.slide-right-out{position:relative;-webkit-animation:slide-right-out .4s forwards;animation:slide-right-out .4s forwards}.slide-top-in{position:relative;-webkit-animation:slide-top-in .4s forwards;animation:slide-top-in .4s forwards}.slide-top-out{position:relative;-webkit-animation:slide-top-out .2s forwards;animation:slide-top-out .2s forwards}.slide-bottom-in{position:relative;-webkit-animation:slide-bottom-in .4s forwards;animation:slide-bottom-in .4s forwards}.slide-bottom-out{position:relative;-webkit-animation:slide-bottom-out .1s forwards;animation:slide-bottom-out .1s forwards}.spin{-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite}@keyframes fade-in{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fade-in{0%{opacity:0}to{opacity:1}}@keyframes fade-out{0%{opacity:1}to{opacity:0}}@-webkit-keyframes fade-out{0%{opacity:1}to{opacity:0}}@keyframes slide-left-in{0%{left:-100%}to{left:0}}@-webkit-keyframes slide-left-in{0%{left:-100%}to{left:0}}@keyframes slide-left-out{0%{left:0}to{left:-100%}}@-webkit-keyframes slide-left-out{0%{left:0}to{left:-100%}}@keyframes slide-right-in{0%{left:100%}to{left:0}}@-webkit-keyframes slide-right-in{0%{left:100%}to{left:0}}@keyframes slide-right-out{0%{left:0}to{left:100%}}@-webkit-keyframes slide-right-out{0%{left:0}to{left:100%}}@keyframes slide-top-in{0%{transform:translateY(-100%)}to{transform:translateY(0)}}@-webkit-keyframes slide-top-in{0%{transform:translateY(-100%)}to{-webkit-transform:translateY(0)}}@keyframes slide-top-out{0%{transform:translateY(0)}to{transform:translateY(-100%)}}@-webkit-keyframes slide-top-out{0%{-webkit-transform:translateY(0)}to{-webkit-transform:translateY(-100%)}}@keyframes slide-bottom-in{0%{transform:translateY(100%)}to{transform:translateY(0)}}@-webkit-keyframes slide-bottom-in{0%{transform:translateY(100%)}to{-webkit-transform:translateY(0)}}@keyframes slide-bottom-out{0%{transform:translateY(0)}to{transform:translateY(100%)}}@-webkit-keyframes slide-bottom-out{0%{-webkit-transform:translateY(0)}to{-webkit-transform:translateY(100%)}}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(359deg)}}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(359deg)}}.jcalendar{position:absolute;z-index:9000;display:none;box-sizing:border-box;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;min-width:280px}.jcalendar.jcalendar-focus{display:block}.jcalendar .jcalendar-backdrop{position:fixed;top:0;left:0;z-index:9000;min-width:100%;min-height:100%;background-color:rgba(0,0,0,.5);border:0;padding:0;display:none}.jcalendar .jcalendar-container{position:relative;box-sizing:border-box}.jcalendar .jcalendar-content{position:absolute;z-index:9001;box-shadow:1px 1px 5px 0 rgba(0,0,0,.39);background-color:#fff}.jcalendar-header{text-align:center}.jcalendar-header span{margin-right:4px;font-size:1.1em;font-weight:700}.jcalendar-prev{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z'/%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3C/svg%3E\")}.jcalendar-next,.jcalendar-prev{cursor:pointer;background-position:50%;background-repeat:no-repeat}.jcalendar-next{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z'/%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3C/svg%3E\")}.jcalendar-weekday{font-weight:600;background-color:#fcfcfc;padding:14px}.jcalendar-table>table{width:100%;background-color:#fff}.jcalendar-table>table>thead{cursor:pointer}.jcalendar-table thead td{padding:10px;height:40px}.jcalendar-table>table>tbody td{box-sizing:border-box;cursor:pointer;padding:9px;font-size:.9em}.jcalendar-table tfoot td{padding:10px}.jcalendar-months td,.jcalendar-years td{height:24px}.jcalendar-input{padding-right:18px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='gray'%3E%3Cpath d='M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 18H4V8h16v13z'/%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3C/svg%3E\");background-position:top 50% right 5px;background-repeat:no-repeat;box-sizing:border-box}.jcalendar-done{box-shadow:1px 1px 5px 0 rgba(0,0,0,.39);background-color:#fff}.jcalendar-update{border:1px solid #ccc;background-color:#fff;border-radius:4px;padding:5px;width:100%}.jcalendar-container select{width:55px;display:inline-block;border:0;padding:4px;text-align:center;font-size:1.1em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-right:10px}.jcalendar-container select:first-child{margin-right:2px}.jcalendar-selected{background-color:#eee}.jcalendar-confirm,.jcalendar-reset{text-transform:uppercase;cursor:pointer;color:#007aff;color:var(--active-color)}.jcalendar-controls{padding:15px;box-sizing:border-box;vertical-align:middle;display:flex;justify-content:space-between;align-items:center}.jcalendar-controls div{font-weight:700}.jcalendar-fullsize{position:fixed;width:100%;top:0;left:0}.jcalendar-fullsize .jcalendar-content{position:fixed;width:100%;left:0;bottom:0}.jcalendar-focus.jcalendar-fullsize .jcalendar-backdrop{display:block}.jcalendar-sunday{color:red}.jcalendar-disabled{color:#ccc}.jcalendar-time{display:flex}.jcolor{position:absolute;display:none;outline:none}.jcolor-input{padding-right:18px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='18' height='18'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M12 3a9 9 0 000 18c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z'/%3E%3C/svg%3E\");background-position:top 50% right 5px;background-repeat:no-repeat;box-sizing:border-box}.jcolor-content{position:absolute;left:0;z-index:9000;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-smoothing:antialiased;font-size:.875rem;letter-spacing:.2px;border-radius:4px;box-shadow:0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12),0 5px 5px -3px rgba(0,0,0,.2);background-color:#fff;box-sizing:border-box;min-width:260px}.jcolor-controls{display:flex;padding:10px;border-bottom:1px solid #eee;margin-bottom:5px}.jcolor-controls div{flex:1;font-size:1em;color:#007aff;color:var(--active-color);text-transform:uppercase;font-weight:700;box-sizing:border-box}.jcolor-content table{border-collapse:collapse;box-sizing:border-box}.jcolor-focus{display:block}.jcolor table{width:100%;height:100%;min-height:160px}.jcolor td{padding:7px}.jcolor-selected{background-repeat:no-repeat;background-size:16px;background-position:50%;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z' fill='%23fff'/%3E%3C/svg%3E\")}.jcolor-fullscreen{position:fixed;bottom:0;width:100%;max-height:290px;border-radius:0;box-sizing:border-box}.jcolor-fullscreen .jcolor-controls{padding:15px;box-shadow:1px 0 1px 0 rgba(0,0,0,.39)}.jcolor-reset{text-align:left}.jcolor-close{text-align:right}.jcolor-backdrop{position:fixed;top:0;left:0;min-width:100%;min-height:100%;background-color:rgba(0,0,0,.5);border:0;padding:0;z-index:8000;display:none;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jcolor-content .jtabs-content{padding:7px}.jcolor-grid tr:first-child>td:first-child{border-top-left-radius:3px}.jcolor-grid tr:first-child>td:last-child{border-top-right-radius:3px}.jcolor-grid tr:last-child>td:first-child{border-bottom-left-radius:3px}.jcolor-grid tr:last-child>td:last-child{border-bottom-right-radius:3px}.jcolor-hsl{box-sizing:border-box}.jcolor-hsl>div{height:100%;position:relative}.jcolor-hsl canvas{display:block;border-radius:4px;-webkit-user-drag:none}.jcolor-point{height:5px;width:5px;background-color:#000;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);border-radius:50%}.jcolor-sliders{padding:10px 20px 10px 10px}.jcolor-sliders input{-webkit-appearance:none;height:12px;width:80%;background:#d3d3d3;opacity:1;border-radius:30px;outline:none}.jcolor-sliders-input-subcontainer{display:flex;justify-content:space-between;align-items:center}.jcolor-sliders-input-container{margin-top:4px;line-height:.8em;text-align:left}.jcolor-sliders-input-container>label{font-size:10px;text-transform:uppercase;color:#bbbbbd}.jcolor-sliders-input-subcontainer>input{border:0;padding:1px}.jcolor-sliders-input-container input::-webkit-slider-thumb{-webkit-appearance:none;height:12px;width:12px;border-radius:50%;background:#000;border:2px solid #fff;cursor:pointer}.jcolor-sliders-input-container input::-moz-range-thumb{-webkit-appearance:none;height:12px;width:12px;border-radius:50%;background:#000;border:2px solid #fff;cursor:pointer}.jcolor-sliders-final-color{padding:6px;-webkit-user-select:all;-moz-user-select:all;-ms-user-select:all;user-select:all;margin-top:10px;text-align:center}.jcolor-sliders-final-color>div:nth-child(2){width:71px;text-transform:uppercase}.jcolor .jtabs .jtabs-headers-container .jtabs-controls{display:none!important}.jcolor .jtabs .jtabs-headers-container{display:flex!important;justify-content:center;padding:4px}.jcolor .jtabs-headers>div:not(.jtabs-border){padding:2px 15px!important;font-size:.8em}.jcontextmenu{position:fixed;z-index:10000;background:#fff;color:#555;font-size:11px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;box-shadow:2px 2px 2px 0 #8f9091;border:1px solid #c6c6c6;padding:4px 0;margin:0;outline:none;display:none}.jcontextmenu.jcontextmenu-focus{display:inline-block}.jcontextmenu>div{box-sizing:border-box;display:flex;padding:8px 8px 8px 32px;width:250px;position:relative;cursor:default;font-size:11px;font-family:sans-serif}.jcontextmenu>div:before{content:attr(data-icon);font-family:\"Material Icons\"!important;font-weight:400;font-style:normal;font-size:16px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:\"liga\";-webkit-font-smoothing:antialiased;position:absolute;left:9px}.jcontextmenu>div.header{display:none}.jcontextmenu>div a{color:#555;text-decoration:none;flex:1}.jcontextmenu>div span{margin-right:10px}.jcontextmenu .jcontextmenu-disabled a{color:#ccc}.jcontextmenu>div:hover{background:#ebebeb}.jcontextmenu hr{border:1px solid #e9e9e9;border-bottom:0;margin-top:5px;margin-bottom:5px}.jcontextmenu>hr:hover{background:transparent}.jcontextmenu .jcontextmenu{top:4px;left:99%;opacity:0;position:absolute}.jcontextmenu>div:hover>.jcontextmenu{display:block;opacity:1;transform:translate(0) scale(1);pointer-events:auto}@media only screen and (max-width:420px){.jcontextmenu{top:auto!important;left:0!important;bottom:0!important;width:100vw;height:260px;overflow:scroll;-webkit-animation:slide-bottom-in .4s forwards;animation:slide-bottom-in .4s forwards;padding-top:0}.jcontextmenu div{width:100%;text-align:center;border-bottom:1px solid #ccc;padding:15px}.jcontextmenu>div.header{background-color:#d3d3d3;padding:5px;top:0;position:-webkit-sticky;position:sticky;z-index:2}.jcontextmenu>div.header>a.title{text-align:left}.jcontextmenu>div.header>a.close{text-align:right}.jcontextmenu>div:before{content:attr(data-icon);font-family:\"Material Icons\"!important;font-weight:400;font-style:normal;font-size:16px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:\"liga\";-webkit-font-smoothing:antialiased;position:absolute;left:9px}.jcontextmenu a{font-size:1.4em;text-transform:uppercase}.jcontextmenu hr,.jcontextmenu span{display:none}}.jdropdown{cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;box-sizing:border-box;background:#fff;-webkit-tap-highlight-color:transparent;display:inline-block}.jdropdown-header::-moz-placeholder{color:#000}.jdropdown-header:-ms-input-placeholder{color:#000}.jdropdown-header::placeholder{color:#000}.jdropdown-backdrop{position:fixed;top:0;left:0;min-width:100%;min-height:100%;background-color:rgba(0,0,0,.5);border:0;padding:0;z-index:8000;display:none}.jdropdown[disabled]{opacity:.5;pointer-events:none}.jdropdown-focus{position:relative}.jdropdown-focus .jdropdown-container{transform:translateZ(0)}.jdropdown-default.jdropdown-focus .jdropdown-header{outline:5px auto -webkit-focus-ring-color}.jdropdown-default.jdropdown-focus .jdropdown-header.jdropdown-add{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='gray' width='24' height='24'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M19 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z'/%3E%3C/svg%3E\")}.jdropdown-container-header{padding:0;margin:0;position:relative}.jdropdown-header{width:100%;appearance:none;background-repeat:no-repeat;background-position:top 50% right 5px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath d='M7 10l5 5 5-5H7z' fill='gray'/%3E%3C/svg%3E\");text-overflow:ellipsis;cursor:pointer;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;padding-right:30px!important}.jdropdown-insert-button{font-size:1.4em;text-transform:uppercase;position:absolute;right:30px;top:4px;display:none}.jdropdown-container{min-width:inherit;transform:translate3d(-10000px,0,0);position:absolute;z-index:9001}.jdropdown-close{display:none;font-size:1em;color:#007aff;color:var(--active-color);text-transform:uppercase;text-align:right;padding:15px;font-weight:700}.jdropdown-content{min-width:inherit;margin:0;box-sizing:border-box}.jdropdown-item{white-space:nowrap;text-align:left;text-overflow:ellipsis;overflow-x:hidden;color:#000;display:flex;align-items:center}.jdropdown-description{text-overflow:ellipsis;overflow:hidden;line-height:1.5em}.jdropdown-image{margin-right:10px;width:32px;height:32px;border-radius:20px}.jdropdown-image-small{width:24px;height:24px}.jdropdown-icon{margin-right:10px;font-size:30px;margin-left:-5px}.jdropdown-icon-small{font-size:24px;margin-left:0}.jdropdown-title{font-size:.7em;text-overflow:ellipsis;overflow-x:hidden;display:block}.jdropdown-default .jdropdown-header{border:1px solid #ccc;padding:5px 16px 5px 10px}.jdropdown-default .jdropdown-container{background-color:#fff}.jdropdown-default.jdropdown-focus.jdropdown-insert .jdropdown-header{padding-right:50px}.jdropdown-default.jdropdown-focus.jdropdown-insert .jdropdown-insert-button{display:block}.jdropdown-default .jdropdown-content{min-width:inherit;border:1px solid #8fb1e3;margin:0;background-color:#fff;box-sizing:border-box;min-height:10px;max-height:215px;overflow-y:auto}.jdropdown-default .jdropdown-item{padding:4px 40px 4px 8px}.jdropdown-default .jdropdown-item:hover{background-color:#1f93ff;color:#fff}.jdropdown-default .jdropdown-cursor{background-color:#eee}.jdropdown-default .jdropdown-selected{background-image:url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik05IDE2LjE3TDQuODMgMTJsLTEuNDIgMS40MUw5IDE5IDIxIDdsLTEuNDEtMS40MXoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=\");background-repeat:no-repeat;background-position:top 50% right 5px;background-color:#1f93ff;color:#fff}.jdropdown-default .jdropdown-group{margin-top:5px}.jdropdown-default .jdropdown-group .jdropdown-item{padding-left:16px}.jdropdown-default .jdropdown-group-name{padding-left:8px;font-weight:700;text-align:left}.jdropdown-default .jdropdown-reset_{content:\"x\";position:absolute;top:0;right:0;margin:5px 10px 5px 5px;font-size:12px;width:12px;cursor:pointer;text-shadow:0 0 5px #fff;display:none;line-height:1.8em}.jdropdown-default.jdropdown-focus .jdropdown-reset_,.jdropdown-picker.jdropdown-focus .jdropdown-backdrop{display:block}.jdropdown-picker .jdropdown-header{outline:none}.jdropdown-picker .jdropdown-container{position:fixed;bottom:0;left:0;border-bottom:1px solid #e6e6e8;width:100%;background-color:#fff;box-sizing:border-box}.jdropdown-picker .jdropdown-close{box-shadow:0 -1px 5px 0 rgba(0,0,0,.39);background-color:#fff;display:block}.jdropdown-picker .jdropdown-content{overflow-y:scroll;height:280px;background-color:#fafafa;border-top:1px solid #e6e6e8}.jdropdown-picker .jdropdown-group-name{display:block;text-align:center;font-weight:700}.jdropdown-picker .jdropdown-group-name,.jdropdown-picker .jdropdown-item{font-size:1em;text-transform:uppercase;border-bottom:1px solid #e6e6e8;padding:10px 20px}.jdropdown-picker .jdropdown-selected{background-image:url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik05IDE2LjE3TDQuODMgMTJsLTEuNDIgMS40MUw5IDE5IDIxIDdsLTEuNDEtMS40MXoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=\");background-repeat:no-repeat;background-position:top 50% right 15px;background-color:#1f93ff;color:#fff}.jdropdown-picker .jdropdown-cursor{background-color:#1f93ff;color:#fff}.jdropdown-searchbar.jdropdown-focus{position:fixed;top:0!important;left:0!important;width:100%!important;height:100%!important;background-color:#fafafa;padding:0;z-index:9001;overflow-y:scroll;will-change:scroll-position;-webkit-overflow-scrolling:touch}.jdropdown-searchbar.jdropdown-focus .jdropdown-container-header{position:fixed;top:0;left:0;z-index:9002;padding:10px;background-color:#fff;box-shadow:0 1px 2px rgba(0,0,0,.1);max-height:24px;width:100%}.jdropdown-searchbar.jdropdown-focus .jdropdown-header{border:0;background-repeat:no-repeat;background-position-x:0;background-position-y:40%;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZD0iTTE1LjUgMTRoLS43OWwtLjI4LS4yN0E2LjQ3MSA2LjQ3MSAwIDAwMTYgOS41IDYuNSA2LjUgMCAxMDkuNSAxNmMxLjYxIDAgMy4wOS0uNTkgNC4yMy0xLjU3bC4yNy4yOHYuNzlsNSA0Ljk5TDIwLjQ5IDE5bC00Ljk5LTV6bS02IDBDNy4wMSAxNCA1IDExLjk5IDUgOS41UzcuMDEgNSA5LjUgNSAxNCA3LjAxIDE0IDkuNSAxMS45OSAxNCA5LjUgMTR6IiBmaWxsPSIjZTZlNmU4Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==);padding-left:30px!important;padding-right:60px!important}.jdropdown-searchbar.jdropdown-focus .jdropdown-close{display:block}.jdropdown-searchbar .jdropdown-header{outline:none}.jdropdown-searchbar .jdropdown-container{margin-top:40px;width:100%}.jdropdown-searchbar .jdropdown-close{position:fixed;top:0;right:0}.jdropdown-searchbar .jdropdown-content{margin-top:10px}.jdropdown-searchbar .jdropdown-group{margin-top:10px;margin-bottom:15px;background-color:#fff}.jdropdown-searchbar .jdropdown-group-name{border-top:1px solid #e6e6e8;border-bottom:1px solid #e6e6e8;padding:10px 10px 10px 12px;font-weight:700}.jdropdown-searchbar .jdropdown-group-arrow{float:right;width:24px;height:24px;background-repeat:no-repeat}.jdropdown-searchbar .jdropdown-group-arrow-down{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZD0iTTcuNDEgOC41OUwxMiAxMy4xN2w0LjU5LTQuNThMMTggMTBsLTYgNi02LTYgMS40MS0xLjQxeiIvPjxwYXRoIGZpbGw9Im5vbmUiIGQ9Ik0wIDBoMjR2MjRIMFYweiIvPjwvc3ZnPg==)}.jdropdown-searchbar .jdropdown-group-arrow-up{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZD0iTTcuNDEgMTUuNDFMMTIgMTAuODNsNC41OSA0LjU4TDE4IDE0bC02LTYtNiA2eiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=)}.jdropdown-searchbar .jdropdown-item{border-bottom:1px solid #e6e6e8;padding:10px 40px 10px 15px;background-color:#fff;font-size:.9em}.jdropdown-searchbar .jdropdown-description{text-overflow:ellipsis;overflow:hidden;max-width:calc(100% - 20px)}.jdropdown-searchbar .jdropdown-content>.jdropdown-item:first-child{border-top:1px solid #e6e6e8}.jdropdown-searchbar .jdropdown-selected{background-image:url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik05IDE2LjE3TDQuODMgMTJsLTEuNDIgMS40MUw5IDE5IDIxIDdsLTEuNDEtMS40MXoiIGZpbGw9IiMwMDdhZmYiLz48L3N2Zz4=\");background-repeat:no-repeat;background-position:top 50% right 15px}.jdropdown-list .jdropdown-container{display:block}.jdropdown-list .jdropdown-header{display:none}.jdropdown-list .jdropdown-group{background-color:#fff}.jdropdown-list .jdropdown-group-name{border-bottom:1px solid #e6e6e8;padding-top:10px;padding-bottom:10px;font-weight:700}.jdropdown-list .jdropdown-item{border-bottom:1px solid #e6e6e8;padding:10px 40px 10px 10px;background-color:#fff}.jdropdown-list .jdropdown-selected{background-image:url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik05IDE2LjE3TDQuODMgMTJsLTEuNDIgMS40MUw5IDE5IDIxIDdsLTEuNDEtMS40MXoiIGZpbGw9IiMwMDdhZmYiLz48L3N2Zz4=\");background-repeat:no-repeat;background-position:top 50% right 10px}@media only screen and (max-width:800px){.jdropdown-list{width:100%!important;border:0;padding:0}.jdropdown-list .jdropdown-container{min-width:100%}.jdropdown-searchbar.jdropdown-focus .jdropdown-description{text-transform:uppercase}}.app .jdropdown-item{text-transform:uppercase}.jdropdown-create-container{margin:10px;border:1px solid #ccc;border-radius:2px;padding:6px}.jdropdown-color{background-color:#fff;border:1px solid transparent;border-radius:12px;width:12px;height:12px;margin-right:6px}.jdropdown-item[data-disabled]{opacity:.5;pointer-events:none}.jeditor-container{border:1px solid #ccc;box-sizing:border-box}.jeditor-dragging{border:1px dashed #000}.jeditor-container.jeditor-padding{padding:10px}.jeditor{outline:none;word-break:break-word}.jeditor[data-placeholder]:empty:before{content:attr(data-placeholder);color:#d3d3d3}.jeditor-container.jeditor-padding .jeditor{min-height:100px;margin-bottom:10px;padding:10px}.jsnippet{margin-top:15px;cursor:pointer;border:1px solid #ccc;position:relative}.jsnippet:focus{outline:none}.jsnippet img{width:100%}.jsnippet .jsnippet-title{padding:15px;font-size:1.4em}.jsnippet .jsnippet-description{padding-left:15px;padding-right:15px;font-size:1em}.jsnippet .jsnippet-host{padding:15px;text-transform:uppercase;font-size:.8em;color:#777;text-align:right}.jsnippet .jsnippet-url{display:none}.jeditor .jsnippet:after{content:\"close\";font-family:\"Material icons\";font-size:24px;width:24px;height:24px;line-height:24px;cursor:pointer;text-shadow:0 0 2px #fff;position:absolute;top:12px;right:12px}.jsnippet *{-webkit-user-select:none;-moz-user-select:none;-o-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none;-khtml-user-drag:none;-moz-user-drag:none;-o-user-drag:none}.jeditor img{border:2px solid transparent;box-sizing:border-box}.jeditor img.resizing{-webkit-user-select:none;-moz-user-select:none;-o-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none;-khtml-user-drag:none;-moz-user-drag:none;-o-user-drag:none}.jeditor img:focus{border:2px solid #0096fd;outline:#0096fd}.jeditor .pdf{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath d='M511.344 274.266c.426-6.035.656-12.123.656-18.266C512 114.615 397.385 0 256 0S0 114.615 0 256c0 117.769 79.53 216.949 187.809 246.801l323.535-228.535z' fill='%23c30b15'/%3E%3Cpath d='M511.344 274.266L314.991 77.913 119.096 434.087l68.714 68.714C209.522 508.787 232.385 512 256 512c135.243 0 245.976-104.875 255.344-237.734z' fill='%2385080e'/%3E%3Cpath fill='%23fff' d='M278.328 333.913l-22.617-256H119.096v233.739z'/%3E%3Cpath fill='%23e8e6e6' d='M392.904 311.652V155.826l-55.652-22.261-22.261-55.652h-59.28l.356 256z'/%3E%3Cpath fill='%23fff' d='M314.991 155.826V77.913l77.913 77.913z'/%3E%3Cpath fill='%23fc0f1a' d='M119.096 311.652h273.809v122.435H119.096z'/%3E%3Cg fill='%23fff'%3E%3Cpath d='M204.871 346.387c13.547 0 21.341 6.659 21.341 18.465 0 12.412-7.795 19.601-21.341 19.601h-9.611v14.909h-13.471v-52.975h23.082zm-9.611 27.471h8.93c5.904 0 9.308-2.952 9.308-8.552 0-5.525-3.406-8.324-9.308-8.324h-8.93v16.876zM257.928 346.387c16.649 0 28.152 10.746 28.152 26.487 0 15.666-11.655 26.488-28.683 26.488h-22.25v-52.975h22.781zm-9.309 42.228h9.611c8.249 0 14.151-6.357 14.151-15.665 0-9.384-6.205-15.817-14.757-15.817h-9.006v31.482zM308.563 356.982v12.26h23.763v10.596h-23.763v19.525h-13.471v-52.975h39.277v10.595h-25.806v-.001z'/%3E%3C/g%3E%3C/svg%3E\");background-repeat:no-repeat;background-size:cover;width:60px;height:60px}.jeditor-toolbar{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;max-width:100%;box-sizing:border-box}.jloading{position:fixed;z-index:10001;width:100%;left:0;right:0;top:0;bottom:0;background-color:rgba(0,0,0,.7)}.jloading:after{content:\"\";display:block;margin:50vh auto 0;width:40px;height:40px;border:4px solid #fff;border-top-color:transparent;border-radius:50%;-webkit-animation:spin .8s linear infinite;animation:spin .8s linear infinite}.jloading.spin{background-color:transparent}.jloading.spin:after{margin:80px auto 0;border-color:transparent #aaa #aaa}.jmodal{position:fixed;top:50%;left:50%;width:60%;height:60%;-webkit-box-shadow:0 2px 10px rgba(0,0,0,.2);-moz-box-shadow:0 2px 10px rgba(0,0,0,.2);border:1px solid #ccc;transform:translate(-50%,-50%);padding-top:50px!important;z-index:9002;border-radius:8px}.jmodal,.jmodal:before{background-color:#fff;box-sizing:border-box}.jmodal:before{position:absolute;top:0;left:0;width:100%;content:attr(title);padding:15px;font-size:1.2em;box-shadow:1px 1px 3px rgba(0,0,0,.2);border-radius:8px 8px 0 0}.jmodal_content{padding:20px;overflow-y:auto;max-height:100%;box-sizing:border-box;height:-webkit-fill-available}.jmodal.no-title{padding-top:0!important}.jmodal.no-title:before{display:none}.jmodal:after{content:\"\";background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\");position:absolute;top:0;right:0;margin:14px;font-size:24px;width:24px;height:24px;cursor:pointer;text-shadow:0 0 5px #fff}.jmodal_fullscreen{width:100%!important;height:100%!important;top:0;left:0;transform:none;border:0;border-radius:0}.jmodal_backdrop{position:fixed;top:0;left:0;min-width:100%;min-height:100%;background-color:rgba(0,0,0,.5);border:0;padding:0;z-index:8000;display:none;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jnotification{position:fixed;z-index:10000;box-sizing:border-box;padding:10px;bottom:0}.jnotification-container{box-shadow:0 2px 15px -5px rgba(0,0,0,.7);border-radius:8px;background-color:#000;background:#5c5c5c;background:linear-gradient(0deg,#5c5c5c,#4d4d4d);color:#fff;width:320px;margin:30px;padding:20px}.jnotification-close{content:\"\";background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='%23fff'%3E%3Cpath d='M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\");font-size:20px;width:20px;height:20px;cursor:pointer}.jnotification-title{font-weight:700}.jnotification-header{padding-bottom:5px}.jnotification-header:empty{display:none}.jnotification-image{margin-right:5px}.jnotification-image:empty{display:none}.jnotification-image img{width:24px}.jnotification-name{text-transform:uppercase;font-size:.9em;flex:1;letter-spacing:.1em}.jnotification-error .jnotification-container{background:#b62606;background:linear-gradient(0deg,#aa290d,#950b0b)}@media (max-width:800px){.jnotification{top:0;width:100%}.jnotification-container{background:hsla(0,0%,100%,.95);border:1px solid #eee;color:#444;margin:0;width:auto}.jnotification-error .jnotification-container{background:hsla(0,0%,100%,.95);color:#790909}.jnotification-close{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24'%3E%3Cpath d='M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\")}}.jnotification-header{display:flex;justify-content:flex-start;align-items:center}.jpicker{white-space:nowrap;display:inline-flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative}.jpicker,.jpicker-header{cursor:pointer;outline:none}.jpicker-header{background-repeat:no-repeat;background-position:top 50% right 5px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath d='M7 10l5 5 5-5H7z' fill='gray'/%3E%3C/svg%3E\");text-overflow:ellipsis;box-sizing:border-box;text-align:left;line-height:24px;padding:2px 35px 2px 12px;border-radius:4px}.jpicker-header:hover{background-color:#eee}.jpicker-content{position:absolute;top:0;display:none;box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.2);border-radius:4px;background-color:#fff;padding:4px;z-index:50;text-align:left;max-height:200px;scrollbar-width:thin;scrollbar-color:#333 transparent}.jpicker-content::-webkit-scrollbar{width:8px}.jpicker-content::-webkit-scrollbar-track{background:#eee}.jpicker-content::-webkit-scrollbar-thumb{background:#888}.jpicker-content>div{padding:6px 15px}.jpicker-focus>.jpicker-content{display:block}.jpicker-content>div:hover{background-color:#efefef}.jpicker-content>div:empty{opacity:0}.jpicker-header>div,.jpicker-header>i{display:block}.jpicker-focus>.jpicker-content.jpicker-columns{display:flex!important;justify-content:center;flex-wrap:wrap}.jprogressbar{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background:#fff;-webkit-tap-highlight-color:transparent;display:inline-block;box-sizing:border-box;cursor:pointer;border:1px solid #ccc;position:relative}.jprogressbar:before{content:attr(data-value);position:absolute;margin:5px 5px 5px 10px}.jprogressbar-header::-moz-placeholder{color:#000}.jprogressbar-header:-ms-input-placeholder{color:#000}.jprogressbar-header::placeholder{color:#000}.jprogressbar::focus{outline:5px auto -webkit-focus-ring-color}.jprogressbar>div{background-color:#eee;background-color:red;box-sizing:border-box;height:31px}.jrating{display:flex}.jrating>div{width:24px;height:24px;line-height:24px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z' fill='gray'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\")}.jrating .jrating-over{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\");opacity:.7}.jrating .jrating-selected{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='red'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\")}.jsearch{position:relative;display:none}.jsearch,.jsearch_container{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jsearch_container{position:absolute;box-shadow:0 1px 2px 0 rgba(60,64,67,.302),0 2px 6px 2px rgba(60,64,67,.149);border:none;border-radius:4px;width:280px;padding:8px 0;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:opacity .218s;background:#fff;border:1px solid rgba(0,0,0,.2);cursor:pointer;margin:0;min-width:300px;outline:none;width:auto}.jsearch_container:empty:after{content:attr(data-placeholder)}.jsearch_container>div{color:#333;cursor:pointer;display:flex;padding:5px 10px;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jsearch_container>div:hover{background-color:#e8eaed}.jsearch_container>div>img{width:32px;height:32px;border-radius:16px;margin-right:2px}.jsearch_container>div>div,.jsearch_container>div>img{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jsearch_container>div>div{overflow:hidden;text-overflow:ellipsis;margin-left:2px;max-width:300px;white-space:nowrap}.jsearch_container .selected{background-color:#e8eaed}.jslider{outline:none}.jslider-focus{width:100%!important;height:100%!important}.jslider img{width:100px}.jslider-left:before{left:15px;content:\"arrow_back_ios\"}.jslider-left:before,.jslider-right:after{position:fixed;top:50%;color:#fff;width:30px;height:30px;font-family:\"Material Icons\";font-size:30px;text-shadow:0 0 6px #383838;text-align:center;cursor:pointer}.jslider-right:after{right:15px;content:\"arrow_forward_ios\"}.jslider-close{width:24px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23fff'%3E%3Cpath d='M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\");top:15px;right:15px;display:block!important}.jslider-close,.jslider-counter{height:24px;position:fixed;cursor:pointer;z-index:3000}.jslider-counter{background-color:transparent;left:50%;transform:translateX(-50%);bottom:15px;display:flex;display:-webkit-flex;-webkit-justify-content:center;-webkit-align-items:center;justify-content:center;align-items:center;flex-direction:row}.jslider-caption{position:fixed;max-width:90vw;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;top:15px;left:15px;z-index:3000;color:#fff;font-size:1rem;display:block!important}.jslider-counter div{width:10px;height:10px;background:#fff;border-radius:50%;margin:0 5px;display:block!important}.jslider-counter .jslider-counter-focus{background-color:#6495ed;pointer-events:none}.jslider-focus{position:fixed;left:0;top:0;width:100%;min-height:100%;max-height:100%;z-index:2000;margin:0;box-sizing:border-box;background-color:rgba(0,0,0,.8);transition-duration:.05s;display:flex;align-items:center}.jslider-focus img{width:50vw;height:auto;box-sizing:border-box;margin:0 auto;vertical-align:middle;display:none}.jslider-focus img.jslider-vertical{width:auto;height:80vh}@media only screen and (max-width:576px){.jslider-focus img.jslider-vertical{width:99vw!important;height:auto!important}.jslider-focus img{width:100vw!important;height:auto!important}}.jslider-grid{display:-ms-grid;display:grid;grid-gap:1px;position:relative}.jslider-grid[data-number=\"2\"]{-ms-grid-columns:1fr 50%;grid-template-columns:1fr 50%}.jslider-grid[data-number=\"3\"]{-ms-grid-columns:1fr 33%;grid-template-columns:1fr 33%}.jslider-grid[data-number=\"4\"]{-ms-grid-columns:1fr 25%;grid-template-columns:1fr 25%}.jslider-grid img{display:none;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.jslider-grid[data-total]:after{content:attr(data-total) \"+\";font-size:1.5em;position:absolute;color:#fff;right:15px;bottom:6px}.jslider-grid img:first-child{-ms-grid-column:1;-ms-grid-row:1;grid-column:1;grid-row:1;display:block}.jslider-grid[data-number=\"2\"] img:nth-child(2){-ms-grid-column:2;-ms-grid-row:1;grid-column:2;grid-row:1;display:block}.jslider-grid[data-number=\"3\"] img:first-child{-ms-grid-column:1/2;-ms-grid-row:1/4;grid-column:1/2;grid-row:1/4}.jslider-grid[data-number=\"3\"] img:nth-child(2){-ms-grid-column:2;-ms-grid-row:1;grid-column:2;grid-row:1;display:block}.jslider-grid[data-number=\"3\"] img:nth-child(3){-ms-grid-column:2;-ms-grid-row:2;grid-column:2;grid-row:2;display:block}.jslider-grid[data-number=\"4\"] img:first-child{-ms-grid-column:1/2;-ms-grid-row:1/4;grid-column:1/2;grid-row:1/4}.jslider-grid[data-number=\"4\"] img:nth-child(2){-ms-grid-column:2;-ms-grid-row:1;grid-column:2;grid-row:1;display:block}.jslider-grid[data-number=\"4\"] img:nth-child(3){-ms-grid-column:2;-ms-grid-row:2;grid-column:2;grid-row:2;display:block}.jslider-grid[data-number=\"4\"] img:nth-child(4){-ms-grid-column:2;-ms-grid-row:3;grid-column:2;grid-row:3;display:block}.jtabs{max-width:100vw;position:relative}.jtabs .jtabs-headers,.jtabs .jtabs-headers-container{display:flex;align-items:center}.jtabs .jtabs-headers{overflow:hidden;position:relative}.jtabs .jtabs-headers>div:not(.jtabs-border){padding:6px 20px;margin-left:1px;margin-right:1px;background-color:#f1f1f1;cursor:pointer;white-space:nowrap;text-align:center}.jtabs .jtabs-headers>div.jtabs-selected{background-color:#e8e8e8;color:#000}.jtabs .jtabs-headers>div>div{color:#555;width:100%;overflow:hidden}.jtabs .jtabs-headers i{display:block;margin:auto}.jtabs .jtabs-content{box-sizing:border-box}.jtabs .jtabs-content>div{display:none;box-sizing:border-box}.jtabs .jtabs-content>div.jtabs-selected{display:block}.jtabs .jtabs-border{position:absolute;height:2px;background-color:#888;transform-origin:left;transition:all .2s cubic-bezier(.4,0,.2,1);transition-property:color,left,transform;display:none}.jtabs-animation .jtabs-border{display:inline;display:initial}.jtabs .jtabs-controls{margin:3px 3px 3px 10px;display:flex;min-width:82px}.jtabs .jtabs-controls>div{cursor:pointer;background-position:50%;background-repeat:no-repeat;width:24px;height:24px;line-height:24px}.jtabs .jtabs-prev{margin-left:10px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='gray' width='18' height='18'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z'/%3E%3C/svg%3E\")}.jtabs .jtabs-prev.disabled{margin-left:10px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23d3d3d3' width='18' height='18'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z'/%3E%3C/svg%3E\")}.jtabs .jtabs-next{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='gray' width='18' height='18'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z'/%3E%3C/svg%3E\")}.jtabs .jtabs-next.disabled{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23d3d3d3' width='18' height='18'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z'/%3E%3C/svg%3E\")}.jtabs .jtabs-add{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24' width='24'%3E%3Cpath d='M19 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z' fill='%23bbb'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\")}.jtabs.jtabs-modern .jtabs-headers>div:not(.jtabs-border){padding:4px 10px;background-color:#fff}.jtabs.jtabs-modern .jtabs-headers>.jtabs-selected,.jtabs.jtabs-modern .jtabs-headers>.jtabs-selected .material-icons{color:#000}.jtabs.jtabs-modern .jtabs-headers{background:#eeeeef!important;padding:2px;border-radius:4px}.jtabs.jtabs-modern .jtabs-headers .jtabs-border{border-color:#eeeeef!important}.jtabs.jtabs-modern .jtabs-border{background-color:rgba(194,197,188,.884)}.jtags{display:flex;flex-wrap:wrap;flex-direction:row;justify-content:flex-start;padding:2px;border:1px solid #ccc}.jtags.jtags-empty:not(.jtags-focus):before{position:absolute;margin:5px;color:#ccc;content:attr(data-placeholder)}.jtags>div{padding:3px 22px 3px 10px;position:relative;border-radius:1px;margin:2px;display:block;outline:none}.jtags>div:empty:before{content:\" \";white-space:pre}.jtags>div:after{content:\"x\";position:absolute;top:4px;right:4px;width:12px;height:12px;cursor:pointer;font-size:11px;display:none}.jtags_label{background-color:#eee!important}.jtags_label:after{display:inline-block!important}.jtags_error:after{color:#fff!important}.jtags_error{background-color:#d93025!important;color:#fff}.jtoolbar-container{border-radius:2px;margin-bottom:5px;box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.2);display:inline-flex!important}.jtoolbar{cursor:pointer;white-space:nowrap;display:flex;padding:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-size:13px}.jtoolbar-mobile{display:flex;position:fixed;bottom:0;margin:0;left:0;width:100%;background:#f7f7f8;z-index:1;box-sizing:border-box;box-shadow:0 -1px 2px rgba(0,0,0,.1);border-radius:0}.jtoolbar>div{display:inline-flex;align-items:center;box-sizing:border-box;vertical-align:middle;justify-content:space-evenly}.jtoolbar-mobile>div{display:flex;width:100%}.jtoolbar .jtoolbar-item{position:relative;text-align:center;margin:auto;padding:2px 4px}.jtoolbar-mobile .jtoolbar-item{flex:1}.jtoolbar .jtoolbar-divisor{width:2px;height:18px;padding:0;margin-left:4px;margin-right:4px;background-color:#ddd}.jtoolbar .jtoolbar-label{padding-left:8px;padding-right:8px}.jtoolbar-mobile a{text-decoration:none;display:inline-block}.jtoolbar-mobile i{display:inline-flex!important;color:#929292}.jtoolbar-mobile span{font-size:.7em;display:block;color:#929292}.jtoolbar-mobile .jtoolbar-selected a,.jtoolbar-mobile .jtoolbar-selected i,.jtoolbar-mobile .jtoolbar-selected span{color:#007aff!important;color:var(--active-color)!important;background-color:transparent}.jtoolbar-item{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jtoolbar-item i{display:block;color:#333}.jtoolbar-item:hover{background-color:#f2f2f2}.jtoolbar .jpicker{padding-left:0;padding-right:0}.jtoolbar .jpicker-header{height:24px;line-height:24px;padding:0 20px 0 8px;background-position:top 50% right 0;display:flex;align-items:center}.jtoolbar .jpicker-content>div{padding:6px}.jtoolbar-active{background-color:#eee}.jtoolbar .fa{width:18px;height:18px;display:block;line-height:18px;font-size:14px}.jtoolbar .material-icons{font-size:18px;width:24px;height:24px;display:block;line-height:24px;transform:rotate(.03deg);text-align:center}.jtoolbar .jtoolbar-arrow{background-repeat:no-repeat;background-position:50%;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='18' height='18'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z'/%3E%3C/svg%3E\");width:24px;height:16px;margin-left:4px;border-left:1px solid #f2f2f2}.jtoolbar-floating{position:absolute;display:none;box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.2);border-radius:4px;background-color:#fff;padding:4px;z-index:50;text-align:left}.jtoolbar-floating .jtoolbar-divisor{display:none}.jtoolbar-floating>div{display:block}.jtoolbar-arrow-selected .jtoolbar-floating{display:flex;flex-wrap:wrap}",""]),e.exports=n},859:function(e,t,o){var n=o(26)(!1);n.push([e.i,":root{--jexcel-border-color:#000}.jexcel_container{display:inline-block;padding-right:2px;box-sizing:border-box;-ms-scroll-chaining:none;overscroll-behavior:contain;outline:none}.jexcel_container.fullscreen{position:fixed;top:0;left:0;width:100%;height:100%;z-index:21}.jexcel_container.fullscreen .jexcel_content{overflow:auto;width:100%;height:100%;background-color:#fff}.jexcel_container.with-toolbar .jexcel>thead>tr>td{top:0}.jexcel_container.fullscreen.with-toolbar{height:calc(100% - 46px)}.jexcel_content{display:inline-block;box-sizing:border-box;padding-right:3px;padding-bottom:3px;position:relative;scrollbar-width:thin;scrollbar-color:#666 transparent}@supports (-moz-appearance:none){.jexcel_content{padding-right:10px}}.jexcel_content::-webkit-scrollbar{width:8px;height:8px}.jexcel_content::-webkit-scrollbar-track{background:#eee}.jexcel_content::-webkit-scrollbar-thumb{background:#666}.jexcel{border-collapse:separate;table-layout:fixed;white-space:nowrap;empty-cells:show;border:0;background-color:#fff;width:0;border-color:transparent #ccc #ccc transparent;border-style:solid;border-width:1px}.jexcel>thead>tr>td{border-color:#ccc transparent transparent #ccc;border-style:solid;border-width:1px;background-color:#f3f3f3;padding:2px;cursor:pointer;box-sizing:border-box;overflow:hidden;position:-webkit-sticky;position:sticky;top:0;z-index:2}.jexcel_container.with-toolbar .jexcel>thead>tr>td{top:42px}.jexcel>thead>tr>td.dragging{background-color:#fff;opacity:.5}.jexcel>thead>tr>td.selected{background-color:#dcdcdc}.jexcel>thead>tr>td.arrow-up{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath d='M7 14l5-5 5 5H7z' fill='gray'/%3E%3C/svg%3E\")}.jexcel>thead>tr>td.arrow-down,.jexcel>thead>tr>td.arrow-up{background-repeat:no-repeat;background-position:center right 5px;text-decoration:underline}.jexcel>thead>tr>td.arrow-down{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath d='M7 10l5 5 5-5H7z' fill='gray'/%3E%3C/svg%3E\")}.jexcel>tbody>tr>td:first-child{position:relative;background-color:#f3f3f3;text-align:center}.jexcel>tbody.resizable>tr>td:first-child:before{content:\"\\00a0\";width:100%;height:3px;position:absolute;bottom:0;left:0;cursor:row-resize}.jexcel>tbody.draggable>tr>td:first-child:after{content:\"\\00a0\";width:3px;height:100%;position:absolute;top:0;right:0;cursor:move}.jexcel>tbody>tr.dragging>td{background-color:#eee;opacity:.5}.jexcel>tbody>tr>td{border-color:#ccc transparent transparent #ccc;border-style:solid;border-width:1px;padding:4px;white-space:nowrap;box-sizing:border-box;line-height:1em}.jexcel>tbody>tr>td:last-child,.jexcel_overflow>tbody>tr>td{overflow:hidden}.jexcel>tbody>tr>td>img{display:inline-block;max-width:100px}.jexcel>tbody>tr>td.readonly{color:rgba(0,0,0,.3)}.jexcel>tbody>tr.selected>td:first-child{background-color:#dcdcdc}.jexcel>tbody>tr>td>input,.jexcel>tbody>tr>td>select,.jexcel>tbody>tr>td>textarea{border:0;border-radius:0;outline:0;width:100%;margin:0;padding:0 2px 0 0;background-color:transparent;box-sizing:border-box}.jexcel>tbody>tr>td>textarea{resize:none;padding-top:6px!important}.jexcel>tbody>tr>td>input[type=checkbox],.jexcel>tbody>tr>td>input[type=radio]{width:12px;margin-top:2px}.jexcel>tbody>tr>td>select{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-repeat:no-repeat;background-position-x:100%;background-position-y:40%;background-image:url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB3aWR0aD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTcgMTBsNSA1IDUtNXoiLz48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PC9zdmc+)}.jexcel>tbody>tr>td.jexcel_dropdown{background-repeat:no-repeat;background-position:top 50% right 5px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath d='M7 10l5 5 5-5H7z' fill='%23d3d3d3'/%3E%3C/svg%3E\");text-overflow:ellipsis;overflow-x:hidden}.jexcel>tbody>tr>td.jexcel_dropdown.jexcel_comments{background:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath d='M7 10l5 5 5-5H7z' fill='%23d3d3d3'/%3E%3C/svg%3E\") top 50% right 5px no-repeat,url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTAxLTMxVDE4OjU1OjA4WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wMS0zMVQxODo1NTowOFoiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTAxLTMxVDE4OjU1OjA4WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDphMTlhZDJmOC1kMDI2LTI1NDItODhjOS1iZTRkYjkyMmQ0MmQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpkOGI5NDUyMS00ZjEwLWQ5NDktYjUwNC0wZmU1N2I3Nzk1MDEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplMzdjYmE1ZS1hYTMwLWNkNDUtYTAyNS1lOWYxZjk2MzUzOGUiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDplMzdjYmE1ZS1hYTMwLWNkNDUtYTAyNS1lOWYxZjk2MzUzOGUiIHN0RXZ0OndoZW49IjIwMTktMDEtMzFUMTg6NTU6MDhaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmExOWFkMmY4LWQwMjYtMjU0Mi04OGM5LWJlNGRiOTIyZDQyZCIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0zMVQxODo1NTowOFoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4En6MDAAAAX0lEQVQYlX3KOw6AIBBAwS32RpJADXfx0pTET+ERZJ8F8RODFtONsG0QAoh0CSDM82dqodaBdQXnfoLZQM7gPai+wjNNE8R4pTuAYNZSKZASqL7CMy0LxNgJp30fKYUDi3+vIqb/+rUAAAAASUVORK5CYII=\") 100% 0 no-repeat}.jexcel>tbody>tr>td>.color{width:90%;height:10px;margin:auto}.jexcel>tbody>tr>td>a{text-decoration:underline}.jexcel>tbody>tr>td.highlight>a{color:#00f;cursor:pointer}.jexcel>tfoot>tr>td{border-color:#ccc transparent transparent #ccc;border-style:solid;border-width:1px;background-color:#f3f3f3;padding:2px;cursor:pointer;box-sizing:border-box;overflow:hidden}.jexcel .highlight{background-color:rgba(0,0,0,.05)}.jexcel .highlight-top{border-top:1px solid #000;box-shadow:0 -1px #ccc}.jexcel .highlight-left{border-left:1px solid #000;box-shadow:-1px 0 #ccc}.jexcel .highlight-right{border-right:1px solid #000}.jexcel .highlight-bottom{border-bottom:1px solid #000}.jexcel .highlight-top.highlight-left{box-shadow:-1px -1px #ccc;-webkit-box-shadow:-1px -1px #ccc;-moz-box-shadow:-1px -1px #ccc}.jexcel .highlight-selected{background-color:transparent}.jexcel .selection{background-color:rgba(0,0,0,.05)}.jexcel .selection-left{border-left:1px dotted #000}.jexcel .selection-right{border-right:1px dotted #000}.jexcel .selection-top{border-top:1px dotted #000}.jexcel .selection-bottom{border-bottom:1px dotted #000}.jexcel_corner{position:absolute;background-color:#000;height:1px;width:1px;border:1px solid #fff;top:-2000px;left:-2000px;cursor:crosshair;box-sizing:content-box;box-sizing:initial;z-index:30;padding:2px}.jexcel .editor{outline:0 solid transparent;overflow:visible;white-space:nowrap;text-align:left;padding:0;box-sizing:border-box;overflow:visible!important}.jexcel .editor>input{padding-left:4px}.jexcel .editor .jupload{position:fixed;top:100%;z-index:40;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-smoothing:antialiased;font-size:.875rem;letter-spacing:.2px;border-radius:4px;box-shadow:0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12),0 5px 5px -3px rgba(0,0,0,.2);padding:10px;background-color:#fff;width:300px;min-height:225px;margin-top:2px}.jexcel .editor .jupload img{width:100%;height:auto}.jexcel .editor .jexcel_richtext{position:fixed;top:100%;z-index:40;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-smoothing:antialiased;font-size:.875rem;letter-spacing:.2px;box-shadow:0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12),0 5px 5px -3px rgba(0,0,0,.2);padding:10px;background-color:#fff;min-width:280px;max-width:310px;margin-top:2px;text-align:left}.jexcel .editor .jclose:after{position:absolute;top:0;right:0;margin:10px;content:\"close\";font-family:\"Material icons\";font-size:24px;width:24px;height:24px;line-height:24px;cursor:pointer;text-shadow:0 0 5px #fff}.jexcel,.jexcel_corner,.jexcel td{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none;-khtml-user-drag:none;-moz-user-drag:none;-o-user-drag:none;user-drag:none}.jexcel_textarea{top:-999px;left:-999px;width:1px;height:1px}.jexcel .dragline,.jexcel_textarea{position:absolute}.jexcel .dragline div{position:relative;top:-6px;height:5px;width:22px}.jexcel .dragline div:hover{cursor:move}.jexcel .onDrag{background-color:rgba(0,0,0,.6)}.jexcel .error{border:1px solid red}.jexcel thead td.resizing{border-right-style:dotted!important;border-right-color:red!important}.jexcel tbody tr.resizing>td{border-bottom-style:dotted!important;border-bottom-color:red!important}.jexcel tbody td.resizing{border-right-style:dotted!important;border-right-color:red!important}.jexcel .jdropdown-header{border:0!important;outline:none!important;width:100%!important;height:100%!important;padding:0 0 0 8px!important}.jexcel .jdropdown-container{margin-top:1px}.jexcel .jdropdown-container-header{padding:0;margin:0;height:inherit}.jexcel .jdropdown-picker{border:0!important;padding:0!important;width:inherit;height:inherit}.jexcel .jexcel_comments{background:url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTAxLTMxVDE4OjU1OjA4WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wMS0zMVQxODo1NTowOFoiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTAxLTMxVDE4OjU1OjA4WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDphMTlhZDJmOC1kMDI2LTI1NDItODhjOS1iZTRkYjkyMmQ0MmQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpkOGI5NDUyMS00ZjEwLWQ5NDktYjUwNC0wZmU1N2I3Nzk1MDEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplMzdjYmE1ZS1hYTMwLWNkNDUtYTAyNS1lOWYxZjk2MzUzOGUiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDplMzdjYmE1ZS1hYTMwLWNkNDUtYTAyNS1lOWYxZjk2MzUzOGUiIHN0RXZ0OndoZW49IjIwMTktMDEtMzFUMTg6NTU6MDhaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmExOWFkMmY4LWQwMjYtMjU0Mi04OGM5LWJlNGRiOTIyZDQyZCIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0zMVQxODo1NTowOFoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4En6MDAAAAX0lEQVQYlX3KOw6AIBBAwS32RpJADXfx0pTET+ERZJ8F8RODFtONsG0QAoh0CSDM82dqodaBdQXnfoLZQM7gPai+wjNNE8R4pTuAYNZSKZASqL7CMy0LxNgJp30fKYUDi3+vIqb/+rUAAAAASUVORK5CYII=\");background-repeat:no-repeat;background-position:100% 0}.jexcel .sp-replacer{margin:2px;border:0}.jexcel>thead>tr.jexcel_filter>td>input{border:0;width:100%;outline:none}.jexcel_about{float:right;font-size:.7em;padding:2px;text-transform:uppercase;letter-spacing:1px;display:none}.jexcel_about a{color:#ccc;text-decoration:none}.jexcel_about img{display:none}.jexcel_filter{display:flex;justify-content:space-between;margin-bottom:4px}.jexcel_filter>div{padding:8px;align-items:center}.jexcel_pagination{display:flex;justify-content:space-between;align-items:center}.jexcel_pagination>div{display:flex;padding:10px}.jexcel_pagination>div:last-child{padding-right:10px;padding-top:10px}.jexcel_pagination>div>div{text-align:center;width:36px;height:36px;line-height:34px;border:1px solid #ccc;box-sizing:border-box;margin-left:2px;cursor:pointer}.jexcel_page{font-size:.8em}.jexcel_page_selected{font-weight:700;background-color:#f3f3f3}.jexcel_toolbar{display:flex;background-color:#f3f3f3;border:1px solid #ccc;padding:4px;margin:0 2px 4px 1px;position:-webkit-sticky;position:sticky;top:0;z-index:21}.jexcel_toolbar:empty{display:none}.jexcel_toolbar i.jexcel_toolbar_item{width:24px;height:24px;padding:4px;cursor:pointer;display:inline-block}.jexcel_toolbar i.jexcel_toolbar_item:hover{background-color:#ddd}.jexcel_toolbar select.jexcel_toolbar_item{margin-left:2px;margin-right:2px;display:inline-block;border:0;background-color:transparent;padding-right:10px}.jexcel .dragging-left{background-repeat:no-repeat;background-position:top 50% left 0;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M14 7l-5 5 5 5V7z'/%3E%3Cpath fill='none' d='M24 0v24H0V0h24z'/%3E%3C/svg%3E\")}.jexcel .dragging-right{background-repeat:no-repeat;background-position:top 50% right 0;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath d='M10 17l5-5-5-5v10z'/%3E%3Cpath fill='none' d='M0 24V0h24v24H0z'/%3E%3C/svg%3E\")}.jexcel_tabs .jexcel_tab{display:none}.jexcel_tabs .jexcel_tab_link{display:inline-block;padding:10px 20px;margin-right:5px;margin-bottom:5px;background-color:#f3f3f3;cursor:pointer}.jexcel_tabs .jexcel_tab_link.selected{background-color:#ddd}.jexcel_hidden_index>colgroup>col:first-child,.jexcel_hidden_index>tbody>tr>td:first-child,.jexcel_hidden_index>tfoot>tr>td:first-child,.jexcel_hidden_index>thead>tr>td:first-child{display:none}.jexcel .jrating{display:inline-flex}.jexcel .jrating>div{zoom:.55}.jexcel .copying-top{border-top:1px dashed #000}.jexcel .copying-left{border-left:1px dashed #000}.jexcel .copying-right{border-right:1px dashed #000}.jexcel .copying-bottom{border-bottom:1px dashed #000}.jexcel .jexcel_column_filter{background-repeat:no-repeat;background-position:top 50% right 5px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='gray' width='18' height='18'%3E%3Cpath d='M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\");text-overflow:ellipsis;overflow:hidden;padding:0 20px 0 6px}.jexcel tfoot .jexcel_freezed,.jexcel thead .jexcel_freezed{left:0;z-index:3!important;box-shadow:2px 0 2px .2px #ccc!important;-webkit-box-shadow:2px 0 2px .2px #ccc!important;-moz-box-shadow:2px 0 2px .2px #ccc!important}.jexcel tbody .jexcel_freezed{position:relative;background-color:#fff;box-shadow:1px 1px 1px 1px #ccc!important;-webkit-box-shadow:2px 4px 4px .1px #ccc!important;-moz-box-shadow:2px 4px 4px .1px #ccc!important}",""]),e.exports=n}}]);